!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Process=t()}}(function(){var define,module,exports;return function(){return function t(e,r,n){function i(s,a){if(!r[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var l=r[s]={exports:{}};e[s][0].call(l.exports,function(t){return i(e[s][1][t]||t)},l,l.exports,t,e,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}}()({1:[function(t,e,r){"use strict";var n=function(){};function i(t){return void 0===t?{scalar:n,tensor:n}:{scalar:new Function("_x",["var x = _x.x;","var out = this.x;","_x.dx += ("+t+") * this.dx;"].join("\n")),tensor:new Function("_x",["var n = _x.x.length;","while (n--) {","\tvar x = _x.x.data[n];","\tvar out = this.x.data[n];","   _x.dx.data[n] += ("+t+") * this.dx.data[n];","}"].join("\n"))}}function o(t,e){return void 0===t&&void 0===e?{scalar:[n,n],tensor:[n,n]}:{scalar:[new Function("_x","_y",["var x = _x.x;",'var y = (typeof _y === "number") ? _y : _y.x;',"var out = this.x;","_x.dx += ("+t+") * this.dx;"].join("\n")),new Function("_x","_y",['var x = (typeof _x === "number") ? _x : _x.x;',"var y = _y.x;","var out = this.x;","_y.dx += ("+e+") * this.dx;"].join("\n"))],tensor:[new Function("_x","_y",["var _xx = _x.x;","var _yx = _y.x || _y;","var n = _xx.length;",'if (typeof _yx === "number") {',"\twhile (n--) {","\t\tvar x = _xx.data[n];","\t\tvar y = _yx;","\t\tvar out = this.x.data[n];","\t   _x.dx.data[n] += ("+t+") * this.dx.data[n];","\t}","} else {","\twhile (n--) {","\t\tvar x = _xx.data[n];","\t\tvar y = _yx.data[n];","\t\tvar out = this.x.data[n];","\t   _x.dx.data[n] += ("+t+") * this.dx.data[n];","\t}","}"].join("\n")),new Function("_x","_y",["var _xx = _x.x || _x;","var _yx = _y.x;","var n = _xx.length;",'if (typeof _yx === "number") {',"\twhile (n--) {","\t\tvar x = _xx.data[n];","\t\tvar y = _yx;","\t\tvar out = this.x.data[n];","\t   _y.dx += ("+e+") * this.dx.data[n];","\t}","} else {","\twhile (n--) {","\t\tvar x = _xx.data[n];","\t\tvar y = _yx.data[n];","\t\tvar out = this.x.data[n];","\t   _y.dx.data[n] += ("+e+") * this.dx.data[n];","\t}","}"].join("\n"))]}}var s={};s.neg=i("-1"),s.add=o("1","1"),s.sub=o("1","-1"),s.mul=o("y","x"),s.div=o("1/y","-x/(y*y)"),s.sqrt=i("1/(2*out)"),s.exp=i("out"),s.log=i("1/x"),s.pow=o("y*Math.pow(x,y-1)","Math.log(x)*out"),s.sin=i("Math.cos(x)"),s.cos=i("-Math.sin(x)"),s.tan=i("1 + out*out"),s.asin=i("1 / Math.sqrt(1 - x*x)"),s.acos=i("-1 / Math.sqrt(1 - x*x)"),s.atan=i("1 / (1 + x*x)"),s.atan2=o("y/(x*x + y*y)","-x/(x*x + y*y)"),s.sinh=i("Math.cosh(x)"),s.cosh=i("Math.sinh(x)"),s.tanh=i("1 - out*out"),s.asinh=i("1 / Math.sqrt(x*x + 1)"),s.acosh=i("1 / Math.sqrt(x*x - 1)"),s.atanh=i("1 / (1 - x*x)"),s.sigmoid=i("out * (1 - out)"),s.abs=i("x >= 0 ? 1 : -1"),s.floor=i(),s.ceil=i(),s.round=i(),s.min=o(),s.max=o(),e.exports=s},{}],2:[function(t,e,r){"use strict";var n=t("assert"),i=t("./graph.js"),o=i.Node,s=t("../tensor.js");function a(t){n(t===s||t===Number,"Attempting to create AD function with invalid output type '"+t+"'; valid options are 'Number' and 'Tensor'")}e.exports={newUnaryFunction:function(t){var e=t.OutputType,r=t.name,n=t.forward,u=t.backward;a(e);var h=e===s?i.TensorNode:i.ScalarNode;function l(){u.call(this,this.inputs[0])}return function(t){if(t instanceof o){var e=[t];return new h(n(t.x),e,e,l,r)}return n(t)}},newBinaryFunction:function(t){var e=t.OutputType,r=t.name,n=t.forward,u=t.backward1,h=t.backward2;a(e);var l=e===s?i.TensorNode:i.ScalarNode;function f(){u.call(this,this.inputs[0],this.inputs[1].x),h.call(this,this.inputs[0].x,this.inputs[1])}function c(){u.call(this,this.inputs[0],this.inputs[1])}function p(){h.call(this,this.inputs[0],this.inputs[1])}return function(t,e){var i=t instanceof o,s=e instanceof o;if(i&&s){var a=[t,e];return new l(n(t.x,e.x),a,a,f,r)}return i?new l(n(t.x,e),[t],[t,e],c,r):s?new l(n(t,e.x),[e],[t,e],p,r):n(t,e)}},newFunction:function(t){var e=t.OutputType,r=t.name,n=t.forward,o=t.backward,u=t.getParents;a(e);var h=e===s?i.TensorNode:i.ScalarNode;function l(){o.apply(this,this.inputs)}return function(){for(var t=n.apply(null,arguments),e=u.apply(null,arguments),i=new Array(arguments.length),o=0;o<i.length;++o)i[o]=arguments[o];return 0===e.length?t:new h(t,e,i,l,r)}},naryGetParents:function(){for(var t=1===arguments.length&&arguments[0]instanceof Array?arguments[0]:arguments,e=[],r=t.length;r--;){var n=t[r];n instanceof o&&e.push(n)}return e},liftUnaryFunction:function(t){return function(e){return t(e instanceof o?e.x:e)}},liftBinaryFunction:function(t){return function(e,r){var n=e instanceof o?e.x:e,i=r instanceof o?r.x:r;return t(n,i)}}}},{"../tensor.js":22,"./graph.js":4,assert:24}],3:[function(t,e,r){"use strict";var n=t("../tensor.js"),i=t("./graph.js").Node,o=t("./func.js"),s=t("./derivatives.js"),a=Number;function u(t){var e={};function r(e){return t===n?e.tensor:e.scalar}var i=t===a?"scalar.":"tensor.",u={neg:t===n?function(t){return t.neg()}:function(t){return-t}};for(var h in u)e[h]=o.newUnaryFunction({OutputType:t,name:i+h,forward:u[h],backward:r(s[h])});var l={add:t===n?function(t,e){return t.add(e)}:function(t,e){return t+e},sub:t===n?function(t,e){return t.sub(e)}:function(t,e){return t-e},mul:t===n?function(t,e){return t.mul(e)}:function(t,e){return t*e},div:t===n?function(t,e){return t.div(e)}:function(t,e){return t/e}};for(var h in l)e[h]=o.newBinaryFunction({OutputType:t,name:i+h,forward:l[h],backward1:r(s[h])[0],backward2:r(s[h])[1]});for(var f=["floor","ceil","round","sqrt","exp","log","abs","sin","cos","tan","asin","acos","atan","sinh","cosh","tanh","asinh","acosh","atanh","sigmoid"],c=["pow","min","max","atan2"],p=0;p<f.length;p++){var d=f[p],m=t===n?new Function("x","return x."+d+"();"):new Function("x","return Math."+d+"(x);");e[d]=o.newUnaryFunction({OutputType:t,name:i+d,forward:m,backward:r(s[d])})}for(p=0;p<c.length;p++){d=c[p],m=t===n?new Function("x","y","return x."+d+"(y);"):new Function("x","y","return Math."+d+"(x, y);");e[d]=o.newBinaryFunction({OutputType:t,name:i+d,forward:m,backward1:r(s[d])[0],backward2:r(s[d])[1]})}return e.isNaN=t===a?o.liftUnaryFunction(isNaN):o.liftUnaryFunction(function(t){return t.isNaN()}),e.isFinite=t===a?o.liftUnaryFunction(isFinite):o.liftUnaryFunction(function(t){return t.isFinite()}),e}Math.sigmoid=function(t){return 1/(1+Math.exp(-t))};var h={scalar:u(a),tensor:u(n)};Object.getOwnPropertyNames(Math).forEach(function(t){h.scalar.hasOwnProperty(t)||(h.scalar[t]=Math[t])}),h.scalar.eq=o.liftBinaryFunction(function(t,e){return t==e}),h.scalar.neq=o.liftBinaryFunction(function(t,e){return t!=e}),h.scalar.peq=o.liftBinaryFunction(function(t,e){return t===e}),h.scalar.pneq=o.liftBinaryFunction(function(t,e){return t!==e}),h.scalar.gt=o.liftBinaryFunction(function(t,e){return t>e}),h.scalar.lt=o.liftBinaryFunction(function(t,e){return t<e}),h.scalar.geq=o.liftBinaryFunction(function(t,e){return t>=e}),h.scalar.leq=o.liftBinaryFunction(function(t,e){return t<=e}),h.tensor.transpose=o.newUnaryFunction({OutputType:n,name:"transpose",forward:function(t){return t.transpose()},backward:function(t){for(var e=this.x.dims[0],r=this.x.dims[1],n=0;n<e;n++)for(var i=0;i<r;i++)t.dx.data[i*e+n]+=this.dx.data[n*r+i]}}),h.tensor.diagonal=o.newUnaryFunction({OutputType:n,name:"diagonal",forward:function(t){return t.diagonal()},backward:function(t){for(var e=t.dx.dims[0],r=0;r<e;r++)t.dx.data[r]+=this.dx.data[r*(e+1)]}}),h.tensor.inverse=o.newUnaryFunction({OutputType:n,name:"inverse",forward:function(t){return t.inverse()},backward:function(t){var e=this.x.transpose();t.dx=t.dx.add(e.dot(this.dx).dot(e).neg())}}),h.tensor.determinant=o.newUnaryFunction({OutputType:Number,name:"determinant",forward:function(t){return t.determinant()},backward:function(t){for(var e=t.x.dims[0],r=t.x.inverse(),n=0;n<e;n++)for(var i=0;i<e;i++)t.dx.data[n*e+i]+=this.x*this.dx*r.data[i*e+n]}}),h.tensor.dot=o.newBinaryFunction({OutputType:n,name:"dot",forward:function(t,e){return t.dot(e)},backward1:function(t,e){for(var r=ad.value(t),n=ad.value(e),i=r.dims[0],o=r.dims[1],s=n.dims[1],a=s,u=0;u<i;u++)for(var h=0;h<o;h++){for(var l=0,f=0;f<a;f++)l+=this.dx.data[u*a+f]*n.data[h*s+f];t.dx.data[u*o+h]+=l}},backward2:function(t,e){for(var r=ad.value(t),n=ad.value(e),i=r.dims[0],o=r.dims[1],s=n.dims[0],a=n.dims[1],u=a,h=0;h<s;h++)for(var l=0;l<a;l++){for(var f=0,c=0;c<i;c++)f+=this.dx.data[c*u+l]*r.data[c*o+h];e.dx.data[h*a+l]+=f}}}),h.tensor.cholesky=o.newUnaryFunction({OutputType:n,name:"cholesky",forward:function(t){return t.cholesky()},backward:function(t){var e,r,n,i=this,o=this.dx.tril(),s=i.x.dims[0];for(n=s-1;n>=0;n--){for(r=n+1;r<s;r++)for(e=r;e<s;e++)o.data[e*s+n]-=o.data[e*s+r]*i.x.data[r*s+n],o.data[r*s+n]-=o.data[e*s+r]*i.x.data[e*s+n];for(r=n+1;r<s;r++)o.data[r*s+n]/=i.x.data[n*s+n],o.data[n*s+n]-=o.data[r*s+n]*i.x.data[r*s+n];o.data[n*s+n]/=2*i.x.data[n*s+n]}t.dx.addeq(o)}}),h.tensor.sumreduce=o.newUnaryFunction({OutputType:a,name:"sumreduce",forward:function(t){return t.sumreduce()},backward:function(t){for(var e=t.dx.data.length;e--;)t.dx.data[e]+=this.dx}}),h.tensor.allreduce=o.liftUnaryFunction(function(t){return t.allreduce()}),h.tensor.anyreduce=o.liftUnaryFunction(function(t){return t.anyreduce()}),h.tensor.get=o.newFunction({OutputType:a,name:"tensor.get",forward:function(t,e){return t instanceof i?t.x.data[e]:t.data[e]},backward:function(t,e){t instanceof i&&(t.dx.data[e]+=this.dx)},getParents:function(t,e){return t instanceof i?[t]:[]}}),h.tensor.toScalars=function(t){for(var e=t instanceof i?t.x.length:t.length,r=new Array(e);e--;)r[e]=h.tensor.get(t,e);return r},h.tensor.range=o.newFunction({OutputType:n,name:"tensor.range",forward:function(t,e,r){t=t instanceof i?t.x:t;for(var o=r-e,s=new n([o]);o--;){var a=e+o;s.data[o]=t.data[a]}return s},backward:function(t,e,r){if(t instanceof i)for(var n=r-e;n--;){var o=e+n;t.dx.data[o]+=this.dx.data[n]}},getParents:function(t,e,r){return t instanceof i?[t]:[]}}),h.tensor.split=function(t,e){for(var r=new Array(e.length),n=0,i=0;i<e.length;i++){var o=e[i];r[i]=h.tensor.range(t,n,n+o),n+=o}return r},h.tensor.fromScalars=o.newFunction({OutputType:n,name:"tensor.fromScalars",forward:function(){for(var t=1===arguments.length&&arguments[0]instanceof Array?arguments[0]:arguments,e=t.length,r=new n([e]);e--;){var o=t[e];r.data[e]=o instanceof i?o.x:o}return r},backward:function(){for(var t=1===arguments.length&&arguments[0]instanceof Array?arguments[0]:arguments,e=t.length;e--;){var r=t[e];r instanceof i&&(r.dx+=this.dx.data[e])}},getParents:o.naryGetParents}),h.tensor.concat=o.newFunction({OutputType:n,name:"tensor.concat",forward:function(){for(var t=1===arguments.length&&arguments[0]instanceof Array?arguments[0]:arguments,e=t.length,r=0;e--;){r+=(h=(u=t[e])instanceof i?u.x:u).length}var o=new n([r]);e=t.length;for(var s=0,a=0;a<e;a++){var u,h=(u=t[a])instanceof i?u.x:u;o.copy(h,s),s+=h.length}return o},backward:function(){for(var t=1===arguments.length&&arguments[0]instanceof Array?arguments[0]:arguments,e=t.length,r=0,n=0;n<e;n++){var o=t[n];if(o instanceof i){for(var s=o,a=s.dx.length;a--;)s.dx.data[a]+=this.dx.data[r+a];r+=s.dx.length}else r+=o.length}},getParents:o.naryGetParents}),h.tensor.reshape=function(t,e){if(t instanceof i){var r=t.refClone();return r.x.reshape(e),r.dx.reshape(e),r}var n=t.refClone();return n.reshape(e),n},h.scalar.sum=o.newFunction({OutputType:a,name:"scalar.sum",forward:function(){for(var t=1===arguments.length&&arguments[0]instanceof Array?arguments[0]:arguments,e=0,r=t.length;r--;){var n=t[r];e+=n instanceof i?n.x:n}return e},backward:function(){for(var t=1===arguments.length&&arguments[0]instanceof Array?arguments[0]:arguments,e=t.length;e--;){var r=t[e];r instanceof i&&(r.dx+=this.dx)}},getParents:o.naryGetParents}),h.tensor.softmax=o.newUnaryFunction({OutputType:n,name:"tensor.softmax",forward:function(t){return t.softmax()},backward:function(t){for(var e=t.dx.data.length,r=0,n=0;n<e;n++)r+=this.x.data[n]*this.dx.data[n];for(var i=0;i<e;i++)t.dx.data[i]+=this.x.data[i]*(this.dx.data[i]-r)}}),e.exports=h},{"../tensor.js":22,"./derivatives.js":1,"./func.js":2,"./graph.js":4}],4:[function(t,e,r){"use strict";var n=t("../tensor.js");function i(t,e,r,n,i){this.x=t,this.parents=e,this.inputs=r,void 0!==n&&(this.backward=n),this.outDegree=0,this.name=i||"node"}function o(t,e,r,n,o){i.call(this,t,e,r,n,o||"scalarNode"),this.dx=0}function s(t,e,r,o,s){i.call(this,t,e,r,o,s||"tensorNode"),this.dx=new n(t.dims)}i.prototype.copy=function(t){this.x=t.x,this.parents=t.parents,this.inputs=t.inputs,void 0!==t.backward&&(this.backward=t.backward),this.outDegree=t.outDegree,this.name=t.name},i.prototype.clone=function(){var t=Object.create(i.prototype);return t.copy(this),t},i.prototype.computeOutDegree=function(){for(var t=[this];t.length>0;){var e=t.pop();if(e.outDegree++,1===e.outDegree)for(var r=e.parents.length;r--;)t.push(e.parents[r])}},i.prototype.backpropRec=function(){for(var t=[this];t.length>0;){var e=t.pop();if(e.outDegree--,0===e.outDegree){e.backward();for(var r=e.parents.length;r--;)t.push(e.parents[r])}}},i.prototype.zeroDerivativesRec=function(){for(var t=[this];t.length>0;){var e=t.pop();if(e.outDegree--,0===e.outDegree){e.zeroDerivativesImpl();for(var r=e.parents.length;r--;)t.push(e.parents[r])}}},i.prototype.zeroDerivatives=function(){this.computeOutDegree(),this.zeroDerivativesRec()},i.prototype.backward=function(){},o.prototype=Object.create(i.prototype),o.prototype.copy=function(t){i.prototype.copy.call(this,t),this.dx=t.dx},o.prototype.clone=function(){var t=Object.create(o.prototype);return t.copy(this),t},o.prototype.backprop=function(){this.dx=1,this.computeOutDegree(),this.backpropRec()},o.prototype.zeroDerivativesImpl=function(){this.dx=0},s.prototype=Object.create(i.prototype),s.prototype.copy=function(t){i.prototype.copy.call(this,t),this.x=t.x.clone(),this.dx=t.dx.clone()},s.prototype.clone=function(){var t=Object.create(n.prototype);return t.copy(this),t},s.prototype.refCopy=function(t){i.prototype.copy.call(this,t),this.x=t.x.refClone(),this.dx=t.dx.refClone()},s.prototype.refClone=function(){var t=Object.create(s.prototype);return t.refCopy(this),t},s.prototype.backprop=function(){this.dx.fill(1),this.computeOutDegree(),this.backpropRec()},s.prototype.zeroDerivativesImpl=function(){this.dx.zero()},e.exports={Node:i,ScalarNode:o,TensorNode:s}},{"../tensor.js":22}],5:[function(t,e,r){"use strict";var n=t("../utils.js"),i=t("./graph.js"),o=t("../tensor.js"),s=i.Node,a=i.ScalarNode,u=i.TensorNode,h=[];function l(t,e){return t instanceof o?function(t,e){return new u(t,h,h,void 0,e)}(t,e):function(t,e){return new a(t,h,h,void 0,e)}(t,e)}var f={lift:function(t,e){return t instanceof s?t:l(t,e)},isLifted:function(t){return t instanceof s},value:function(t){return t instanceof s?t.x:t},derivative:function(t){return t.dx},params:function(t,e){return f.lift(new o(t).fillRandom(),e)}},c=t("./func.js"),p=t("./functions.js");f=n.mergeObjects(f,c,p),e.exports=f},{"../tensor.js":22,"../utils.js":23,"./func.js":2,"./functions.js":3,"./graph.js":4}],6:[function(t,e,r){"use strict";var n=t("assert"),i=t("../utils.js"),o=t("./network.js");function s(t,e,r){function s(t){o.call(this),this.name=r||"compoundNetwork",this.networks=t.slice();for(var e=0;e<t.length;e++)this.paramGetters=this.paramGetters.concat(t[e].paramGetters),this.paramSetters=this.paramSetters.concat(t[e].paramSetters);this.paramGetters=i.deduplicate(this.paramGetters),this.paramSetters=i.deduplicate(this.paramSetters)}return s.prototype=Object.create(o.prototype),s.prototype.eval=t,s.prototype.setTraining=function(t){o.prototype.setTraining.call(this,t);for(var e=0;e<this.networks.length;e++)this.networks[e].setTraining(t)},r?(s.prototype.serializeJSON=function(){return{type:r,networks:this.networks.map(function(t){return t.serializeJSON()})}},o.deserializers[r]=function(t){return new s(t.networks.map(function(t){return o.deserializeJSON(t)}))}):s.prototype.serializeJSON=function(){n(!1,"Cannot serialize unnamed compound network.")},new s(e)}function a(t,e){this.type=t,this.parents=e||[]}function u(t){o.call(this),this.name="select",this.i=t}function h(){return new a("input")}function l(t,e,r,i){for(var o=0;o<t.length;o++)n("input"===t[o].type,"Inputs to composite neural network must be nn.ast.input()");var a=[];for(o=0;o<e.length;o++)for(var u=[e[o]];u.length>0;){if("input"!==(f=u.pop()).type&&-1===a.indexOf(f)){a.push(f);for(o=0;o<f.parents.length;o++)u.push(f.parents[o])}}a.reverse();var h="var args = arguments;\n",l=[];for(o=0;o<a.length;o++){var f,c=(f=a[o]).parents.map(function(e){var r=t.indexOf(e);return-1!==r?"args["+r+"]":-1!==(r=a.indexOf(e))?"r"+r:void n(!1,"impossible")});if(h+="var r"+o+" = this.networks["+o+"].eval("+c+");\n",i){var p="r"+o,d=p+"_val";h+=["var "+d+" = "+p+".x || "+p+";","if (!"+d+".isFinite().allreduce()) {",'\tvar err = "Non-finite value in output of network '+o+' ("+'+("this.networks["+o+"]")+'.name+")\\n";','   err += "Output:\\n";','\terr += "["+'+d+'.toString()+"]\\n";','   err += "Inputs:\\n";',c.map(function(t){return'\terr += "["+'+("("+t+".x || "+t+")")+'.toString()+"]\\n";'}).join("\n"),"   throw new Error(err);","}"].join("\n")}-1!==e.indexOf(f)&&l.push("r"+o)}h+="return "+(l.length>1?"["+l+"]":l[0])+";";var m=s(new Function(h),a.map(function(t){return t.network}));return m.name=r||"compiledNetwork",m.nodes=t.concat(a),m.inputs=t.map(function(t){return m.nodes.indexOf(t)}),m.outputs=e.map(function(t){return m.nodes.indexOf(t)}),m.serializeJSON=function(){var t=this.nodes.map(function(t){var e={type:t.type,parents:t.parents.map(function(t){return this.nodes.indexOf(t)}.bind(this))};return"compose"===e.type&&(e.network=t.network.serializeJSON()),e}.bind(this));return{type:"compiled",name:this.name,nodes:t,inputs:this.inputs,outputs:this.outputs}},m}function f(t,e,r){for(var n=h(),i=n,o=0;o<t.length;o++)i=t[o].compose(i);var s=l([n],[i],void 0,r);return s.name=e||"sequenceNetwork",s.serializeJSON=function(){return{type:"sequence",name:this.name,networks:this.networks.map(function(t){return t.serializeJSON()})}},s}u.prototype=Object.create(o.prototype),u.prototype.eval=function(t){return t[this.i]},u.prototype.serializeJSON=function(){return{type:"select",i:this.i}},o.deserializers.select=function(t){return new u(t.i)},a.prototype.split=function(t){for(var e=new Array(t),r=0;r<t;r++){var n=new u(r);e[r]=n.compose(this)}return e},o.prototype.compose=function(){var t=new a("compose",Array.prototype.slice.call(arguments));return t.network=this,t},o.deserializers.compiled=function(t){for(var e=[],r=0;r<t.nodes.length;r++){var n=t.nodes[r],i=new a(n.type,n.parents.map(function(t){return e[t]}));"compose"===n.type&&(i.network=o.deserializeJSON(n.network)),e.push(i)}return l(t.inputs.map(function(t){return e[t]}),t.outputs.map(function(t){return e[t]}),t.name)},o.deserializers.sequence=function(t){return f(t.networks.map(function(t){return o.deserializeJSON(t)}),t.name)},e.exports={compound:s,ast:{input:h,compile:l},sequence:f}},{"../utils.js":23,"./network.js":9,assert:24}],7:[function(t,e,r){"use strict";var n=t("../utils.js"),i=t("./network.js");e.exports={Network:i,deserializeJSON:i.deserializeJSON};var o=t("./lifting.js"),s=t("./composition.js"),a=t("./networks/lifted.js"),u=t("./networks/linear.js"),h=t("./networks/convolution.js"),l=t("./networks/pooling.js"),f=t("./networks/activation.js"),c=t("./networks/perceptron.js"),p=t("./networks/misc.js");e.exports=n.mergeObjects(e.exports,o,s,a,u,h,l,f,c,p)},{"../utils.js":23,"./composition.js":6,"./lifting.js":8,"./network.js":9,"./networks/activation.js":10,"./networks/convolution.js":11,"./networks/lifted.js":12,"./networks/linear.js":13,"./networks/misc.js":14,"./networks/perceptron.js":15,"./networks/pooling.js":16}],8:[function(t,e,r){"use strict";var n=t("./network.js");function i(t,e){var r=new n;return r.eval=t,r.name=e||"liftedNetwork",e?(r.serializeJSON=function(){return{type:e}},n.deserializers[e]=function(t){return r}):r.serializeJSON=function(){assert(!1,"Cannot serialize unnamed lifted network.")},r}e.exports={lift:i,partialeval:function(t,e){var r=function(){var r=Array.prototype.slice.call(arguments),n=i(function(e){var n=Array.prototype.slice.call(arguments);return t.apply(null,n.concat(r))});return n.name=e,e&&(n.serializeJSON=function(){for(var t={type:e},n=0;n<r.length;n++)t["arg"+n]=r[n];return t}),n};return e&&(n.deserializers[e]=function(t){var e=[];for(var n in t)n.startsWith("arg")&&(e[parseInt(n.slice(3))]=t[n]);return r.apply(null,e)}),r}}},{"./network.js":9}],9:[function(t,e,r){"use strict";var n=t("assert");function i(){this.name="",this.isTraining=!1,this.paramGetters=[],this.paramSetters=[]}i.prototype.eval=function(){n(!1,"Neural networks must implement the 'eval' method.")},i.prototype.getParameters=function(){return void 0===this.__parameters&&(this.__parameters=this.paramGetters.map(function(t){return t()})),this.__parameters},i.prototype.setParameters=function(t){t.length!==this.paramSetters.length&&n(!1,"Network.setParameters: size mismatch (network has "+this.paramSetters.length+" parameters, not "+t.length);for(var e=0;e<t.length;e++)this.paramSetters[e](t[e]);this.__parameters=t.slice()},i.prototype.setTraining=function(t){this.isTraining=t},i.prototype.serializeJSON=function(){n(!1,"Neural networks must implement the 'serializeJSON' method.")},i.deserializers={},i.deserializeJSON=function(t){return n(void 0!==t.type,"Network JSON blob has no 'type' field."),n(i.deserializers.hasOwnProperty(t.type),"Network JSON blob has unrecognized type '"+t.type+"'"),i.deserializers[t.type](t)},e.exports=i},{assert:24}],10:[function(t,e,r){"use strict";var n=t("../../tensor.js"),i=t("../../ad"),o=t("../lifting.js").lift,s=o(i.newUnaryFunction({OutputType:n,name:"relu",forward:function(t){for(var e=(t=i.value(t)).clone(),r=t.length;r--;)e.data[r]=e.data[r]<0?0:e.data[r];return e},backward:function(t){for(var e=t.x.length;e--;)t.dx.data[e]+=t.x.data[e]<=0?0:this.dx.data[e]}}),"relu"),a=o(function(t){return i.tensor.sub(i.tensor.mul(i.tensor.sigmoid(t),2),1)});e.exports={relu:s,sigmoidCentered:a}},{"../../ad":5,"../../tensor.js":22,"../lifting.js":8}],11:[function(t,e,r){"use strict";var n=t("../../tensor.js"),i=t("../../ad"),o=t("../network.js"),s=t("assert");function a(t,e,r,n,s,a,u,h,l){o.call(this),this.name=l||"convolution",this.inDepth=t,this.outDepth=e,this.filterWidth=r,this.filterHeight=n,this.strideX=s,this.strideY=a,this.padX=u,this.padY=h,this.filters=i.params([e,t,n,r],this.name+"_filters"),this.biases=i.params([e],this.name+"_biases"),this.paramGetters=[function(){return this.filters}.bind(this),function(){return this.biases}.bind(this)],this.paramSetters=[function(t){this.filters=t}.bind(this),function(t){this.biases=t}.bind(this)]}a.prototype=Object.create(o.prototype),a.prototype.serializeJSON=function(){return{type:"convolution",name:this.name,inDepth:this.inDepth,outDepth:this.outDepth,filterWidth:this.filterWidth,filterHeight:this.filterHeight,strideX:this.strideX,strideY:this.strideY,padX:this.padX,padY:this.padY,filters:i.value(this.filters).toFlatArray(),biases:i.value(this.biases).toFlatArray()}},o.deserializers.convolution=function(t){var e=new a(t.inDepth,t.outDepth,t.filterWidth,t.filterHeight,t.strideX,t.strideY,t.padX,t.padY,t.name);return i.value(e.filters).fromFlatArray(t.filters),i.value(e.biases).fromFlatArray(t.biases),e};var u=i.newFunction({OutputType:n,name:"convolution",forward:function(t,e,r,o,a,u,h){t=i.value(t),e=i.value(e),r=i.value(r);var l=e.dims[2],f=e.dims[3],c=t.dims[0],p=t.dims[1],d=t.dims[2],m=e.dims[0],g=Math.floor((p+2*h-l)/a+1),w=Math.floor((d+2*u-f)/o+1);c!==e.dims[1]&&s(!1,"Convolutional network: input depth is "+c+" but should be "+e.dims[1]);for(var v=new n([m,g,w]),y=0;y<m;y++)for(var b=-u,x=-h,M=0;M<g;x+=a,M++){b=-u;for(var _=0;_<w;b+=o,_++){for(var S=r.data[y],E=0;E<c;E++)for(var k=0;k<l;k++)for(var j=x+k,O=0;O<f;O++){var A=b+O;if(j>=0&&j<p&&A>=0&&A<d){var R=A+d*(j+p*E),N=O+f*(k+l*(E+c*y));S+=e.data[N]*t.data[R]}}v.data[_+w*(M+g*y)]=S}}return v},backward:function(t,e,r,n,o,s,a){for(var u=i.value(t),h=i.value(e),l=t!==u,f=e!==h,c=r!==i.value(r),p=h.dims[2],d=h.dims[3],m=u.dims[0],g=u.dims[1],w=u.dims[2],v=h.dims[0],y=this.x.dims[1],b=this.x.dims[2],x=0;x<v;x++)for(var M=-s,_=-a,S=0;S<y;_+=o,S++){M=-s;for(var E=0;E<b;M+=n,E++){var k=this.dx.data[E+b*(S+y*x)];c&&(r.dx.data[x]+=k);for(var j=0;j<m;j++)for(var O=0;O<p;O++)for(var A=_+O,R=0;R<d;R++){var N=M+R;if(A>=0&&A<g&&N>=0&&N<w){var T=N+w*(A+g*j),I=R+d*(O+p*(j+m*x));l&&(t.dx.data[T]+=h.data[I]*k),f&&(e.dx.data[I]+=u.data[T]*k)}}}}},getParents:function(t,e,r,n,o,s,a){var u=[];return i.isLifted(t)&&u.push(t),i.isLifted(e)&&u.push(e),i.isLifted(r)&&u.push(r),u}});a.prototype.eval=function(t){var e=this.isTraining?this.filters:i.value(this.filters),r=this.isTraining?this.biases:i.value(this.biases);return u(t,e,r,this.strideX,this.strideY,this.padX,this.padY)},e.exports={convolution:function(t,e){var r=t.inDepth||1,n=t.outDepth||1,i=t.filterWidth||t.filterSize,o=t.filterHeight||t.filterSize,s=t.strideX||t.stride||1,u=t.strideY||t.stride||1,h=t.padX||t.pad||"same",l=t.padY||t.pad||"same";return"same"===h&&(h=Math.floor((i-1)/2)),"same"===l&&(l=Math.floor((o-1)/2)),new a(r,n,i,o,s,u,h,l,e)},convolve:u}},{"../../ad":5,"../../tensor.js":22,"../network.js":9,assert:24}],12:[function(t,e,r){"use strict";var n=t("../../ad/functions.js"),i=t("../lifting.js");for(var o in e.exports={},n.tensor)e.exports[o]=i.lift(n.tensor[o],o);e.exports.range=i.partialeval(n.tensor.range,"range"),e.exports.split=i.partialeval(n.tensor.split,"split"),e.exports.reshape=i.partialeval(n.tensor.reshape,"reshape")},{"../../ad/functions.js":3,"../lifting.js":8}],13:[function(t,e,r){"use strict";var n=t("../../tensor.js"),i=t("../../ad"),o=t("../network.js"),s=t("assert");function a(t,e,r){o.call(this),this.name=r||"linear",this.inSize=t,this.outSize=e,this.weights=i.params([e,t],this.name+"_weights"),this.biases=i.params([e],this.name+"_biases"),this.paramGetters=[function(){return this.weights}.bind(this),function(){return this.biases}.bind(this)],this.paramSetters=[function(t){this.weights=t}.bind(this),function(t){this.biases=t}.bind(this)]}a.prototype=Object.create(o.prototype),a.prototype.serializeJSON=function(){return{type:"linear",name:this.name,inSize:this.inSize,outSize:this.outSize,weights:i.value(this.weights).toFlatArray(),biases:i.value(this.biases).toFlatArray()}},o.deserializers.linear=function(t){var e=new a(t.inSize,t.outSize,t.name);return i.value(e.weights).fromFlatArray(t.weights),i.value(e.biases).fromFlatArray(t.biases),e};var u=i.newFunction({OutputType:n,name:"mvmuladd",forward:function(t,e,r){t=i.value(t),e=i.value(e),r=i.value(r);var n=e.length,o=r.length;n!==t.dims[1]&&s(!1,"Linear network: input size is "+n+" but should be "+t.dims[1]);for(var a=r.clone(),u=0;u<o;u++)for(var h=u*n,l=0;l<n;l++)a.data[u]+=t.data[h+l]*e.data[l];return a},backward:function(t,e,r){for(var n=i.value(t),o=i.value(e),s=i.value(r),a=t!==n,u=e!==o,h=r!==s,l=o.length,f=s.length,c=0;c<f;c++){var p=c*l,d=this.dx.data[c];h&&(r.dx.data[c]+=d);for(var m=0;m<l;m++)u&&(e.dx.data[m]+=n.data[p+m]*d),a&&(t.dx.data[p+m]+=o.data[m]*d)}},getParents:i.naryGetParents});function h(t,e,r){o.call(this),this.name=r||"layerwiseLinear",this.inSize=t,this.outSize=e,this.weights=i.params([e,t],this.name+"_weights"),this.biases=i.params([e],this.name+"_biases"),this.paramGetters=[function(){return this.weights}.bind(this),function(){return this.biases}.bind(this)],this.paramSetters=[function(t){this.weights=t}.bind(this),function(t){this.biases=t}.bind(this)]}a.prototype.eval=function(t){var e=this.isTraining?this.weights:i.value(this.weights),r=this.isTraining?this.biases:i.value(this.biases);return u(e,t,r)},h.prototype=Object.create(o.prototype),h.prototype.serializeJSON=function(){return{type:"layerwiseLinear",name:this.name,inSize:this.inSize,outSize:this.outSize,weights:i.value(this.weights).toFlatArray(),biases:i.value(this.biases).toFlatArray()}},o.deserializers.layerwiseLinear=function(t){var e=new h(t.inSize,t.outSize,t.name);return i.value(e.weights).fromFlatArray(t.weights),i.value(e.biases).fromFlatArray(t.biases),e};var l=i.newFunction({OutputType:n,name:"layerwiseMVMulAdd",forward:function(t,e,r){t=i.value(t),e=i.value(e),r=i.value(r);var o=t.dims[0];o!==e.dims[1]&&s(!1,"LayerwiseLinear Network: input depth is "+o+" but should be "+e.dims[1]);for(var a=t.dims[1],u=t.dims[2],h=e.dims[0],l=new n([h,a,u]),f=0;f<a;f++)for(var c=0;c<u;c++)for(var p=0;p<h;p++){var d=c+u*(f+a*p);l.data[d]=r.data[p];for(var m=0;m<o;m++){var g=m+p*o,w=e.data[g],v=c+u*(f+a*m),y=t.data[v];l.data[d]+=w*y}}return l},backward:function(t,e,r){for(var n=i.value(t),o=i.value(e),s=t!==n,a=e!==o,u=r!==i.value(r),h=n.dims[1],l=n.dims[2],f=o.dims[0],c=o.dims[1],p=0;p<h;p++)for(var d=0;d<l;d++)for(var m=0;m<f;m++){var g=d+l*(p+h*m),w=this.dx.data[g];u&&(r.dx.data[m]+=w);for(var v=0;v<c;v++){var y=v+m*c,b=d+l*(p+h*v);if(a){var x=n.data[b];e.dx.data[y]+=x*w}if(s){var M=o.data[y];t.dx.data[b]+=M*w}}}},getParents:i.naryGetParents});h.prototype.eval=function(t){var e=this.isTraining?this.weights:i.value(this.weights),r=this.isTraining?this.biases:i.value(this.biases);return l(t,e,r)},e.exports={linear:function(t,e,r){return new a(t,e,r)},layerwiseLinear:function(t,e,r){return new h(t,e,r)}}},{"../../ad":5,"../../tensor.js":22,"../network.js":9,assert:24}],14:[function(t,e,r){"use strict";var n=t("../../ad"),i=t("../network.js");function o(t,e){i.call(this),this.name=e||"constantparams",this.dims=t,this.params=n.params(t,this.name),this.paramGetters=[function(){return this.params}.bind(this)],this.paramSetters=[function(t){this.params=t}.bind(this)]}o.prototype=Object.create(i.prototype),o.prototype.eval=function(){return this.isTraining?this.params:n.value(this.params)},o.prototype.serializeJSON=function(){return{type:"constantparams",name:this.name,dims:this.dims,params:n.value(this.params).toFlatArray()}},i.deserializers.constantparams=function(t){var e=new o(t.dims,t.name);return n.value(e.params).fromFlatArray(t.params),e},e.exports={constantparams:function(t,e){return new o(t,e)}}},{"../../ad":5,"../network.js":9}],15:[function(t,e,r){"use strict";var n=t("../composition.js").sequence,i=t("./linear.js").linear;e.exports={mlp:function(t,e,r,o){r=r||"mlp";for(var s=[],a=0;a<e.length;a++){var u=e[a];s.push(i(t,u.nOut,r+"_layer"+a)),u.activation&&s.push(u.activation),t=u.nOut}return n(s,r||"multiLayerPerceptron",o)}}},{"../composition.js":6,"./linear.js":13}],16:[function(t,e,r){"use strict";var n,i=t("../../tensor.js"),o=t("../../ad"),s=t("../network.js");function a(t,e,r,n,i,o){s.call(this),this.filterWidth=t,this.filterHeight=e,this.strideX=r,this.strideY=n,this.padX=i,this.padY=o,this.name="maxpool"}a.prototype=Object.create(s.prototype),a.prototype.serializeJSON=function(){return{type:"maxpool",filterWidth:this.filterWidth,filterHeight:this.filterHeight,strideX:this.strideX,strideY:this.strideY,padX:this.padX,padY:this.padY}},s.deserializers.maxpool=function(t){return new a(t.filterWidth,t.filterHeight,t.strideX,t.strideY,t.padX,t.padY)};var u,h=o.newFunction({OutputType:i,name:"maxpooling",forward:function(t,e,r,s,a,u,h){var l=(t=o.value(t)).dims[0],f=t.dims[1],c=t.dims[2],p=Math.floor((f+2*h-r)/a+1),d=Math.floor((c+2*u-e)/s+1),m=new i([l,p,d]);n=new Int32Array(l*p*d);for(var g=0;g<l;g++)for(var w=-u,v=-h,y=0;y<p;v+=a,y++){w=-u;for(var b=0;b<d;w+=s,b++){for(var x=-1/0,M=-1,_=0;_<r;_++)for(var S=v+_,E=0;E<e;E++){var k=w+E;if(S>=0&&S<f&&k>=0&&k<c){var j=k+c*(S+f*g),O=t.data[j];O>x&&(x=O,M=j)}}var A=b+d*(y+p*g);m.data[A]=x,n[A]=M}}return m},backward:function(t,e,r,n,i,o,s){for(var a=t.x.dims[0],u=(t.x.dims[1],t.x.dims[2],this.x.dims[1]),h=this.x.dims[2],l=0;l<a;l++)for(var f=0;f<u;i,f++){-o;for(var c=0;c<h;n,c++){var p=c+h*(f+u*l),d=this.maxIndices[p];t.dx.data[d]+=this.dx.data[p]}}},getParents:function(t,e,r,n,i,s,a){return o.isLifted(t)?[t]:[]}});function l(t,e,r,n,i,o){s.call(this),this.filterWidth=t,this.filterHeight=e,this.strideX=r,this.strideY=n,this.padX=i,this.padY=o,this.name="minpool"}a.prototype.eval=function(t){return e=t,r=this.filterWidth,i=this.filterHeight,s=this.strideX,a=this.strideY,u=this.padX,l=this.padY,f=h(e,r,i,s,a,u,l),o.isLifted(f)&&(f.maxIndices=n),f;var e,r,i,s,a,u,l,f},l.prototype=Object.create(s.prototype),l.prototype.serializeJSON=function(){return{type:"minpool",filterWidth:this.filterWidth,filterHeight:this.filterHeight,strideX:this.strideX,strideY:this.strideY,padX:this.padX,padY:this.padY}},s.deserializers.minpool=function(t){return new l(t.filterWidth,t.filterHeight,t.strideX,t.strideY,t.padX,t.padY)};var f=o.newFunction({OutputType:i,name:"maxpooling",forward:function(t,e,r,n,s,a,h){var l=(t=o.value(t)).dims[0],f=t.dims[1],c=t.dims[2],p=Math.floor((f+2*h-r)/s+1),d=Math.floor((c+2*a-e)/n+1),m=new i([l,p,d]);u=new Int32Array(l*p*d);for(var g=0;g<l;g++)for(var w=-a,v=-h,y=0;y<p;v+=s,y++){w=-a;for(var b=0;b<d;w+=n,b++){for(var x=1/0,M=-1,_=0;_<r;_++)for(var S=v+_,E=0;E<e;E++){var k=w+E;if(S>=0&&S<f&&k>=0&&k<c){var j=k+c*(S+f*g),O=t.data[j];O<x&&(x=O,M=j)}}var A=b+d*(y+p*g);m.data[A]=x,u[A]=M}}return m},backward:function(t,e,r,n,i,o,s){for(var a=t.x.dims[0],u=(t.x.dims[1],t.x.dims[2],this.x.dims[1]),h=this.x.dims[2],l=0;l<a;l++)for(var f=0;f<u;i,f++){-o;for(var c=0;c<h;n,c++){var p=c+h*(f+u*l),d=this.minIndices[p];t.dx.data[d]+=this.dx.data[p]}}},getParents:function(t,e,r,n,i,s,a){return o.isLifted(t)?[t]:[]}});function c(t,e,r,n,i,o){s.call(this),this.filterWidth=t,this.filterHeight=e,this.strideX=r,this.strideY=n,this.padX=i,this.padY=o,this.name="meanpool"}l.prototype.eval=function(t){return e=t,r=this.filterWidth,n=this.filterHeight,i=this.strideX,s=this.strideY,a=this.padX,h=this.padY,l=f(e,r,n,i,s,a,h),o.isLifted(l)&&(l.minIndices=u),l;var e,r,n,i,s,a,h,l},c.prototype=Object.create(s.prototype),c.prototype.serializeJSON=function(){return{type:"meanpool",filterWidth:this.filterWidth,filterHeight:this.filterHeight,strideX:this.strideX,strideY:this.strideY,padX:this.padX,padY:this.padY}},s.deserializers.meanpool=function(t){return new c(t.filterWidth,t.filterHeight,t.strideX,t.strideY,t.padX,t.padY)};var p=o.newFunction({OutputType:i,name:"meanpooling",forward:function(t,e,r,n,s,a,u){for(var h=(t=o.value(t)).dims[0],l=t.dims[1],f=t.dims[2],c=Math.floor((l+2*u-r)/s+1),p=Math.floor((f+2*a-e)/n+1),d=e*r,m=new i([h,c,p]),g=0;g<h;g++)for(var w=-a,v=-u,y=0;y<c;v+=s,y++){w=-a;for(var b=0;b<p;w+=n,b++){for(var x=0,M=0;M<r;M++)for(var _=v+M,S=0;S<e;S++){var E=w+S;if(_>=0&&_<l&&E>=0&&E<f){var k=E+f*(_+l*g);x+=t.data[k]}}var j=b+p*(y+c*g);m.data[j]=x/d}}return m},backward:function(t,e,r,n,i,o,s){for(var a=t.x.dims[0],u=t.x.dims[1],h=t.x.dims[2],l=this.x.dims[1],f=this.x.dims[2],c=e*r,p=0;p<a;p++)for(var d=-o,m=-s,g=0;g<l;m+=i,g++){d=-o;for(var w=0;w<f;d+=n,w++)for(var v=w+f*(g+l*p),y=this.dx.data[v]/c,b=0;b<r;b++)for(var x=m+b,M=0;M<e;M++){var _=d+M;if(x>=0&&x<u&&_>=0&&_<h){var S=_+h*(x+u*p);t.dx.data[S]+=y}}}},getParents:function(t,e,r,n,i,s,a){return o.isLifted(t)?[t]:[]}});c.prototype.eval=function(t){return p(t,this.filterWidth,this.filterHeight,this.strideX,this.strideY,this.padX,this.padY)},e.exports={maxpool:function(t){var e=t.filterWidth||t.filterSize,r=t.filterHeight||t.filterSize;return new a(e,r,t.strideX||t.stride||e,t.strideY||t.stride||r,t.padX||t.pad||0,t.padY||t.pad||0)},minpool:function(t){var e=t.filterWidth||t.filterSize,r=t.filterHeight||t.filterSize;return new l(e,r,t.strideX||t.stride||e,t.strideY||t.stride||r,t.padX||t.pad||0,t.padY||t.pad||0)},meanpool:function(t){var e=t.filterWidth||t.filterSize,r=t.filterHeight||t.filterSize;return new c(e,r,t.strideX||t.stride||e,t.strideY||t.stride||r,t.padX||t.pad||0,t.padY||t.pad||0)}}},{"../../ad":5,"../../tensor.js":22,"../network.js":9}],17:[function(t,e,r){"use strict";var n=t("../utils.js"),i=t("./methods.js"),o=t("./optimize.js"),s=t("./loss.js");e.exports=n.mergeObjects({},i,o,s)},{"../utils.js":23,"./loss.js":18,"./methods.js":19,"./optimize.js":20}],18:[function(t,e,r){"use strict";var n=t("assert"),i=t("../ad");e.exports={classificationLoss:function(t,e){var r=i.value(t).length;return n(e<r,"Training datum has true class label "+e+", but network only outputs "+r+" class probabilities."),i.scalar.neg(i.scalar.log(i.tensor.get(t,e)))},regressionLoss:function(t,e){var r=i.value(t).length,o=e.length;n(r===o,"Network output has different dimensionality than training data ("+r+" vs. "+o+")");var s=i.tensor.sub(t,e);return i.tensor.sumreduce(i.tensor.mul(s,s))}}},{"../ad":5,assert:24}],19:[function(t,e,r){"use strict";var n=t("../utils.js"),i=t("./tensorStruct.js"),o=1e-8;e.exports={sgd:function(t){var e,r=(t=n.mergeDefaults(t,{stepSize:.1,stepSizeDecay:1,mu:0})).stepSize,o="function"==typeof r,s=t.stepSizeDecay,a=t.mu;return function(t,n,u){var h=o?r(u):r;e||(e=i.emptyLike(t)),i.foreach(t,[{struct:n,ifMissing:i.ifMissing.impossible},{struct:e,ifMissing:i.ifMissing.zeros}],function(t,e,r){r.muleq(a).subeq(t.mul(h)),e.addeq(r)}),o||(r*=s)}},adagrad:function(t){var e,r=(t=n.mergeDefaults(t,{stepSize:.1})).stepSize,s="function"==typeof r;return function(t,n,a){var u=s?r(a):r;e||(e=i.emptyLike(t)),i.foreach(t,[{struct:n,ifMissing:i.ifMissing.impossible},{struct:e,ifMissing:i.ifMissing.zeros}],function(t,e,r){r.addeq(t.mul(t)),e.subeq(t.div(r.sqrt().addeq(o)).muleq(u))})}},rmsprop:function(t){var e,r=(t=n.mergeDefaults(t,{stepSize:.1,decayRate:.9})).stepSize,s="function"==typeof r,a=t.decayRate;return function(t,n,u){var h=s?r(u):r;e||(e=i.emptyLike(t)),i.foreach(t,[{struct:n,ifMissing:i.ifMissing.impossible},{struct:e,ifMissing:i.ifMissing.zeros}],function(t,e,r){r.muleq(a).addeq(t.mul(t).muleq(1-a)),e.subeq(t.div(r.sqrt().addeq(o)).muleq(h))})}},adam:function(t){var e,r,s=(t=n.mergeDefaults(t,{stepSize:.001,decayRate1:.9,decayRate2:.999})).stepSize,a="function"==typeof s,u=t.decayRate1,h=t.decayRate2;return function(t,n,l){var f=a?s(l):s,c=l+1;e||(e=i.emptyLike(t)),r||(r=i.emptyLike(t)),i.foreach(t,[{struct:n,ifMissing:i.ifMissing.impossible},{struct:e,ifMissing:i.ifMissing.zeros},{struct:r,ifMissing:i.ifMissing.zeros}],function(t,e,r,n){r.muleq(u).addeq(t.mul(1-u)),n.muleq(h).addeq(t.mul(t).muleq(1-h));var i=f*Math.sqrt(1-Math.pow(h,c))/(1-Math.pow(u,c));e.subeq(r.div(n.sqrt().addeq(o)).muleq(i))})}}}},{"../utils.js":23,"./tensorStruct.js":21}],20:[function(t,e,r){"use strict";var n=t("assert"),i=t("../ad"),o=t("../utils.js"),s=t("./methods.js"),a=t("./tensorStruct.js");function u(t,e){for(var r=(e=o.mergeDefaults(e,{iterations:100,method:s.sgd(),verbose:!1})).iterations,i=e.method,a=e.verbose,u=0;u<r;u++){var h=t();n(void 0!==h.gradients),n(void 0!==h.parameters),i(h.gradients,h.parameters,u),a&&console.log("[optimize] done iteration "+(u+1)+"/"+r)}}function h(t){return function(){var e=t();return n(void 0!==e.parameters),n(void 0!==e.loss),a.foreach(e.parameters,[],function(t){t.zeroDerivatives()}),e.loss.backprop(),{gradients:a.map(e.parameters,i.derivative),parameters:a.map(e.parameters,i.value)}}}function l(t,e,r,n){var i=(n=o.mergeDefaults(n,{batchSize:1})).batchSize,s=n.shuffle,l=-1,f=h(function(){var n=e[l],i=t(n.input),o=r(i.output,n.output);return{parameters:i.parameters,loss:o}});u(function(){for(var t,r,n=0;n<i;n++){l=!1===s?(l+1)%e.length:Math.floor(Math.random()*e.length);var o=f();void 0===t?(t=o.gradients,r=o.parameters):a.foreach(o.gradients,[{struct:t,ifMissing:a.ifMissing.zeros},{struct:o.parameters,ifMissing:a.ifMissing.impossible},{struct:r,ifMissing:a.ifMissing.copyFromCoStruct(1)}],function(t,e){e.addeq(t)})}return i>1&&a.foreach(t,[],function(t){t.diveq(i)}),{parameters:r,gradients:t}},n)}e.exports={optimize:u,adOptimize:function(t,e){u(h(t),e)},adTrain:l,nnTrain:function(t,e,r,n){t.setTraining(!0),l(function(e){return{output:t.eval(e),parameters:t.getParameters()}},e,r,n),t.setTraining(!1)}}},{"../ad":5,"../utils.js":23,"./methods.js":19,"./tensorStruct.js":21,assert:24}],21:[function(t,e,r){"use strict";t("assert"),t("../utils.js");var n=t("../tensor.js"),i=t("../ad");function o(t){if(t instanceof n||i.isLifted(t)&&i.value(t)instanceof n)return"tensor";if(Array.isArray(t))return"array";if("object"==typeof t)return"object";throw new Error("Malformed Tensor structure; expected Tensor, Array, or object, got "+typeof x)}function s(t,e){var r=o(t);if("tensor"===r)return e(t);if("array"===r){for(var n=[],i=0;i<t.length;i++)n[i]=s(t[i],e);return n}if("object"===r){n={};for(var a in t)n[a]=s(t[a],e);return n}}var a={impossible:function(t,e){throw new Error("impossible for this struct to have missing elements")},zeros:function(t,e){return s(t,function(t){return new n(t.dims)})},copyFromStruct:function(t,e){return s(t,function(t){return t})},copyFromCoStruct:function(t){return function(e,r){return s(r[t],function(t){return t})}}};e.exports={emptyLike:function(t){var e=o(t);return"tensor"===e?new n(t.dims):"array"===e?[]:"object"===e?{}:void 0},map:s,foreach:function(t,e,r){var n;if(0===e.length)(n=function(t){var e=o(t);if("tensor"===e)r(t);else if("array"===e)for(var i=0;i<t.length;i++)n(t[i]);else if("object"===e)for(var s in t)n(t[s])})(t);else{var i=e.map(function(t){return t.ifMissing});n=function(t,e){var s=o(t);if("tensor"===s)r.apply(null,[t].concat(e));else if("array"===s){for(var a=[],u=0;u<t.length;u++){for(var h=[],l=0;l<e.length;l++)h.push(e[l][u]);a.push(h)}for(l=0;l<e.length;l++){var f=e[l],c=i[l],p=t.length;for(u=f.length;u<p;u++){var d=c(t[u],a[u]);f.push(d),a[u][l]=d}}for(u=0;u<t.length;u++)n(t[u],a[u])}else if("object"===s){for(var m in a={},t){for(h=[],l=0;l<e.length;l++)h.push(e[l][m]);a[m]=h}for(l=0;l<e.length;l++)for(var m in f=e[l],c=i[l],t)f.hasOwnProperty(m)||(d=c(t[m],a[m]),f[m]=d,a[m][l]=d);for(var m in t)n(t[m],a[m])}};var s=e.map(function(t){return t.struct});n(t,s,r)}},ifMissing:a}},{"../ad":5,"../tensor.js":22,"../utils.js":23,assert:24}],22:[function(t,e,r){"use strict";var n=t("assert"),i=t("./utils.js");Array;var o,s=(o=Float64Array,{new:function(t){return new o(t)},set:function(t,e,r){t.set(e,r)}});function a(t){this.dims=t;for(var e=1,r=t.length;r--;)e*=t[r];this.length=e,this.data=s.new(e)}function u(t,e){var r=new Function(["var n = this.data.length;","while (n--) {","\tvar x = this.data[n];","\tthis.data[n] = "+e+";","}","return this;"].join("\n"));a.prototype[t+"eq"]=r,a.prototype[t]=function(){var t=this.clone();return r.call(t)}}function h(t,e){var r=new Function("s",["var n = this.data.length;","var b = s;","while (n--) {","\tvar a = this.data[n];","\tthis.data[n] = "+e+";","}","return this;"].join("\n")),n=new Function("t",["var n = this.data.length;","while (n--) {","\tvar a = this.data[n];","\tvar b = t.data[n];","\tthis.data[n] = "+e+";","}","return this;"].join("\n")),i=function(t){return t.constructor===a?n.call(this,t):r.call(this,t)};a.prototype[t+"eq"]=i,a.prototype[t]=function(t){var e=this.clone();return i.call(e,t)}}function l(t,e,r){a.prototype[t+"reduce"]=new Function(["var accum = "+e+";","var n = this.data.length;","while (n--) {","\tvar x = this.data[n];","\taccum = "+r+";","}","return accum;"].join("\n"))}Object.defineProperties(a.prototype,{rank:{get:function(){return this.dims.length}}}),a.prototype.reshape=function(t){for(var e=1,r=t.length;r--;)e*=t[r];return n(e===this.length,"Tensor reshape invalid size"),this.dims=t,this},a.prototype.fill=function(t){for(var e=this.length;e--;)this.data[e]=t;return this},a.prototype.zero=function(){return this.fill(0)},a.prototype.fillRandom=function(){for(var t=1/this.length,e=this.length;e--;)this.data[e]=i.gaussianSample(0,t);return this},a.prototype.copy=function(t,e){return e=e||0,s.set(this.data,t.data,e),this},a.prototype.clone=function(){return new a(this.dims).copy(this)},a.prototype.refCopy=function(t){return this.dims=t.dims,this.length=t.length,this.data=t.data,this},a.prototype.refClone=function(){return Object.create(a.prototype).refCopy(this)},a.prototype.get=function(t){for(var e=0,r=this.dims.length,n=0;n<r;n++)e=e*this.dims[n]+t[n];return this.data[e]},a.prototype.set=function(t,e){for(var r=0,n=this.dims.length,i=0;i<n;i++)r=r*this.dims[i]+t[i];this.data[r]=e},a.prototype.toArray=function(){return function t(e,r){if(r.length===e.rank)return e.get(r);for(var n=r.length,i=[],o=0;o<e.dims[n];o++)i.push(t(e,r.concat([o])));return i}(this,[])},a.prototype.fromArray=function(t){return function t(e,r,n){if(n instanceof Array)for(var i=r.length,o=0;o<e.dims[i];o++)t(e,r.concat([o]),n[o]);else e.set(r,n)}(this,[],t),this},a.prototype.toString=function(){return this.toArray().toString()},a.prototype.toFlatArray=function(){return Array.prototype.slice.call(this.data)},a.prototype.fromFlatArray=function(t){return s.set(this.data,t,0),this},u("neg","-x"),u("round","Math.round(x)"),u("log","Math.log(x)"),u("exp","Math.exp(x)"),u("sqrt","Math.sqrt(x)"),u("abs","Math.abs(x)"),u("ceil","Math.ceil(x)"),u("floor","Math.floor(x)"),u("cos","Math.cos(x)"),u("sin","Math.sin(x)"),u("tan","Math.tan(x)"),u("acos","Math.acos(x)"),u("asin","Math.asin(x)"),u("atan","Math.atan(x)"),u("cosh","Math.cosh(x)"),u("sinh","Math.sinh(x)"),u("tanh","Math.tanh(x)"),u("acosh","Math.acosh(x)"),u("asinh","Math.asinh(x)"),u("atanh","Math.atanh(x)"),u("sigmoid","1 / (1 + Math.exp(-x))"),u("isFinite","isFinite(x)"),u("isNaN","isNaN(x)"),u("invert","1/x"),u("pseudoinvert","x === 0 ? 0 : 1/x"),h("add","a + b"),h("sub","a - b"),h("mul","a * b"),h("div","a / b"),h("mod","a % b"),h("min","Math.min(a, b)"),h("max","Math.max(a, b)"),h("pow","Math.pow(a, b)"),h("atan2","Math.atan2(a, b)"),h("eq","a === b"),h("neq","a !== b"),h("gt","a > b"),h("ge","a >= b"),h("lt","a < b"),h("le","a <= b"),l("sum","0","accum + x"),l("min","Infinity","Math.min(accum, x)"),l("max","-Infinity","Math.max(accum, x)"),l("all","true","accum && (x !== 0)"),l("any","false","accum || (x !== 0)"),a.prototype.softmax=function(){for(var t=-1/0,e=this.data.length;e--;)t=Math.max(t,this.data[e]);var r=new a(this.dims);e=this.data.length;for(var n=0;e--;)r.data[e]=Math.exp(this.data[e]-t),n+=r.data[e];for(e=this.data.length;e--;)r.data[e]/=n;return r},a.prototype.transpose=function(){n.ok(2===this.rank);for(var t=this.dims[0],e=this.dims[1],r=new a([e,t]),i=0;i<t;i++)for(var o=0;o<e;o++)r.data[o*t+i]=this.data[i*e+o];return r},a.prototype.diagonal=function(){n.ok(2===this.rank),n.ok(1===this.dims[1]);for(var t=this.dims[0],e=new a([t,t]),r=0;r<t;r++)e.data[r*(t+1)]=this.data[r];return e},a.prototype.inverse=function(){n.ok(2===this.rank),n.ok(this.dims[0]===this.dims[1]);var t,e,r,i,o,s,u,h,l=this.dims[0],f=[];for(o=0;o<l;o++)for(t=new Float64Array(l),f.push(t),s=0;s<l;s++)t[s]=this.data[o*l+s];var c=[];for(o=0;o<l;o++)for(r=new Array(l),c.push(r),s=0;s<l;s++)r[s]=o===s?1:0;for(s=0;s<l;++s){var p=-1,d=-1;for(o=s;o!==l;++o)(u=Math.abs(f[o][s]))>d&&(p=o,d=u);for(e=f[p],f[p]=f[s],f[s]=e,i=c[p],c[p]=c[s],c[s]=i,h=e[s],u=s;u!==l;++u)e[u]/=h;for(u=l-1;-1!==u;--u)i[u]/=h;for(o=l-1;-1!==o;--o)if(o!==s){for(t=f[o],r=c[o],h=t[s],u=s+1;u!==l;++u)t[u]-=e[u]*h;for(u=l-1;u>0;--u)r[u]-=i[u]*h,r[--u]-=i[u]*h;0===u&&(r[0]-=i[0]*h)}}return new a([l,l]).fromArray(c)},a.prototype.determinant=function(){n.ok(2===this.rank),n.ok(this.dims[0]===this.dims[1]);var t,e,r,i,o,s,a,u,h=this.dims[0],l=1,f=[];for(t=0;t<h;t++)for(o=new Float64Array(h),f.push(o),e=0;e<h;e++)o[e]=this.data[t*h+e];for(e=0;e<h-1;e++){for(r=e,t=e+1;t<h;t++)Math.abs(f[t][e])>Math.abs(f[r][e])&&(r=t);for(r!==e&&(a=f[r],f[r]=f[e],f[e]=a,l*=-1),i=f[e],t=e+1;t<h;t++){for(s=(o=f[t])[e]/i[e],r=e+1;r<h-1;r+=2)u=r+1,o[r]-=i[r]*s,o[u]-=i[u]*s;r!==h&&(o[r]-=i[r]*s)}if(0===i[e])return 0;l*=i[e]}return l*f[e][e]},a.prototype.dot=function(t){var e=this,r=t;if(2!==e.rank||2!==r.rank)throw new Error("Inputs to dot should have rank = 2.");if(e.dims[1]!==r.dims[0])throw new Error("Dimension mismatch in dot. Inputs have dimension "+e.dims+" and "+r.dims+".");for(var n=e.dims[1],i=e.dims[0],o=r.dims[1],s=new a([i,o]),u=0;u<i;u++)for(var h=0;h<o;h++){for(var l=0,f=0;f<n;f++)l+=e.data[u*n+f]*r.data[o*f+h];s.data[u*o+h]=l}return s},a.prototype.cholesky=function(){var t,e=this;n.ok(2===e.rank&&e.dims[0]===e.dims[1],"cholesky is only defined for square matrices.");for(var r=e.dims[0],i=new a([r,r]),o=0;o<r;o++)for(var s=0;s<=o;s++){t=0;for(var u=0;u<s;u++)t+=i.data[o*r+u]*i.data[s*r+u];i.data[o*r+s]=o===s?Math.sqrt(e.data[o*r+o]-t):1/i.data[s*r+s]*(e.data[o*r+s]-t)}return i},a.prototype.tril=function(){var t=this;n.ok(2===t.rank&&t.dims[0]===t.dims[1],"tril is only defined for square matrices.");for(var e=t.dims[0],r=new a([e,e]),i=0;i<e;i++)for(var o=0;o<=i;o++)r.data[i*e+o]=t.data[i*e+o];return r},e.exports=a},{"./utils.js":23,assert:24}],23:[function(t,e,r){"use strict";function n(t){t=t||{};for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t}e.exports={gaussianSample:function(t,e){var r,n,i,o,s;do{r=1-Math.random(),n=1.7156*(Math.random()-.5),s=(i=r-.449871)*i+(o=Math.abs(n)+.386595)*(.196*o-.25472*i)}while(s>=.27597&&(s>.27846||n*n>-4*r*r*Math.log(r)));return t+e*n/r},deduplicate:function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];-1===e.indexOf(n)&&e.push(n)}return e},mergeObjects:n,cloneObject:function(t){return n({},t)},mergeDefaults:function(t,e){return n({},e,t)}}},{}],24:[function(t,e,r){(function(r){"use strict";var n=t("object-assign");function i(t,e){if(t===e)return 0;for(var r=t.length,n=e.length,i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0}function o(t){return r.Buffer&&"function"==typeof r.Buffer.isBuffer?r.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var s=t("util/"),a=Object.prototype.hasOwnProperty,u=Array.prototype.slice,h="foo"===function(){}.name;function l(t){return Object.prototype.toString.call(t)}function f(t){return!o(t)&&("function"==typeof r.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var c=e.exports=v,p=/\s*function\s+([^\(\s]*)\s*/;function d(t){if(s.isFunction(t)){if(h)return t.name;var e=t.toString().match(p);return e&&e[1]}}function m(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function g(t){if(h||!s.isFunction(t))return s.inspect(t);var e=d(t);return"[Function"+(e?": "+e:"")+"]"}function w(t,e,r,n,i){throw new c.AssertionError({message:r,actual:t,expected:e,operator:n,stackStartFunction:i})}function v(t,e){t||w(t,!0,e,"==",c.ok)}function y(t,e,r,n){if(t===e)return!0;if(o(t)&&o(e))return 0===i(t,e);if(s.isDate(t)&&s.isDate(e))return t.getTime()===e.getTime();if(s.isRegExp(t)&&s.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(f(t)&&f(e)&&l(t)===l(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===i(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(o(t)!==o(e))return!1;var a=(n=n||{actual:[],expected:[]}).actual.indexOf(t);return-1!==a&&a===n.expected.indexOf(e)||(n.actual.push(t),n.expected.push(e),function(t,e,r,n){if(null===t||void 0===t||null===e||void 0===e)return!1;if(s.isPrimitive(t)||s.isPrimitive(e))return t===e;if(r&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var i=b(t),o=b(e);if(i&&!o||!i&&o)return!1;if(i)return t=u.call(t),e=u.call(e),y(t,e,r);var a,h,l=_(t),f=_(e);if(l.length!==f.length)return!1;for(l.sort(),f.sort(),h=l.length-1;h>=0;h--)if(l[h]!==f[h])return!1;for(h=l.length-1;h>=0;h--)if(a=l[h],!y(t[a],e[a],r,n))return!1;return!0}(t,e,r,n))}return r?t===e:t==e}function b(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function x(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function M(t,e,r,n){var i;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof r&&(n=r,r=null),i=function(t){var e;try{t()}catch(t){e=t}return e}(e),n=(r&&r.name?" ("+r.name+").":".")+(n?" "+n:"."),t&&!i&&w(i,r,"Missing expected exception"+n);var o="string"==typeof n,a=!t&&s.isError(i),u=!t&&i&&!r;if((a&&o&&x(i,r)||u)&&w(i,r,"Got unwanted exception"+n),t&&i&&r&&!x(i,r)||!t&&i)throw i}c.AssertionError=function(t){var e;this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=m(g((e=this).actual),128)+" "+e.operator+" "+m(g(e.expected),128),this.generatedMessage=!0);var r=t.stackStartFunction||w;if(Error.captureStackTrace)Error.captureStackTrace(this,r);else{var n=new Error;if(n.stack){var i=n.stack,o=d(r),s=i.indexOf("\n"+o);if(s>=0){var a=i.indexOf("\n",s+1);i=i.substring(a+1)}this.stack=i}}},s.inherits(c.AssertionError,Error),c.fail=w,c.ok=v,c.equal=function(t,e,r){t!=e&&w(t,e,r,"==",c.equal)},c.notEqual=function(t,e,r){t==e&&w(t,e,r,"!=",c.notEqual)},c.deepEqual=function(t,e,r){y(t,e,!1)||w(t,e,r,"deepEqual",c.deepEqual)},c.deepStrictEqual=function(t,e,r){y(t,e,!0)||w(t,e,r,"deepStrictEqual",c.deepStrictEqual)},c.notDeepEqual=function(t,e,r){y(t,e,!1)&&w(t,e,r,"notDeepEqual",c.notDeepEqual)},c.notDeepStrictEqual=function t(e,r,n){y(e,r,!0)&&w(e,r,n,"notDeepStrictEqual",t)},c.strictEqual=function(t,e,r){t!==e&&w(t,e,r,"===",c.strictEqual)},c.notStrictEqual=function(t,e,r){t===e&&w(t,e,r,"!==",c.notStrictEqual)},c.throws=function(t,e,r){M(!0,t,e,r)},c.doesNotThrow=function(t,e,r){M(!1,t,e,r)},c.ifError=function(t){if(t)throw t},c.strict=n(function t(e,r){e||w(e,!0,r,"==",t)},c,{equal:c.strictEqual,deepEqual:c.deepStrictEqual,notEqual:c.notStrictEqual,notDeepEqual:c.notDeepStrictEqual}),c.strict.strict=c.strict;var _=Object.keys||function(t){var e=[];for(var r in t)a.call(t,r)&&e.push(r);return e}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"object-assign":52,"util/":27}],25:[function(t,e,r){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},{}],26:[function(t,e,r){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],27:[function(t,e,r){(function(e,n){var i=/%[sdj%]/g;r.format=function(t){if(!w(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(a(arguments[r]));return e.join(" ")}r=1;for(var n=arguments,o=n.length,s=String(t).replace(i,function(t){if("%%"===t)return"%";if(r>=o)return t;switch(t){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}default:return t}}),u=n[r];r<o;u=n[++r])m(u)||!b(u)?s+=" "+u:s+=" "+a(u);return s},r.deprecate=function(t,i){if(v(n.process))return function(){return r.deprecate(t,i).apply(this,arguments)};if(!0===e.noDeprecation)return t;var o=!1;return function(){if(!o){if(e.throwDeprecation)throw new Error(i);e.traceDeprecation?console.trace(i):console.error(i),o=!0}return t.apply(this,arguments)}};var o,s={};function a(t,e){var n={seen:[],stylize:h};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),d(e)?n.showHidden=e:e&&r._extend(n,e),v(n.showHidden)&&(n.showHidden=!1),v(n.depth)&&(n.depth=2),v(n.colors)&&(n.colors=!1),v(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=u),l(n,t,n.depth)}function u(t,e){var r=a.styles[e];return r?"["+a.colors[r][0]+"m"+t+"["+a.colors[r][1]+"m":t}function h(t,e){return t}function l(t,e,n){if(t.customInspect&&e&&_(e.inspect)&&e.inspect!==r.inspect&&(!e.constructor||e.constructor.prototype!==e)){var i=e.inspect(n,t);return w(i)||(i=l(t,i,n)),i}var o=function(t,e){if(v(e))return t.stylize("undefined","undefined");if(w(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(g(e))return t.stylize(""+e,"number");if(d(e))return t.stylize(""+e,"boolean");if(m(e))return t.stylize("null","null")}(t,e);if(o)return o;var s=Object.keys(e),a=function(t){var e={};return t.forEach(function(t,r){e[t]=!0}),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),M(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(e);if(0===s.length){if(_(e)){var u=e.name?": "+e.name:"";return t.stylize("[Function"+u+"]","special")}if(y(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(x(e))return t.stylize(Date.prototype.toString.call(e),"date");if(M(e))return f(e)}var h,b="",S=!1,E=["{","}"];(p(e)&&(S=!0,E=["[","]"]),_(e))&&(b=" [Function"+(e.name?": "+e.name:"")+"]");return y(e)&&(b=" "+RegExp.prototype.toString.call(e)),x(e)&&(b=" "+Date.prototype.toUTCString.call(e)),M(e)&&(b=" "+f(e)),0!==s.length||S&&0!=e.length?n<0?y(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special"):(t.seen.push(e),h=S?function(t,e,r,n,i){for(var o=[],s=0,a=e.length;s<a;++s)j(e,String(s))?o.push(c(t,e,r,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(c(t,e,r,n,i,!0))}),o}(t,e,n,a,s):s.map(function(r){return c(t,e,n,a,r,S)}),t.seen.pop(),function(t,e,r){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1];return r[0]+e+" "+t.join(", ")+" "+r[1]}(h,b,E)):E[0]+b+E[1]}function f(t){return"["+Error.prototype.toString.call(t)+"]"}function c(t,e,r,n,i,o){var s,a,u;if((u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),j(n,i)||(s="["+i+"]"),a||(t.seen.indexOf(u.value)<0?(a=m(r)?l(t,u.value,null):l(t,u.value,r-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n")):a=t.stylize("[Circular]","special")),v(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function p(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function m(t){return null===t}function g(t){return"number"==typeof t}function w(t){return"string"==typeof t}function v(t){return void 0===t}function y(t){return b(t)&&"[object RegExp]"===S(t)}function b(t){return"object"==typeof t&&null!==t}function x(t){return b(t)&&"[object Date]"===S(t)}function M(t){return b(t)&&("[object Error]"===S(t)||t instanceof Error)}function _(t){return"function"==typeof t}function S(t){return Object.prototype.toString.call(t)}function E(t){return t<10?"0"+t.toString(10):t.toString(10)}r.debuglog=function(t){if(v(o)&&(o=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!s[t])if(new RegExp("\\b"+t+"\\b","i").test(o)){var n=e.pid;s[t]=function(){var e=r.format.apply(r,arguments);console.error("%s %d: %s",t,n,e)}}else s[t]=function(){};return s[t]},r.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},r.isArray=p,r.isBoolean=d,r.isNull=m,r.isNullOrUndefined=function(t){return null==t},r.isNumber=g,r.isString=w,r.isSymbol=function(t){return"symbol"==typeof t},r.isUndefined=v,r.isRegExp=y,r.isObject=b,r.isDate=x,r.isError=M,r.isFunction=_,r.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},r.isBuffer=t("./support/isBuffer");var k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function j(t,e){return Object.prototype.hasOwnProperty.call(t,e)}r.log=function(){var t,e;console.log("%s - %s",(t=new Date,e=[E(t.getHours()),E(t.getMinutes()),E(t.getSeconds())].join(":"),[t.getDate(),k[t.getMonth()],e].join(" ")),r.format.apply(r,arguments))},r.inherits=t("inherits"),r._extend=function(t,e){if(!e||!b(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":26,_process:54,inherits:25}],28:[function(t,e,r){const n=t("adnn/tensor"),i=t("adnn/nn"),o=t("adnn/opt");e.exports=class{constructor(t){this.scale=t.scale||!0;let e=[],r=[];if(t.encoder&&t.encoder.length&&t.decoder&&t.decoder.length)this.nInputs=t.decoder[t.decoder.length-1].nOut,this.nHidden=t.encoder[t.encoder.length-1].nOut,e=t.encoder.map(t=>({nOut:t.nOut,activation:i[t.activation]})),r=t.decoder.map(t=>({nOut:t.nOut,activation:i[t.activation]}));else{if(!t.nInputs||!t.nHidden)throw new Error("Not enough parameters to build an autoencoder");{this.nInputs=t.nInputs,this.nHidden=t.nHidden;const o=t.nLayers||2,s=t.activation||"relu";for(var n=0;n<o;n++)e.push({nOut:this.nInputs-Math.round((n+1)*(this.nInputs-this.nHidden)/o),activation:i[s]}),r.push({nOut:this.nHidden+Math.round((n+1)*(this.nInputs-this.nHidden)/o),activation:n<o-1?i[s]:void 0})}}this.encoder=i.mlp(this.nInputs,e),this.decoder=i.mlp(this.nHidden,r),this.net=i.sequence([this.encoder,this.decoder])}_scalerFit(t){this.max=t[0].slice(0),this.min=t[0].slice(0),t.forEach(t=>{t.forEach((t,e)=>{t>this.max[e]?this.max[e]=t:t<this.min[e]&&(this.min[e]=t)})})}_scalerTransform(t){const e=this.max.map((t,e)=>t-this.min[e]);return t.map(t=>t.map((t,r)=>e[r]>0?(t-this.min[r])/(this.max[r]-this.min[r]):0))}_scalerFitTransform(t){return this._scalerFit(t),this._scalerTransform(t)}_scalerInverseTransform(t){return t.map(t=>t.map((t,e)=>this.min[e]+t*(this.max[e]-this.min[e])))}fit(t,e){const r=e||{},i=r.stepSize||.05,s=(this.scale?this._scalerFitTransform(t):t).map(t=>{const e=new n([this.nInputs]).fromArray(t);return{input:e,output:e}});o.nnTrain(this.net,s,o.regressionLoss,{iterations:r.iterations||100,batchSize:r.batchSize||Math.round(s.length/50),method:r.method?o[r.method]({stepSize:i}):o.adagrad({stepSize:i})})}_eval(t,e){const r=t[0].length;return t.map(t=>e.eval(new n([r]).fromArray(t)).toArray())}encode(t){const e=this.scale?this._scalerTransform(t):t;return this._eval(e,this.encoder)}decode(t){const e=this._eval(t,this.decoder);return this.scale?this._scalerInverseTransform(e):e}predict(t){const e=this.scale?this._scalerTransform(t):t,r=this._eval(e,this.net);return this.scale?this._scalerInverseTransform(r):r}}},{"adnn/nn":7,"adnn/opt":17,"adnn/tensor":22}],29:[function(t,e,r){"use strict";r.byteLength=function(t){var e=h(t),r=e[0],n=e[1];return 3*(r+n)/4-n},r.toByteArray=function(t){var e,r,n=h(t),s=n[0],a=n[1],u=new o(function(t,e,r){return 3*(e+r)/4-r}(0,s,a)),l=0,f=a>0?s-4:s;for(r=0;r<f;r+=4)e=i[t.charCodeAt(r)]<<18|i[t.charCodeAt(r+1)]<<12|i[t.charCodeAt(r+2)]<<6|i[t.charCodeAt(r+3)],u[l++]=e>>16&255,u[l++]=e>>8&255,u[l++]=255&e;2===a&&(e=i[t.charCodeAt(r)]<<2|i[t.charCodeAt(r+1)]>>4,u[l++]=255&e);1===a&&(e=i[t.charCodeAt(r)]<<10|i[t.charCodeAt(r+1)]<<4|i[t.charCodeAt(r+2)]>>2,u[l++]=e>>8&255,u[l++]=255&e);return u},r.fromByteArray=function(t){for(var e,r=t.length,i=r%3,o=[],s=0,a=r-i;s<a;s+=16383)o.push(l(t,s,s+16383>a?a:s+16383));1===i?(e=t[r-1],o.push(n[e>>2]+n[e<<4&63]+"==")):2===i&&(e=(t[r-2]<<8)+t[r-1],o.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"="));return o.join("")};for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)n[a]=s[a],i[s.charCodeAt(a)]=a;function h(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function l(t,e,r){for(var i,o,s=[],a=e;a<r;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],30:[function(t,e,r){},{}],31:[function(t,e,r){(function(e){"use strict";var n=t("base64-js"),i=t("ieee754");r.Buffer=e,r.SlowBuffer=function(t){+t!=t&&(t=0);return e.alloc(+t)},r.INSPECT_MAX_BYTES=50;var o=2147483647;function s(t){if(t>o)throw new RangeError('The value "'+t+'" is invalid for option "size"');var r=new Uint8Array(t);return r.__proto__=e.prototype,r}function e(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return h(t)}return a(t,e,r)}function a(t,r,n){if("string"==typeof t)return function(t,r){"string"==typeof r&&""!==r||(r="utf8");if(!e.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var n=0|c(t,r),i=s(n),o=i.write(t,r);o!==n&&(i=i.slice(0,o));return i}(t,r);if(ArrayBuffer.isView(t))return l(t);if(null==t)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(F(t,ArrayBuffer)||t&&F(t.buffer,ArrayBuffer))return function(t,r,n){if(r<0||t.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<r+(n||0))throw new RangeError('"length" is outside of buffer bounds');var i;i=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);return i.__proto__=e.prototype,i}(t,r,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var i=t.valueOf&&t.valueOf();if(null!=i&&i!==t)return e.from(i,r,n);var o=function(t){if(e.isBuffer(t)){var r=0|f(t.length),n=s(r);return 0===n.length?n:(t.copy(n,0,0,r),n)}if(void 0!==t.length)return"number"!=typeof t.length||P(t.length)?s(0):l(t);if("Buffer"===t.type&&Array.isArray(t.data))return l(t.data)}(t);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return e.from(t[Symbol.toPrimitive]("string"),r,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function h(t){return u(t),s(t<0?0:0|f(t))}function l(t){for(var e=t.length<0?0:0|f(t.length),r=s(e),n=0;n<e;n+=1)r[n]=255&t[n];return r}function f(t){if(t>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|t}function c(t,r){if(e.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||F(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var n=t.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===n)return 0;for(var o=!1;;)switch(r){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return D(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return L(t).length;default:if(o)return i?-1:D(t).length;r=(""+r).toLowerCase(),o=!0}}function p(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function d(t,r,n,i,o){if(0===t.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),P(n=+n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof r&&(r=e.from(r,i)),e.isBuffer(r))return 0===r.length?-1:m(t,r,n,i,o);if("number"==typeof r)return r&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,r,n):Uint8Array.prototype.lastIndexOf.call(t,r,n):m(t,[r],n,i,o);throw new TypeError("val must be string, number or Buffer")}function m(t,e,r,n,i){var o,s=1,a=t.length,u=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,r/=2}function h(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var l=-1;for(o=r;o<a;o++)if(h(t,o)===h(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(r+u>a&&(r=a-u),o=r;o>=0;o--){for(var f=!0,c=0;c<u;c++)if(h(t,o+c)!==h(e,c)){f=!1;break}if(f)return o}return-1}function g(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=e.length;n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(e.substr(2*s,2),16);if(P(a))return s;t[r+s]=a}return s}function w(t,e,r,n){return q(D(e,t.length-r),t,r,n)}function v(t,e,r,n){return q(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function y(t,e,r,n){return v(t,e,r,n)}function b(t,e,r,n){return q(L(e),t,r,n)}function x(t,e,r,n){return q(function(t,e){for(var r,n,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(e,t.length-r),t,r,n)}function M(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function _(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o,s,a,u,h=t[i],l=null,f=h>239?4:h>223?3:h>191?2:1;if(i+f<=r)switch(f){case 1:h<128&&(l=h);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&h)<<6|63&o)>127&&(l=u);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(u=(15&h)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&h)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(l=u)}null===l?(l=65533,f=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=f}return function(t){var e=t.length;if(e<=S)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=S));return r}(n)}r.kMaxLength=o,e.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(t){return!1}}(),e.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(e.prototype,"parent",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.buffer}}),Object.defineProperty(e.prototype,"offset",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),e.poolSize=8192,e.from=function(t,e,r){return a(t,e,r)},e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,e.alloc=function(t,e,r){return function(t,e,r){return u(t),t<=0?s(t):void 0!==e?"string"==typeof r?s(t).fill(e,r):s(t).fill(e):s(t)}(t,e,r)},e.allocUnsafe=function(t){return h(t)},e.allocUnsafeSlow=function(t){return h(t)},e.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==e.prototype},e.compare=function(t,r){if(F(t,Uint8Array)&&(t=e.from(t,t.offset,t.byteLength)),F(r,Uint8Array)&&(r=e.from(r,r.offset,r.byteLength)),!e.isBuffer(t)||!e.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===r)return 0;for(var n=t.length,i=r.length,o=0,s=Math.min(n,i);o<s;++o)if(t[o]!==r[o]){n=t[o],i=r[o];break}return n<i?-1:i<n?1:0},e.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(t,r){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return e.alloc(0);var n;if(void 0===r)for(r=0,n=0;n<t.length;++n)r+=t[n].length;var i=e.allocUnsafe(r),o=0;for(n=0;n<t.length;++n){var s=t[n];if(F(s,Uint8Array)&&(s=e.from(s)),!e.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,o),o+=s.length}return i},e.byteLength=c,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)p(this,e,e+1);return this},e.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)p(this,e,e+3),p(this,e+1,e+2);return this},e.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)p(this,e,e+7),p(this,e+1,e+6),p(this,e+2,e+5),p(this,e+3,e+4);return this},e.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?_(this,0,t):function(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return j(this,e,r);case"utf8":case"utf-8":return _(this,e,r);case"ascii":return E(this,e,r);case"latin1":case"binary":return k(this,e,r);case"base64":return M(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}.apply(this,arguments)},e.prototype.toLocaleString=e.prototype.toString,e.prototype.equals=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===e.compare(this,t)},e.prototype.inspect=function(){var t="",e=r.INSPECT_MAX_BYTES;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},e.prototype.compare=function(t,r,n,i,o){if(F(t,Uint8Array)&&(t=e.from(t,t.offset,t.byteLength)),!e.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===r&&(r=0),void 0===n&&(n=t?t.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),r<0||n>t.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&r>=n)return 0;if(i>=o)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,o>>>=0,this===t)return 0;for(var s=o-i,a=n-r,u=Math.min(s,a),h=this.slice(i,o),l=t.slice(r,n),f=0;f<u;++f)if(h[f]!==l[f]){s=h[f],a=l[f];break}return s<a?-1:a<s?1:0},e.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},e.prototype.indexOf=function(t,e,r){return d(this,t,e,r,!0)},e.prototype.lastIndexOf=function(t,e,r){return d(this,t,e,r,!1)},e.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return g(this,t,e,r);case"utf8":case"utf-8":return w(this,t,e,r);case"ascii":return v(this,t,e,r);case"latin1":case"binary":return y(this,t,e,r);case"base64":return b(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;function E(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function k(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function j(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=e;o<r;++o)i+=z(t[o]);return i}function O(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function A(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function R(t,r,n,i,o,s){if(!e.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>o||r<s)throw new RangeError('"value" argument is out of bounds');if(n+i>t.length)throw new RangeError("Index out of range")}function N(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function T(t,e,r,n,o){return e=+e,r>>>=0,o||N(t,0,r,4),i.write(t,e,r,n,23,4),r+4}function I(t,e,r,n,o){return e=+e,r>>>=0,o||N(t,0,r,8),i.write(t,e,r,n,52,8),r+8}e.prototype.slice=function(t,r){var n=this.length;t=~~t,r=void 0===r?n:~~r,t<0?(t+=n)<0&&(t=0):t>n&&(t=n),r<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<t&&(r=t);var i=this.subarray(t,r);return i.__proto__=e.prototype,i},e.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||A(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},e.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||A(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},e.prototype.readUInt8=function(t,e){return t>>>=0,e||A(t,1,this.length),this[t]},e.prototype.readUInt16LE=function(t,e){return t>>>=0,e||A(t,2,this.length),this[t]|this[t+1]<<8},e.prototype.readUInt16BE=function(t,e){return t>>>=0,e||A(t,2,this.length),this[t]<<8|this[t+1]},e.prototype.readUInt32LE=function(t,e){return t>>>=0,e||A(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},e.prototype.readUInt32BE=function(t,e){return t>>>=0,e||A(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},e.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||A(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},e.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||A(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},e.prototype.readInt8=function(t,e){return t>>>=0,e||A(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},e.prototype.readInt16LE=function(t,e){t>>>=0,e||A(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},e.prototype.readInt16BE=function(t,e){t>>>=0,e||A(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},e.prototype.readInt32LE=function(t,e){return t>>>=0,e||A(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},e.prototype.readInt32BE=function(t,e){return t>>>=0,e||A(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},e.prototype.readFloatLE=function(t,e){return t>>>=0,e||A(t,4,this.length),i.read(this,t,!0,23,4)},e.prototype.readFloatBE=function(t,e){return t>>>=0,e||A(t,4,this.length),i.read(this,t,!1,23,4)},e.prototype.readDoubleLE=function(t,e){return t>>>=0,e||A(t,8,this.length),i.read(this,t,!0,52,8)},e.prototype.readDoubleBE=function(t,e){return t>>>=0,e||A(t,8,this.length),i.read(this,t,!1,52,8)},e.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||R(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},e.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||R(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},e.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,1,255,0),this[e]=255&t,e+1},e.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},e.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},e.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},e.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},e.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);R(this,t,e,r,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<r&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},e.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);R(this,t,e,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},e.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},e.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},e.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},e.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},e.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},e.prototype.writeFloatLE=function(t,e,r){return T(this,t,e,!0,r)},e.prototype.writeFloatBE=function(t,e,r){return T(this,t,e,!1,r)},e.prototype.writeDoubleLE=function(t,e,r){return I(this,t,e,!0,r)},e.prototype.writeDoubleBE=function(t,e,r){return I(this,t,e,!1,r)},e.prototype.copy=function(t,r,n,i){if(!e.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),i||0===i||(i=this.length),r>=t.length&&(r=t.length),r||(r=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-r<i-n&&(i=t.length-r+n);var o=i-n;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(r,n,i);else if(this===t&&n<r&&r<i)for(var s=o-1;s>=0;--s)t[s+r]=this[s+n];else Uint8Array.prototype.set.call(t,this.subarray(n,i),r);return o},e.prototype.fill=function(t,r,n,i){if("string"==typeof t){if("string"==typeof r?(i=r,r=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!e.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===t.length){var o=t.charCodeAt(0);("utf8"===i&&o<128||"latin1"===i)&&(t=o)}}else"number"==typeof t&&(t&=255);if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;var s;if(r>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=r;s<n;++s)this[s]=t;else{var a=e.isBuffer(t)?t:e.from(t,i),u=a.length;if(0===u)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<n-r;++s)this[s+r]=a[s%u]}return this};var C=/[^+/0-9A-Za-z-_]/g;function z(t){return t<16?"0"+t.toString(16):t.toString(16)}function D(t,e){var r;e=e||1/0;for(var n=t.length,i=null,o=[],s=0;s<n;++s){if((r=t.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function L(t){return n.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(C,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function q(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function F(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function P(t){return t!=t}}).call(this,t("buffer").Buffer)},{"base64-js":29,buffer:31,ieee754:37}],32:[function(t,e,r){(function(t){function e(t){return Object.prototype.toString.call(t)}r.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===e(t)},r.isBoolean=function(t){return"boolean"==typeof t},r.isNull=function(t){return null===t},r.isNullOrUndefined=function(t){return null==t},r.isNumber=function(t){return"number"==typeof t},r.isString=function(t){return"string"==typeof t},r.isSymbol=function(t){return"symbol"==typeof t},r.isUndefined=function(t){return void 0===t},r.isRegExp=function(t){return"[object RegExp]"===e(t)},r.isObject=function(t){return"object"==typeof t&&null!==t},r.isDate=function(t){return"[object Date]"===e(t)},r.isError=function(t){return"[object Error]"===e(t)||t instanceof Error},r.isFunction=function(t){return"function"==typeof t},r.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},r.isBuffer=t.isBuffer}).call(this,{isBuffer:t("../../is-buffer/index.js")})},{"../../is-buffer/index.js":40}],33:[function(t,e,r){(function(t){e.exports=class{constructor(e=100){this.size=e,this.length=0,this.buf=t.alloc(e)}prepend(t){const e=this.length++;e===this.size&&this.resize();const r=this.clone();this.buf[0]=t,r.copy(this.buf,1,0,e)}append(t){const e=this.length++;e===this.size&&this.resize(),this.buf[e]=t}clone(){return t.from(this.buf.slice(0,this.length))}resize(){const e=this.length;this.size=2*this.size;const r=t.alloc(this.size);this.buf.copy(r,0,0,e),this.buf=r}toString(){return this.buf.slice(0,this.length).toString()}toJSON(){return this.toString()}reset(){this.length=0}}}).call(this,t("buffer").Buffer)},{buffer:31}],34:[function(t,e,r){(function(r,n){const{Transform:i}=t("stream"),o=t("./ResizeableBuffer"),s=13,a=10,u=32,h=9,l=r.from([239,187,191]);class f extends i{constructor(t={}){super({...{readableObjectMode:!0},...t});const e={};for(let r in t)e[d(r)]=t[r];if(void 0===e.bom||null===e.bom||!1===e.bom)e.bom=!1;else if(!0!==e.bom)throw new p("CSV_INVALID_OPTION_BOM",["Invalid option bom:","bom must be true,",`got ${JSON.stringify(e.bom)}`]);let n=null;if(void 0===e.cast||null===e.cast||!1===e.cast||""===e.cast)e.cast=void 0;else if("function"==typeof e.cast)n=e.cast,e.cast=!0;else if(!0!==e.cast)throw new p("CSV_INVALID_OPTION_CAST",["Invalid option cast:","cast must be true or a function,",`got ${JSON.stringify(e.cast)}`]);if(void 0===e.cast_date||null===e.cast_date||!1===e.cast_date||""===e.cast_date)e.cast_date=!1;else if(!0===e.cast_date)e.cast_date=function(t){const e=Date.parse(t);return isNaN(e)?t:new Date(e)};else if("function"!=typeof e.cast_date)throw new p("CSV_INVALID_OPTION_CAST_DATE",["Invalid option cast_date:","cast_date must be true or a function,",`got ${JSON.stringify(e.cast_date)}`]);let i=null;if(!0===e.columns)i=void 0;else if("function"==typeof e.columns)i=e.columns,e.columns=!0;else if(Array.isArray(e.columns))e.columns=w(e.columns);else{if(void 0!==e.columns&&null!==e.columns&&!1!==e.columns)throw new p("CSV_INVALID_OPTION_COLUMNS",["Invalid option columns:","expect an object, a function or true,",`got ${JSON.stringify(e.columns)}`]);e.columns=!1}if(void 0===e.comment||null===e.comment||!1===e.comment||""===e.comment)e.comment=null;else if("string"==typeof e.comment&&(e.comment=r.from(e.comment)),!r.isBuffer(e.comment))throw new p("CSV_INVALID_OPTION_COMMENT",["Invalid option comment:","comment must be a buffer or a string,",`got ${JSON.stringify(e.comment)}`]);if(void 0===e.delimiter||null===e.delimiter||!1===e.delimiter)e.delimiter=r.from(",");else if("string"==typeof e.delimiter&&0!==e.delimiter.length)e.delimiter=r.from(e.delimiter);else if(r.isBuffer(e.delimiter)&&0===e.delimiter.length||"string"==typeof e.delimiter&&0===e.delimiter.length||!r.isBuffer(e.delimiter)&&"string"!=typeof e.delimiter)throw new p("CSV_INVALID_OPTION_DELIMITER",["Invalid option delimiter:","delimiter must be a non empty string or buffer,",`got ${JSON.stringify(e.delimiter)}`]);if(void 0===e.escape||null===e.escape?e.escape=r.from('"'):"string"==typeof e.escape&&(e.escape=r.from(e.escape)),!r.isBuffer(e.escape))throw new Error(`Invalid Option: escape must be a buffer or a string, got ${JSON.stringify(e.escape)}`);if(1!==e.escape.length)throw new Error(`Invalid Option Length: escape must be one character, got ${e.escape.length}`);if(e.escape=e.escape[0],void 0===e.from||null===e.from)e.from=1;else{if("string"==typeof e.from&&/\d+/.test(e.from)&&(e.from=parseInt(e.from)),!Number.isInteger(e.from))throw new Error(`Invalid Option: from must be an integer, got ${JSON.stringify(e.from)}`);if(e.from<0)throw new Error(`Invalid Option: from must be a positive integer, got ${JSON.stringify(t.from)}`)}if(void 0===e.from_line||null===e.from_line)e.from_line=1;else{if("string"==typeof e.from_line&&/\d+/.test(e.from_line)&&(e.from_line=parseInt(e.from_line)),!Number.isInteger(e.from_line))throw new Error(`Invalid Option: from_line must be an integer, got ${JSON.stringify(t.from_line)}`);if(e.from_line<=0)throw new Error(`Invalid Option: from_line must be a positive integer greater than 0, got ${JSON.stringify(t.from_line)}`)}if(void 0===e.info||null===e.info||!1===e.info)e.info=!1;else if(!0!==e.info)throw new Error(`Invalid Option: info must be true, got ${JSON.stringify(e.info)}`);if(void 0===e.max_record_size||null===e.max_record_size||!1===e.max_record_size)e.max_record_size=0;else if(Number.isInteger(e.max_record_size)&&e.max_record_size>=0);else{if("string"!=typeof e.max_record_size||!/\d+/.test(e.max_record_size))throw new Error(`Invalid Option: max_record_size must be a positive integer, got ${JSON.stringify(e.max_record_size)}`);e.max_record_size=parseInt(e.max_record_size)}if(void 0===e.objname||null===e.objname||!1===e.objname)e.objname=void 0;else if(r.isBuffer(e.objname)){if(0===e.objname.length)throw new Error("Invalid Option: objname must be a non empty buffer");e.objname=e.objname.toString()}else{if("string"!=typeof e.objname)throw new Error(`Invalid Option: objname must be a string or a buffer, got ${e.objname}`);if(0===e.objname.length)throw new Error("Invalid Option: objname must be a non empty string")}if(void 0===e.on_record||null===e.on_record)e.on_record=void 0;else if("function"!=typeof e.on_record)throw new p("CSV_INVALID_OPTION_ON_RECORD",["Invalid option `on_record`:","expect a function,",`got ${JSON.stringify(e.on_record)}`]);if(null===e.quote||!1===e.quote||""===e.quote)e.quote=null;else{if(void 0===e.quote||!0===e.quote?e.quote=r.from('"'):"string"==typeof e.quote&&(e.quote=r.from(e.quote)),!r.isBuffer(e.quote))throw new Error(`Invalid Option: quote must be a buffer or a string, got ${JSON.stringify(e.quote)}`);if(1!==e.quote.length)throw new Error(`Invalid Option Length: quote must be one character, got ${e.quote.length}`);e.quote=e.quote[0]}if(void 0===e.raw||null===e.raw||!1===e.raw)e.raw=!1;else if(!0!==e.raw)throw new Error(`Invalid Option: raw must be true, got ${JSON.stringify(e.raw)}`);if(e.record_delimiter?Array.isArray(e.record_delimiter)||(e.record_delimiter=[e.record_delimiter]):e.record_delimiter=[],e.record_delimiter=e.record_delimiter.map(function(t){return"string"==typeof t&&(t=r.from(t)),t}),"boolean"==typeof e.relax);else{if(void 0!==e.relax&&null!==e.relax)throw new Error(`Invalid Option: relax must be a boolean, got ${JSON.stringify(e.relax)}`);e.relax=!1}if("boolean"==typeof e.relax_column_count);else{if(void 0!==e.relax_column_count&&null!==e.relax_column_count)throw new Error(`Invalid Option: relax_column_count must be a boolean, got ${JSON.stringify(e.relax_column_count)}`);e.relax_column_count=!1}if("boolean"==typeof e.relax_column_count_less);else{if(void 0!==e.relax_column_count_less&&null!==e.relax_column_count_less)throw new Error(`Invalid Option: relax_column_count_less must be a boolean, got ${JSON.stringify(e.relax_column_count_less)}`);e.relax_column_count_less=!1}if("boolean"==typeof e.relax_column_count_more);else{if(void 0!==e.relax_column_count_more&&null!==e.relax_column_count_more)throw new Error(`Invalid Option: relax_column_count_more must be a boolean, got ${JSON.stringify(e.relax_column_count_more)}`);e.relax_column_count_more=!1}if("boolean"==typeof e.skip_empty_lines);else{if(void 0!==e.skip_empty_lines&&null!==e.skip_empty_lines)throw new Error(`Invalid Option: skip_empty_lines must be a boolean, got ${JSON.stringify(e.skip_empty_lines)}`);e.skip_empty_lines=!1}if("boolean"==typeof e.skip_lines_with_empty_values);else{if(void 0!==e.skip_lines_with_empty_values&&null!==e.skip_lines_with_empty_values)throw new Error(`Invalid Option: skip_lines_with_empty_values must be a boolean, got ${JSON.stringify(e.skip_lines_with_empty_values)}`);e.skip_lines_with_empty_values=!1}if("boolean"==typeof e.skip_lines_with_error);else{if(void 0!==e.skip_lines_with_error&&null!==e.skip_lines_with_error)throw new Error(`Invalid Option: skip_lines_with_error must be a boolean, got ${JSON.stringify(e.skip_lines_with_error)}`);e.skip_lines_with_error=!1}if(void 0===e.rtrim||null===e.rtrim||!1===e.rtrim)e.rtrim=!1;else if(!0!==e.rtrim)throw new Error(`Invalid Option: rtrim must be a boolean, got ${JSON.stringify(e.rtrim)}`);if(void 0===e.ltrim||null===e.ltrim||!1===e.ltrim)e.ltrim=!1;else if(!0!==e.ltrim)throw new Error(`Invalid Option: ltrim must be a boolean, got ${JSON.stringify(e.ltrim)}`);if(void 0===e.trim||null===e.trim||!1===e.trim)e.trim=!1;else if(!0!==e.trim)throw new Error(`Invalid Option: trim must be a boolean, got ${JSON.stringify(e.trim)}`);if(!0===e.trim&&!1!==t.ltrim?e.ltrim=!0:!0!==e.ltrim&&(e.ltrim=!1),!0===e.trim&&!1!==t.rtrim?e.rtrim=!0:!0!==e.rtrim&&(e.rtrim=!1),void 0===e.to||null===e.to)e.to=-1;else{if("string"==typeof e.to&&/\d+/.test(e.to)&&(e.to=parseInt(e.to)),!Number.isInteger(e.to))throw new Error(`Invalid Option: to must be an integer, got ${JSON.stringify(t.to)}`);if(e.to<=0)throw new Error(`Invalid Option: to must be a positive integer greater than 0, got ${JSON.stringify(t.to)}`)}if(void 0===e.to_line||null===e.to_line)e.to_line=-1;else{if("string"==typeof e.to_line&&/\d+/.test(e.to_line)&&(e.to_line=parseInt(e.to_line)),!Number.isInteger(e.to_line))throw new Error(`Invalid Option: to_line must be an integer, got ${JSON.stringify(t.to_line)}`);if(e.to_line<=0)throw new Error(`Invalid Option: to_line must be a positive integer greater than 0, got ${JSON.stringify(t.to_line)}`)}this.info={comment_lines:0,empty_lines:0,invalid_field_length:0,lines:1,records:0},this.options=e,this.state={bomSkipped:!1,castField:n,commenting:!1,enabled:1===e.from_line,escaping:!1,escapeIsQuote:e.escape===e.quote,expectedRecordLength:null===e.columns?0:e.columns.length,field:new o(20),firstLineToHeaders:i,info:Object.assign({},this.info),previousBuf:void 0,quoting:!1,stop:!1,rawBuffer:new o(100),record:[],recordHasError:!1,record_length:0,recordDelimiterMaxLength:0===e.record_delimiter.length?2:Math.max(...e.record_delimiter.map(t=>t.length)),trimChars:[r.from(" ")[0],r.from("\t")[0]],wasQuoting:!1,wasRowDelimiter:!1}}_transform(t,e,r){if(!0===this.state.stop)return;const n=this.__parse(t,!1);void 0!==n&&(this.state.stop=!0),r(n)}_flush(t){if(!0===this.state.stop)return;t(this.__parse(void 0,!0))}__parse(t,e){const{bom:n,comment:i,escape:o,from_line:u,info:h,ltrim:f,max_record_size:c,quote:d,raw:m,relax:g,rtrim:w,skip_empty_lines:v,to:y,to_line:b}=this.options;let{record_delimiter:x}=this.options;const{bomSkipped:M,previousBuf:_,rawBuffer:S,escapeIsQuote:E}=this.state;let k;if(void 0===_){if(void 0===t)return void this.push(null);k=t}else k=void 0!==_&&void 0===t?_:r.concat([_,t]);if(!1===M)if(!1===n)this.state.bomSkipped=!0;else if(k.length<3){if(!1===e)return void(this.state.previousBuf=k)}else 0===l.compare(k,0,3)&&(k=k.slice(3)),this.state.bomSkipped=!0;const j=k.length;let O;for(O=0;O<j&&!this.__needMoreData(O,j,e);O++){if(!0===this.state.wasRowDelimiter&&(this.info.lines++,!0===h&&0===this.state.record.length&&0===this.state.field.length&&!1===this.state.wasQuoting&&(this.state.info=Object.assign({},this.info)),this.state.wasRowDelimiter=!1),-1!==b&&this.info.lines>b)return this.state.stop=!0,void this.push(null);if(!1===this.state.quoting&&0===x.length){this.__autoDiscoverRowDelimiter(k,O)&&(x=this.options.record_delimiter)}const t=k[O];if(!0===m&&S.append(t),t!==s&&t!==a||!1!==this.state.wasRowDelimiter||(this.state.wasRowDelimiter=!0),!0===this.state.escaping)this.state.escaping=!1;else{if(!0===this.state.quoting&&t===o&&O+1<j){if(!E){this.state.escaping=!0;continue}if(k[O+1]===d){this.state.escaping=!0;continue}}if(!1===this.state.commenting&&t===d)if(!0===this.state.quoting){const e=k[O+1],r=w&&this.__isCharTrimable(e),n=null!==i&&this.__compareBytes(i,k,O+1,e),s=this.__isDelimiter(e,k,O+1),a=0===x.length?this.__autoDiscoverRowDelimiter(k,O+1):this.__isRecordDelimiter(e,k,O+1);if(t===o&&e===d)O++;else{if(!e||s||a||n||r){this.state.quoting=!1,this.state.wasQuoting=!0;continue}if(!1===g){const t=this.__error(new p("CSV_INVALID_CLOSING_QUOTE",["Invalid Closing Quote:",`got "${String.fromCharCode(e)}"`,`at line ${this.info.lines}`,"instead of delimiter, row delimiter, trimable character","(if activated) or comment"],this.__context()));if(void 0!==t)return t}else this.state.quoting=!1,this.state.wasQuoting=!0,this.state.field.prepend(d)}}else{if(0===this.state.field.length){this.state.quoting=!0;continue}if(!1===g){const t=this.__error(new p("INVALID_OPENING_QUOTE",["Invalid Opening Quote:",`a quote is found inside a field at line ${this.info.lines}`],this.__context(),{field:this.state.field}));if(void 0!==t)return t}}if(!1===this.state.quoting){let e=this.__isRecordDelimiter(t,k,O);if(0!==e){if(this.state.commenting&&!1===this.state.wasQuoting&&0===this.state.record.length&&0===this.state.field.length)this.info.comment_lines++;else{if(!0===v&&!1===this.state.wasQuoting&&0===this.state.record.length&&0===this.state.field.length){this.info.empty_lines++,O+=e-1;continue}if(!1===this.state.enabled&&this.info.lines+(!0===this.state.wasRowDelimiter?1:0)>=u){this.state.enabled=!0,this.__resetField(),this.__resetRow(),O+=e-1;continue}{const t=this.__onField();if(void 0!==t)return t;const e=this.__onRow();if(void 0!==e)return e}if(-1!==y&&this.info.records>=y)return this.state.stop=!0,void this.push(null)}this.state.commenting=!1,O+=e-1;continue}if(this.state.commenting)continue;if(0!==(null===i?0:this.__compareBytes(i,k,O,t))){this.state.commenting=!0;continue}let r=this.__isDelimiter(t,k,O);if(0!==r){const t=this.__onField();if(void 0!==t)return t;O+=r-1;continue}}}if(!1===this.state.commenting&&0!==c&&this.state.record_length+this.state.field.length>c){const t=this.__error(new p("CSV_MAX_RECORD_SIZE",["Max Record Size:","record exceed the maximum number of tolerated bytes",`of ${c}`,`at line ${this.info.lines}`],this.__context()));if(void 0!==t)return t}const e=!1===f||!0===this.state.quoting||0!==this.state.field.length||!this.__isCharTrimable(t),r=!1===w||!1===this.state.wasQuoting;if(!0===e&&!0===r)this.state.field.append(t);else if(!0===w&&!this.__isCharTrimable(t)){const t=this.__error(new p("CSV_NON_TRIMABLE_CHAR_AFTER_CLOSING_QUOTE",["Invalid Closing Quote:","found non trimable byte after quote",`at line ${this.info.lines}`],this.__context()));if(void 0!==t)return t}}if(!0===e)if(!0===this.state.quoting){const t=this.__error(new p("CSV_QUOTE_NOT_CLOSED",["Quote Not Closed:",`the parsing is finished with an opening quote at line ${this.info.lines}`],this.__context()));if(void 0!==t)return t}else if(!0===this.state.wasQuoting||0!==this.state.record.length||0!==this.state.field.length){const t=this.__onField();if(void 0!==t)return t;const e=this.__onRow();if(void 0!==e)return e}else!0===this.state.wasRowDelimiter?this.info.empty_lines++:!0===this.state.commenting&&this.info.comment_lines++;else this.state.previousBuf=k.slice(O);!0===this.state.wasRowDelimiter&&(this.info.lines++,this.state.wasRowDelimiter=!1)}__isCharTrimable(t){return t===u||t===h||t===s||t===a}__onRow(){const{columns:t,info:e,from:r,relax_column_count:n,relax_column_count_less:i,relax_column_count_more:o,raw:s,skip_lines_with_empty_values:a}=this.options,{enabled:u,record:h}=this.state;if(!1===u)return this.__resetRow();const l=h.length;if(!0===t)return g(h)?void this.__resetRow():this.__firstLineToColumns(h);if(!1===t&&0===this.info.records&&(this.state.expectedRecordLength=l),l!==this.state.expectedRecordLength)if(!0===n||!0===i&&l<this.state.expectedRecordLength||!0===o&&l>this.state.expectedRecordLength)this.info.invalid_field_length++;else if(!1===t){const t=this.__error(new p("CSV_INCONSISTENT_RECORD_LENGTH",["Invalid Record Length:",`expect ${this.state.expectedRecordLength},`,`got ${l} on line ${this.info.lines}`],this.__context(),{record:h}));if(void 0!==t)return t}else{const e=this.__error(new p("CSV_RECORD_DONT_MATCH_COLUMNS_LENGTH",["Invalid Record Length:",`columns length is ${t.length},`,`got ${l} on line ${this.info.lines}`],this.__context(),{record:h}));if(void 0!==e)return e}if(!0===a&&g(h))this.__resetRow();else{if(!0===this.state.recordHasError)return this.__resetRow(),void(this.state.recordHasError=!1);if(this.info.records++,1===r||this.info.records>=r)if(!1!==t){const r={};for(let e in h)void 0===t[e]||t[e].disabled||(r[t[e].name]=h[e]);const{objname:n}=this.options;if(void 0===n)if(!0===s||!0===e){const t=this.__push(Object.assign({record:r},!0===s?{raw:this.state.rawBuffer.toString()}:{},!0===e?{info:this.state.info}:{}));if(t)return t}else{const t=this.__push(r);if(t)return t}else if(!0===s||!0===e){const t=this.__push(Object.assign({record:[r[n],r]},!0===s?{raw:this.state.rawBuffer.toString()}:{},!0===e?{info:this.state.info}:{}));if(t)return t}else{const t=this.__push([r[n],r]);if(t)return t}}else if(!0===s||!0===e){const t=this.__push(Object.assign({record:h},!0===s?{raw:this.state.rawBuffer.toString()}:{},!0===e?{info:this.state.info}:{}));if(t)return t}else{const t=this.__push(h);if(t)return t}this.__resetRow()}}__firstLineToColumns(t){const{firstLineToHeaders:e}=this.state;try{const r=void 0===e?t:e.call(null,t);if(!Array.isArray(r))return this.__error(new p("CSV_INVALID_COLUMN_MAPPING",["Invalid Column Mapping:","expect an array from column function,",`got ${JSON.stringify(r)}`],this.__context(),{headers:r}));const n=w(r);return this.state.expectedRecordLength=n.length,this.options.columns=n,void this.__resetRow()}catch(t){return t}}__resetRow(){!0===this.options.raw&&this.state.rawBuffer.reset(),this.state.record=[],this.state.record_length=0}__onField(){const{cast:t,rtrim:e,max_record_size:r}=this.options,{enabled:n,wasQuoting:i}=this.state;if(!1===n)return this.__resetField();let o=this.state.field.toString();if(!0===e&&!1===i&&(o=o.trimRight()),!0===t){const[t,e]=this.__cast(o);if(void 0!==t)return t;o=e}this.state.record.push(o),0!==r&&"string"==typeof o&&(this.state.record_length+=o.length),this.__resetField()}__resetField(){this.state.field.reset(),this.state.wasQuoting=!1}__push(t){const{on_record:e}=this.options;if(void 0!==e){const r=this.__context();try{t=e.call(null,t,r)}catch(t){return t}if(void 0===t||null===t)return}this.push(t)}__cast(t){const{columns:e,relax_column_count:r}=this.options;if(!0===Array.isArray(e)&&r&&this.options.columns.length<=this.state.record.length)return[void 0,void 0];const n=this.__context();if(null!==this.state.castField)try{return[void 0,this.state.castField.call(null,t,n)]}catch(t){return[t]}return this.__isFloat(t)?[void 0,parseFloat(t)]:!1!==this.options.cast_date?[void 0,this.options.cast_date.call(null,t,n)]:[void 0,t]}__isFloat(t){return t-parseFloat(t)+1>=0}__compareBytes(t,e,r,n){if(t[0]!==n)return 0;const i=t.length;for(let n=1;n<i;n++)if(t[n]!==e[r+n])return 0;return i}__needMoreData(t,e,r){if(r)return!1;const{comment:n,delimiter:i}=this.options,{quoting:o,recordDelimiterMaxLength:s}=this.state;return e-t-1<Math.max(n?n.length:0,s,o?1+s:0,i.length,1)}__isDelimiter(t,e,r){const{delimiter:n}=this.options,i=n.length;if(n[0]!==t)return 0;for(let t=1;t<i;t++)if(n[t]!==e[r+t])return 0;return n.length}__isRecordDelimiter(t,e,r){const{record_delimiter:n}=this.options,i=n.length;t:for(let o=0;o<i;o++){const i=n[o],s=i.length;if(i[0]===t){for(let t=1;t<s;t++)if(i[t]!==e[r+t])continue t;return i.length}}return 0}__autoDiscoverRowDelimiter(t,e){const n=t[e];return n===s?t[e+1]===a?(this.options.record_delimiter.push(r.from("\r\n")),this.state.recordDelimiterMaxLength=2,2):(this.options.record_delimiter.push(r.from("\r")),this.state.recordDelimiterMaxLength=1,1):n===a?(this.options.record_delimiter.push(r.from("\n")),this.state.recordDelimiterMaxLength=1,1):0}__error(t){const{skip_lines_with_error:e}=this.options,r="string"==typeof t?new Error(t):t;return e?(this.state.recordHasError=!0,void this.emit("skip",r)):r}__context(){const{columns:t}=this.options;return{column:!0===Array.isArray(t)?t.length>this.state.record.length?t[this.state.record.length].name:null:this.state.record.length,empty_lines:this.info.empty_lines,header:!0===t,index:this.state.record.length,invalid_field_length:this.info.invalid_field_length,quoting:this.state.wasQuoting,lines:this.info.lines,records:this.info.records}}}const c=function(){let t,e,i;for(let n in arguments){const o=arguments[n],s=typeof o;if(void 0!==t||"string"!=typeof o&&!r.isBuffer(o))if(void 0===e&&m(o))e=o;else{if(void 0!==i||"function"!==s)throw new p("CSV_INVALID_ARGUMENT",["Invalid argument:",`got ${JSON.stringify(o)} at index ${n}`]);i=o}else t=o}const o=new f(e);if(i){const t=void 0===e||void 0===e.objname?[]:{};o.on("readable",function(){let r;for(;null!==(r=this.read());)void 0===e||void 0===e.objname?t.push(r):t[r[0]]=r[1]}),o.on("error",function(t){i(t,void 0,o.info)}),o.on("end",function(){i(void 0,t,o.info)})}return void 0!==t&&("function"==typeof n?n(function(){o.write(t),o.end()}):(o.write(t),o.end())),o};class p extends Error{constructor(t,e,...n){Array.isArray(e)&&(e=e.join(" ")),super(e),void 0!==Error.captureStackTrace&&Error.captureStackTrace(this,p),this.code=t;for(const t of n)for(const e in t){const n=t[e];this[e]=r.isBuffer(n)?n.toString():null==n?n:JSON.parse(JSON.stringify(n))}}}c.Parser=f,c.CsvError=p,e.exports=c;const d=function(t){return t.replace(/([A-Z])/g,function(t,e){return"_"+e.toLowerCase()})},m=function(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)},g=function(t){return t.every(t=>null==t||t.toString&&""===t.toString().trim())},w=function(t){const e=[];for(let r=0;r<t.length;r++){const n=t[r];if(void 0===n||null===n||!1===n)e[r]={disabled:!0};else if("string"==typeof n)e[r]={name:n};else{if(!m(n))throw new p("CSV_INVALID_COLUMN_DEFINITION",["Invalid column definition:","expect a string or a literal object,",`got ${JSON.stringify(n)} at position ${r}`]);if("string"!=typeof n.name)throw new p("CSV_OPTION_COLUMNS_MISSING_NAME",["Option columns missing name:",`property "name" is required at position ${r}`,"when column is an object literal"]);e[r]=n}}return e}}).call(this,t("buffer").Buffer,t("timers").setImmediate)},{"./ResizeableBuffer":33,buffer:31,stream:70,timers:71}],35:[function(t,e,r){(function(r){const n=t(".");e.exports=function(t,e={}){"string"==typeof t&&(t=r.from(t));const i=e&&e.objname?{}:[],o=new n.Parser(e);o.push=function(t){void 0===e.objname?i.push(t):i[t[0]]=t[1]};const s=o.__parse(t,!1);if(void 0!==s)throw s;const a=o.__parse(void 0,!0);if(void 0!==a)throw a;return i}}).call(this,t("buffer").Buffer)},{".":34,buffer:31}],36:[function(t,e,r){var n=Object.create||function(t){var e=function(){};return e.prototype=t,new e},i=Object.keys||function(t){var e=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(r);return r},o=Function.prototype.bind||function(t){var e=this;return function(){return e.apply(t,arguments)}};function s(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=n(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}e.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._maxListeners=void 0;var a,u=10;try{var h={};Object.defineProperty&&Object.defineProperty(h,"x",{value:0}),a=0===h.x}catch(t){a=!1}function l(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function f(t,e,r,i){var o,s,a;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((s=t._events)?(s.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),a=s[e]):(s=t._events=n(null),t._eventsCount=0),a){if("function"==typeof a?a=s[e]=i?[r,a]:[a,r]:i?a.unshift(r):a.push(r),!a.warned&&(o=l(t))&&o>0&&a.length>o){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+' "'+String(e)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=a.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",u.name,u.message)}}else a=s[e]=r,++t._eventsCount;return t}function c(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];this.listener.apply(this.target,t)}}function p(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=o.call(c,n);return i.listener=r,n.wrapFn=i,i}function d(t,e,r){var n=t._events;if(!n)return[];var i=n[e];return i?"function"==typeof i?r?[i.listener||i]:[i]:r?function(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(i):g(i,i.length):[]}function m(t){var e=this._events;if(e){var r=e[t];if("function"==typeof r)return 1;if(r)return r.length}return 0}function g(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}a?Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(t){if("number"!=typeof t||t<0||t!=t)throw new TypeError('"defaultMaxListeners" must be a positive number');u=t}}):s.defaultMaxListeners=u,s.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(t){var e,r,n,i,o,s,a="error"===t;if(s=this._events)a=a&&null==s.error;else if(!a)return!1;if(a){if(arguments.length>1&&(e=arguments[1]),e instanceof Error)throw e;var u=new Error('Unhandled "error" event. ('+e+")");throw u.context=e,u}if(!(r=s[t]))return!1;var h="function"==typeof r;switch(n=arguments.length){case 1:!function(t,e,r){if(e)t.call(r);else for(var n=t.length,i=g(t,n),o=0;o<n;++o)i[o].call(r)}(r,h,this);break;case 2:!function(t,e,r,n){if(e)t.call(r,n);else for(var i=t.length,o=g(t,i),s=0;s<i;++s)o[s].call(r,n)}(r,h,this,arguments[1]);break;case 3:!function(t,e,r,n,i){if(e)t.call(r,n,i);else for(var o=t.length,s=g(t,o),a=0;a<o;++a)s[a].call(r,n,i)}(r,h,this,arguments[1],arguments[2]);break;case 4:!function(t,e,r,n,i,o){if(e)t.call(r,n,i,o);else for(var s=t.length,a=g(t,s),u=0;u<s;++u)a[u].call(r,n,i,o)}(r,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(n-1),o=1;o<n;o++)i[o-1]=arguments[o];!function(t,e,r,n){if(e)t.apply(r,n);else for(var i=t.length,o=g(t,i),s=0;s<i;++s)o[s].apply(r,n)}(r,h,this,i)}return!0},s.prototype.addListener=function(t,e){return f(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return f(this,t,e,!0)},s.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,p(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,p(this,t,e)),this},s.prototype.removeListener=function(t,e){var r,i,o,s,a;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(r=i[t]))return this;if(r===e||r.listener===e)0==--this._eventsCount?this._events=n(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(o=-1,s=r.length-1;s>=0;s--)if(r[s]===e||r[s].listener===e){a=r[s].listener,o=s;break}if(o<0)return this;0===o?r.shift():function(t,e){for(var r=e,n=r+1,i=t.length;n<i;r+=1,n+=1)t[r]=t[n];t.pop()}(r,o),1===r.length&&(i[t]=r[0]),i.removeListener&&this.emit("removeListener",t,a||e)}return this},s.prototype.removeAllListeners=function(t){var e,r,o;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=n(null),this._eventsCount=0):r[t]&&(0==--this._eventsCount?this._events=n(null):delete r[t]),this;if(0===arguments.length){var s,a=i(r);for(o=0;o<a.length;++o)"removeListener"!==(s=a[o])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=n(null),this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(e)for(o=e.length-1;o>=0;o--)this.removeListener(t,e[o]);return this},s.prototype.listeners=function(t){return d(this,t,!0)},s.prototype.rawListeners=function(t){return d(this,t,!1)},s.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):m.call(t,e)},s.prototype.listenerCount=m,s.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],37:[function(t,e,r){r.read=function(t,e,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,h=u>>1,l=-7,f=r?i-1:0,c=r?-1:1,p=t[e+f];for(f+=c,o=p&(1<<-l)-1,p>>=-l,l+=a;l>0;o=256*o+t[e+f],f+=c,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=n;l>0;s=256*s+t[e+f],f+=c,l-=8);if(0===o)o=1-h;else{if(o===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),o-=h}return(p?-1:1)*s*Math.pow(2,o-n)},r.write=function(t,e,r,n,i,o){var s,a,u,h=8*o-i-1,l=(1<<h)-1,f=l>>1,c=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+f>=1?c/u:c*Math.pow(2,1-f))*u>=2&&(s++,u/=2),s+f>=l?(a=0,s=l):s+f>=1?(a=(e*u-1)*Math.pow(2,i),s+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;t[r+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,h+=i;h>0;t[r+p]=255&s,p+=d,s/=256,h-=8);t[r+p-d]|=128*m}},{}],38:[function(t,e,r){"function"==typeof Object.create?e.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(t,e){if(e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}}},{}],39:[function(t,e,r){"use strict";const n=Object.prototype.toString;e.exports=function(t){return n.call(t).endsWith("Array]")}},{}],40:[function(t,e,r){function n(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}e.exports=function(t){return null!=t&&(n(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&n(t.slice(0,0))}(t)||!!t._isBuffer)}},{}],41:[function(t,e,r){var n={}.toString;e.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},{}],42:[function(t,e,r){"use strict";var n,i=(n=t("is-any-array"))&&"object"==typeof n&&"default"in n?n.default:n;e.exports=function(t){if(!i(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");let e=t[0];for(let r=1;r<t.length;r++)t[r]>e&&(e=t[r]);return e}},{"is-any-array":39}],43:[function(t,e,r){"use strict";var n,i=(n=t("is-any-array"))&&"object"==typeof n&&"default"in n?n.default:n;e.exports=function(t){if(!i(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");let e=t[0];for(let r=1;r<t.length;r++)t[r]<e&&(e=t[r]);return e}},{"is-any-array":39}],44:[function(t,e,r){"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var i=n(t("is-any-array")),o=n(t("ml-array-max")),s=n(t("ml-array-min"));e.exports=function(t,e={}){if(!i(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");let r;if(void 0!==e.output){if(!i(e.output))throw new TypeError("output option must be an array if specified");r=e.output}else r=new Array(t.length);const n=s(t),a=o(t);if(n===a)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");const{min:u=(e.autoMinMax?n:0),max:h=(e.autoMinMax?a:1)}=e;if(u>=h)throw new RangeError("min option must be smaller than max option");const l=(h-u)/(a-n);for(let e=0;e<t.length;e++)r[e]=(t[e]-n)*l+u;return r}},{"is-any-array":39,"ml-array-max":42,"ml-array-min":43}],45:[function(t,e,r){"use strict";var n=t("ml-matrix");function i(t,e,r){var n=0;const i=r(e);for(var o=0;o<t.x.length;o++)n+=Math.abs(t.y[o]-i(t.x[o]));return n}function o(t,e,r,i,o){var s=r*i*i,a=n.Matrix.eye(e.length,e.length,s);const u=o(e);var h=t.x.map(t=>u(t)),l=function(t,e,r,i,o){const s=r.length,a=t.x.length;for(var u=new Array(s),h=0;h<s;h++){u[h]=new Array(a);var l=r.concat();l[h]+=i;for(var f=o(l),c=0;c<a;c++)u[h][c]=e[c]-f(t.x[c])}return new n.Matrix(u)}(t,h,e,i,o),f=function(t,e){const r=t.x.length;for(var i=new Array(r),o=0;o<r;o++)i[o]=[t.y[o]-e[o]];return new n.Matrix(i)}(t,h),c=n.inverse(a.add(l.mmul(l.transpose())));return(e=(e=new n.Matrix([e])).sub(c.mmul(l).mmul(f).mul(i).transpose())).to1DArray()}e.exports=function(t,e,r={}){let{maxIterations:n=100,gradientDifference:s=.1,damping:a=0,errorTolerance:u=.01,minValues:h,maxValues:l,initialValues:f}=r;if(a<=0)throw new Error("The damping option must be a positive number");if(!t.x||!t.y)throw new Error("The data parameter must have x and y elements");if(!Array.isArray(t.x)||t.x.length<2||!Array.isArray(t.y)||t.y.length<2)throw new Error("The data parameter elements must be an array with more than 2 points");if(t.x.length!==t.y.length)throw new Error("The data parameter elements must have the same size");var c=f||new Array(e.length).fill(1);let p=c.length;if(l=l||new Array(p).fill(Number.MAX_SAFE_INTEGER),h=h||new Array(p).fill(Number.MIN_SAFE_INTEGER),l.length!==h.length)throw new Error("minValues and maxValues must be the same size");if(!Array.isArray(c))throw new Error("initialValues must be an array");for(var d=i(t,c,e),m=d<=u,g=0;g<n&&!m;g++){c=o(t,c,a,s,e);for(let t=0;t<p;t++)c[t]=Math.min(Math.max(h[t],c[t]),l[t]);if(d=i(t,c,e),isNaN(d))break;m=d<=u}return{parameterValues:c,parameterError:d,iterations:g}}},{"ml-matrix":46}],46:[function(t,e,r){"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(r,"__esModule",{value:!0});var i=n(t("ml-array-rescale")),o=n(t("ml-array-max"));class s{constructor(t){var e,r,n,i,o,s,a,u,h,l=(t=C.checkMatrix(t)).clone(),f=l.rows,c=l.columns,p=new Array(f),d=1;for(e=0;e<f;e++)p[e]=e;for(u=new Array(f),r=0;r<c;r++){for(e=0;e<f;e++)u[e]=l.get(e,r);for(e=0;e<f;e++){for(h=Math.min(e,r),o=0,n=0;n<h;n++)o+=l.get(e,n)*u[n];u[e]-=o,l.set(e,r,u[e])}for(i=r,e=r+1;e<f;e++)Math.abs(u[e])>Math.abs(u[i])&&(i=e);if(i!==r){for(n=0;n<c;n++)s=l.get(i,n),l.set(i,n,l.get(r,n)),l.set(r,n,s);a=p[i],p[i]=p[r],p[r]=a,d=-d}if(r<f&&0!==l.get(r,r))for(e=r+1;e<f;e++)l.set(e,r,l.get(e,r)/l.get(r,r))}this.LU=l,this.pivotVector=p,this.pivotSign=d}isSingular(){for(var t=this.LU,e=t.columns,r=0;r<e;r++)if(0===t[r][r])return!0;return!1}solve(t){t=T.checkMatrix(t);var e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var r,n,i,o=t.columns,s=t.subMatrixRow(this.pivotVector,0,o-1),a=e.columns;for(i=0;i<a;i++)for(r=i+1;r<a;r++)for(n=0;n<o;n++)s[r][n]-=s[i][n]*e[r][i];for(i=a-1;i>=0;i--){for(n=0;n<o;n++)s[i][n]/=e[i][i];for(r=0;r<i;r++)for(n=0;n<o;n++)s[r][n]-=s[i][n]*e[r][i]}return s}get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var e=this.pivotSign,r=t.columns,n=0;n<r;n++)e*=t[n][n];return e}get lowerTriangularMatrix(){for(var t=this.LU,e=t.rows,r=t.columns,n=new T(e,r),i=0;i<e;i++)for(var o=0;o<r;o++)n[i][o]=i>o?t[i][o]:i===o?1:0;return n}get upperTriangularMatrix(){for(var t=this.LU,e=t.rows,r=t.columns,n=new T(e,r),i=0;i<e;i++)for(var o=0;o<r;o++)n[i][o]=i<=o?t[i][o]:0;return n}get pivotPermutationVector(){return this.pivotVector.slice()}}function a(t,e){var r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}function u(t,e,r){for(var n=new Array(t),i=0;i<t;i++){n[i]=new Array(e);for(var o=0;o<e;o++)n[i][o]=r}return n}class h{constructor(t,e={}){var r=(t=C.checkMatrix(t)).rows,n=t.columns;const{computeLeftSingularVectors:i=!0,computeRightSingularVectors:o=!0,autoTranspose:s=!1}=e;var h,l=Boolean(i),f=Boolean(o),c=!1;if(r<n)if(s){r=(h=t.transpose()).rows,n=h.columns,c=!0;var p=l;l=f,f=p}else h=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else h=t.clone();var d=Math.min(r,n),m=Math.min(r+1,n),g=new Array(m),w=u(r,d,0),v=u(n,n,0),y=new Array(n),b=new Array(r),x=new Array(m);for(let t=0;t<m;t++)x[t]=t;var M=Math.min(r-1,n),_=Math.max(0,Math.min(n-2,r)),S=Math.max(M,_);for(let t=0;t<S;t++){if(t<M){g[t]=0;for(let e=t;e<r;e++)g[t]=a(g[t],h[e][t]);if(0!==g[t]){h[t][t]<0&&(g[t]=-g[t]);for(let e=t;e<r;e++)h[e][t]/=g[t];h[t][t]+=1}g[t]=-g[t]}for(let e=t+1;e<n;e++){if(t<M&&0!==g[t]){let n=0;for(let i=t;i<r;i++)n+=h[i][t]*h[i][e];n=-n/h[t][t];for(let i=t;i<r;i++)h[i][e]+=n*h[i][t]}y[e]=h[t][e]}if(l&&t<M)for(let e=t;e<r;e++)w[e][t]=h[e][t];if(t<_){y[t]=0;for(let e=t+1;e<n;e++)y[t]=a(y[t],y[e]);if(0!==y[t]){y[t+1]<0&&(y[t]=0-y[t]);for(let e=t+1;e<n;e++)y[e]/=y[t];y[t+1]+=1}if(y[t]=-y[t],t+1<r&&0!==y[t]){for(let e=t+1;e<r;e++)b[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)b[e]+=y[r]*h[e][r];for(let e=t+1;e<n;e++){let n=-y[e]/y[t+1];for(let i=t+1;i<r;i++)h[i][e]+=n*b[i]}}if(f)for(let e=t+1;e<n;e++)v[e][t]=y[e]}}let E=Math.min(n,r+1);if(M<n&&(g[M]=h[M][M]),r<E&&(g[E-1]=0),_+1<E&&(y[_]=h[_][E-1]),y[E-1]=0,l){for(let t=M;t<d;t++){for(let e=0;e<r;e++)w[e][t]=0;w[t][t]=1}for(let t=M-1;t>=0;t--)if(0!==g[t]){for(let e=t+1;e<d;e++){let n=0;for(let i=t;i<r;i++)n+=w[i][t]*w[i][e];n=-n/w[t][t];for(let i=t;i<r;i++)w[i][e]+=n*w[i][t]}for(let e=t;e<r;e++)w[e][t]=-w[e][t];w[t][t]=1+w[t][t];for(let e=0;e<t-1;e++)w[e][t]=0}else{for(let e=0;e<r;e++)w[e][t]=0;w[t][t]=1}}if(f)for(let t=n-1;t>=0;t--){if(t<_&&0!==y[t])for(let e=t+1;e<n;e++){let r=0;for(let i=t+1;i<n;i++)r+=v[i][t]*v[i][e];r=-r/v[t+1][t];for(let i=t+1;i<n;i++)v[i][e]+=r*v[i][t]}for(let e=0;e<n;e++)v[e][t]=0;v[t][t]=1}for(var k=E-1,j=Number.EPSILON;E>0;){let t,e;for(t=E-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+j*Math.abs(g[t]+Math.abs(g[t+1]));if(Math.abs(y[t])<=e||Number.isNaN(y[t])){y[t]=0;break}}if(t===E-2)e=4;else{let r;for(r=E-1;r>=t&&r!==t;r--){let e=(r!==E?Math.abs(y[r]):0)+(r!==t+1?Math.abs(y[r-1]):0);if(Math.abs(g[r])<=j*e){g[r]=0;break}}r===t?e=3:r===E-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=y[E-2];y[E-2]=0;for(let r=E-2;r>=t;r--){let i=a(g[r],e),o=g[r]/i,s=e/i;if(g[r]=i,r!==t&&(e=-s*y[r-1],y[r-1]=o*y[r-1]),f)for(let t=0;t<n;t++)i=o*v[t][r]+s*v[t][E-1],v[t][E-1]=-s*v[t][r]+o*v[t][E-1],v[t][r]=i}break}case 2:{let e=y[t-1];y[t-1]=0;for(let n=t;n<E;n++){let i=a(g[n],e),o=g[n]/i,s=e/i;if(g[n]=i,e=-s*y[n],y[n]=o*y[n],l)for(let e=0;e<r;e++)i=o*w[e][n]+s*w[e][t-1],w[e][t-1]=-s*w[e][n]+o*w[e][t-1],w[e][n]=i}break}case 3:{const e=Math.max(Math.abs(g[E-1]),Math.abs(g[E-2]),Math.abs(y[E-2]),Math.abs(g[t]),Math.abs(y[t])),i=g[E-1]/e,o=g[E-2]/e,s=y[E-2]/e,u=g[t]/e,h=y[t]/e,c=((o+i)*(o-i)+s*s)/2,p=i*s*(i*s);let d=0;0===c&&0===p||(d=p/(c+(d=c<0?0-Math.sqrt(c*c+p):Math.sqrt(c*c+p))));let m=(u+i)*(u-i)+d,b=u*h;for(let e=t;e<E-1;e++){let i=a(m,b);0===i&&(i=Number.MIN_VALUE);let o=m/i,s=b/i;if(e!==t&&(y[e-1]=i),m=o*g[e]+s*y[e],y[e]=o*y[e]-s*g[e],b=s*g[e+1],g[e+1]=o*g[e+1],f)for(let t=0;t<n;t++)i=o*v[t][e]+s*v[t][e+1],v[t][e+1]=-s*v[t][e]+o*v[t][e+1],v[t][e]=i;if(0===(i=a(m,b))&&(i=Number.MIN_VALUE),o=m/i,s=b/i,g[e]=i,m=o*y[e]+s*g[e+1],g[e+1]=-s*y[e]+o*g[e+1],b=s*y[e+1],y[e+1]=o*y[e+1],l&&e<r-1)for(let t=0;t<r;t++)i=o*w[t][e]+s*w[t][e+1],w[t][e+1]=-s*w[t][e]+o*w[t][e+1],w[t][e]=i}y[E-2]=m;break}case 4:if(g[t]<=0&&(g[t]=g[t]<0?-g[t]:0,f))for(let e=0;e<=k;e++)v[e][t]=-v[e][t];for(;t<k&&!(g[t]>=g[t+1]);){let e=g[t];if(g[t]=g[t+1],g[t+1]=e,f&&t<n-1)for(let r=0;r<n;r++)e=v[r][t+1],v[r][t+1]=v[r][t],v[r][t]=e;if(l&&t<r-1)for(let n=0;n<r;n++)e=w[n][t+1],w[n][t+1]=w[n][t],w[n][t]=e;t++}E--}}if(c){var O=v;v=w,w=O}this.m=r,this.n=n,this.s=g,this.U=w,this.V=v}solve(t){var e=t,r=this.threshold,n=this.s.length,i=T.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?i[t][t]=0:i[t][t]=1/this.s[t];var o=this.U,s=this.rightSingularVectors,a=s.mmul(i),u=s.rows,h=o.length,l=T.zeros(u,h);for(let t=0;t<u;t++)for(let e=0;e<h;e++){let r=0;for(let i=0;i<n;i++)r+=a[t][i]*o[e][i];l[t][e]=r}return l.mmul(e)}solveForDiagonal(t){return this.solve(T.diag(t))}inverse(){var t=this.V,e=this.threshold,r=t.length,n=t[0].length,i=new T(r,this.s.length);for(let o=0;o<r;o++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e?i[o][r]=t[o][r]/this.s[r]:i[o][r]=0;var o=this.U,s=o.length,a=o[0].length,u=new T(r,s);for(let t=0;t<r;t++)for(let e=0;e<s;e++){let r=0;for(let n=0;n<a;n++)r+=i[t][n]*o[e][n];u[t][e]=r}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){for(var t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s,n=0,i=r.length;n<i;n++)r[n]>t&&e++;return e}get diagonal(){return this.s}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return T.isMatrix(this.U)||(this.U=new T(this.U)),this.U}get rightSingularVectors(){return T.isMatrix(this.V)||(this.V=new T(this.V)),this.V}get diagonalMatrix(){return T.diag(this.s)}}function l(t,e,r){var n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function f(t,e,r){var n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function c(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function p(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function d(t,e,r){return{row:m(t,e),column:g(t,r)}}function m(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for row indices");if(e.some(e=>e<0||e>=t.rows))throw new RangeError("row indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function g(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for column indices");if(e.some(e=>e<0||e>=t.columns))throw new RangeError("column indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function w(t,e,r,n,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(b("startRow",e),b("endRow",r),b("startColumn",n),b("endColumn",i),e>r||n>i||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")}function v(t){for(var e=T.zeros(t.rows,1),r=0;r<t.rows;++r)for(var n=0;n<t.columns;++n)e.set(r,0,e.get(r,0)+t.get(r,n));return e}function y(t){for(var e=T.zeros(1,t.columns),r=0;r<t.rows;++r)for(var n=0;n<t.columns;++n)e.set(0,n,e.get(0,n)+t.get(r,n));return e}function b(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}class x extends(N()){constructor(t,e,r){super(),this.matrix=t,this.rows=e,this.columns=r}static get[Symbol.species](){return T}}class M extends x{constructor(t){super(t,t.columns,t.rows)}set(t,e,r){return this.matrix.set(e,t,r),this}get(t,e){return this.matrix.get(e,t)}}class _ extends x{constructor(t,e){super(t,1,t.columns),this.row=e}set(t,e,r){return this.matrix.set(this.row,e,r),this}get(t,e){return this.matrix.get(this.row,e)}}class S extends x{constructor(t,e,r,n,i){w(t,e,r,n,i),super(t,r-e+1,i-n+1),this.startRow=e,this.startColumn=n}set(t,e,r){return this.matrix.set(this.startRow+t,this.startColumn+e,r),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}class E extends x{constructor(t,e,r){var n=d(t,e,r);super(t,n.row.length,n.column.length),this.rowIndices=n.row,this.columnIndices=n.column}set(t,e,r){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],r),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class k extends x{constructor(t,e){super(t,(e=m(t,e)).length,t.columns),this.rowIndices=e}set(t,e,r){return this.matrix.set(this.rowIndices[t],e,r),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}}class j extends x{constructor(t,e){e=g(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,r){return this.matrix.set(t,this.columnIndices[e],r),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}}class O extends x{constructor(t,e){super(t,t.rows,1),this.column=e}set(t,e,r){return this.matrix.set(t,this.column,r),this}get(t){return this.matrix.get(t,this.column)}}class A extends x{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(this.rows-t-1,e,r),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}}class R extends x{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(t,this.columns-e-1,r),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}}function N(t){void 0===t&&(t=Object);class e extends t{static get[Symbol.species](){return this}static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("Data length does not match given dimensions");for(var n=new this(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)n.set(i,o,r[i*e+o]);return n}static rowVector(t){for(var e=new this(1,t.length),r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){for(var e=new this(t.length,1),r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static empty(t,e){return new this(t,e)}static zeros(t,e){return this.empty(t,e).fill(0)}static ones(t,e){return this.empty(t,e).fill(1)}static rand(t,e,r){void 0===r&&(r=Math.random);for(var n=this.empty(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)n.set(i,o,r());return n}static randInt(t,e,r,n){void 0===r&&(r=1e3),void 0===n&&(n=Math.random);for(var i=this.empty(t,e),o=0;o<t;o++)for(var s=0;s<e;s++){var a=Math.floor(n()*r);i.set(o,s,a)}return i}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);for(var n=Math.min(t,e),i=this.zeros(t,e),o=0;o<n;o++)i.set(o,o,r);return i}static diag(t,e,r){var n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);for(var i=Math.min(n,e,r),o=this.zeros(e,r),s=0;s<i;s++)o.set(s,s,t[s]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var r=t.rows,n=t.columns,i=new this(r,n),o=0;o<r;o++)for(var s=0;s<n;s++)i.set(o,s,Math.min(t.get(o,s),e.get(o,s)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var r=t.rows,n=t.columns,i=new this(r,n),o=0;o<r;o++)for(var s=0;s<n;s++)i.set(o,s,Math.max(t.get(o,s),e.get(o,s)));return i}static checkMatrix(t){return e.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=this.rows,r=this.columns,n=0;n<e;n++)for(var i=0;i<r;i++)t.call(this,n,i);return this}to1DArray(){for(var t=new Array(this.size),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t[e*this.columns+r]=this.get(e,r);return t}to2DArray(){for(var t=new Array(this.rows),e=0;e<this.rows;e++){t[e]=new Array(this.columns);for(var r=0;r<this.columns;r++)t[e][r]=this.get(e,r)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}set(t,e,r){throw new Error("set method is unimplemented")}get(t,e){throw new Error("get method is unimplemented")}repeat(t,e){t=t||1,e=e||1;for(var r=new this.constructor[Symbol.species](this.rows*t,this.columns*e),n=0;n<t;n++)for(var i=0;i<e;i++)r.setSubMatrix(this,this.rows*n,this.columns*i);return r}fill(t){for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){l(this,t);for(var e=new Array(this.columns),r=0;r<this.columns;r++)e[r]=this.get(t,r);return e}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,e){l(this,t),e=c(this,e);for(var r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){l(this,t),l(this,e);for(var r=0;r<this.columns;r++){var n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){f(this,t);for(var e=new Array(this.rows),r=0;r<this.rows;r++)e[r]=this.get(r,t);return e}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,e){f(this,t),e=p(this,e);for(var r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){f(this,t),f(this,e);for(var r=0;r<this.rows;r++){var n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=c(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=c(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=c(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=c(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=p(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=p(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=p(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=p(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){l(this,t);for(var r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){f(this,t);for(var r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}maxIndex(){for(var t=this.get(0,0),e=[0,0],r=0;r<this.rows;r++)for(var n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}minIndex(){for(var t=this.get(0,0),e=[0,0],r=0;r<this.rows;r++)for(var n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){l(this,t);for(var e=this.get(t,0),r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){l(this,t);for(var e=this.get(t,0),r=[t,0],n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){l(this,t);for(var e=this.get(t,0),r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){l(this,t);for(var e=this.get(t,0),r=[t,0],n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){f(this,t);for(var e=this.get(0,t),r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){f(this,t);for(var e=this.get(0,t),r=[0,t],n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){f(this,t);for(var e=this.get(0,t),r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){f(this,t);for(var e=this.get(0,t),r=[0,t],n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){for(var t=Math.min(this.rows,this.columns),e=new Array(t),r=0;r<t;r++)e[r]=this.get(r,r);return e}sum(t){switch(t){case"row":return v(this);case"column":return y(this);default:return function(t){for(var e=0,r=0;r<t.rows;r++)for(var n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this)}}mean(){return this.sum()/this.size}prod(){for(var t=1,e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t*=this.get(e,r);return t}norm(t="frobenius"){var e=0;if("max"===t)return this.max();if("frobenius"===t){for(var r=0;r<this.rows;r++)for(var n=0;n<this.columns;n++)e+=this.get(r,n)*this.get(r,n);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){for(var t=0,e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){e.isMatrix(t)&&(t=t.to1DArray());var r=this.to1DArray();if(r.length!==t.length)throw new RangeError("vectors do not have the same size");for(var n=0,i=0;i<r.length;i++)n+=r[i]*t[i];return n}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var e=this.rows,r=this.columns,n=t.columns,i=new this.constructor[Symbol.species](e,n),o=new Array(r),s=0;s<n;s++){for(var a=0;a<r;a++)o[a]=t.get(a,s);for(var u=0;u<e;u++){var h=0;for(a=0;a<r;a++)h+=this.get(u,a)*o[a];i.set(u,s,h)}}return i}strassen2x2(t){var e=new this.constructor[Symbol.species](2,2);const r=this.get(0,0),n=t.get(0,0),i=this.get(0,1),o=t.get(0,1),s=this.get(1,0),a=t.get(1,0),u=this.get(1,1),h=t.get(1,1),l=(r+u)*(n+h),f=(s+u)*n,c=r*(o-h),p=u*(a-n),d=(r+i)*h,m=l+p-d+(i-u)*(a+h),g=c+d,w=f+p,v=l-f+c+(s-r)*(n+o);return e.set(0,0,m),e.set(0,1,g),e.set(1,0,w),e.set(1,1,v),e}strassen3x3(t){var e=new this.constructor[Symbol.species](3,3);const r=this.get(0,0),n=this.get(0,1),i=this.get(0,2),o=this.get(1,0),s=this.get(1,1),a=this.get(1,2),u=this.get(2,0),h=this.get(2,1),l=this.get(2,2),f=t.get(0,0),c=t.get(0,1),p=t.get(0,2),d=t.get(1,0),m=t.get(1,1),g=t.get(1,2),w=t.get(2,0),v=t.get(2,1),y=t.get(2,2),b=(r-o)*(-c+m),x=(-r+o+s)*(f-c+m),M=(o+s)*(-f+c),_=r*f,S=(-r+u+h)*(f-p+g),E=(-r+u)*(p-g),k=(u+h)*(-f+p),j=(-i+h+l)*(m+w-v),O=(i-l)*(m-v),A=i*w,R=(h+l)*(-w+v),N=(-i+s+a)*(g+w-y),T=(i-a)*(g-y),I=(s+a)*(-w+y),C=_+A+n*d,z=(r+n+i-o-s-h-l)*m+x+M+_+j+A+R,D=_+S+k+(r+n+i-s-a-u-h)*g+A+N+I,L=b+s*(-f+c+d-m-g-w+y)+x+_+A+N+T,q=b+x+M+_+a*v,F=A+N+T+I+o*p,P=_+S+E+h*(-f+p+d-m-g-w+v)+j+O+A,V=j+O+A+R+u*c,B=_+S+E+k+l*y;return e.set(0,0,C),e.set(0,1,z),e.set(0,2,D),e.set(1,0,L),e.set(1,1,q),e.set(1,2,F),e.set(2,0,P),e.set(2,1,V),e.set(2,2,B),e}mmulStrassen(t){var r=this.clone(),n=r.rows,i=r.columns,o=t.rows,s=t.columns;function a(t,r,n){var i=t.rows,o=t.columns;if(i===r&&o===n)return t;var s=e.zeros(r,n);return s=s.setSubMatrix(t,0,0)}i!==o&&console.warn(`Multiplying ${n} x ${i} and ${o} x ${s} matrix: dimensions do not match.`);var u=Math.max(n,o),h=Math.max(i,s);return function t(r,n,i,o){if(i<=512||o<=512)return r.mmul(n);i%2==1&&o%2==1?(r=a(r,i+1,o+1),n=a(n,i+1,o+1)):i%2==1?(r=a(r,i+1,o),n=a(n,i+1,o)):o%2==1&&(r=a(r,i,o+1),n=a(n,i,o+1));var s=parseInt(r.rows/2,10),u=parseInt(r.columns/2,10),h=r.subMatrix(0,s-1,0,u-1),l=n.subMatrix(0,s-1,0,u-1),f=r.subMatrix(0,s-1,u,r.columns-1),c=n.subMatrix(0,s-1,u,n.columns-1),p=r.subMatrix(s,r.rows-1,0,u-1),d=n.subMatrix(s,n.rows-1,0,u-1),m=r.subMatrix(s,r.rows-1,u,r.columns-1),g=n.subMatrix(s,n.rows-1,u,n.columns-1),w=t(e.add(h,m),e.add(l,g),s,u),v=t(e.add(p,m),l,s,u),y=t(h,e.sub(c,g),s,u),b=t(m,e.sub(d,l),s,u),x=t(e.add(h,f),g,s,u),M=t(e.sub(p,h),e.add(l,c),s,u),_=t(e.sub(f,m),e.add(d,g),s,u),S=e.add(w,b);S.sub(x),S.add(_);var E=e.add(y,x),k=e.add(v,b),j=e.sub(w,v);j.add(y),j.add(M);var O=e.zeros(2*S.rows,2*S.columns);return(O=(O=(O=(O=O.setSubMatrix(S,0,0)).setSubMatrix(E,S.rows,0)).setSubMatrix(k,0,S.columns)).setSubMatrix(j,S.rows,S.columns)).subMatrix(0,i-1,0,o-1)}(r=a(r,u,h),t=a(t,u,h),u,h)}scaleRows(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var r=this.constructor.empty(this.rows,this.columns),n=0;n<this.rows;n++){var o=i(this.getRow(n),{min:t,max:e});r.setRow(n,o)}return r}scaleColumns(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var r=this.constructor.empty(this.rows,this.columns),n=0;n<this.columns;n++){var o=i(this.getColumn(n),{min:t,max:e});r.setColumn(n,o)}return r}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var e=this.rows,r=this.columns,n=t.rows,i=t.columns,o=new this.constructor[Symbol.species](e*n,r*i),s=0;s<e;s++)for(var a=0;a<r;a++)for(var u=0;u<n;u++)for(var h=0;h<i;h++)o[n*s+u][i*a+h]=this.get(s,a)*t.get(u,h);return o}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t){void 0===t&&(t=r);for(var e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t){void 0===t&&(t=r);for(var e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){w(this,t,e,r,n);for(var i=new this.constructor[Symbol.species](e-t+1,n-r+1),o=t;o<=e;o++)for(var s=r;s<=n;s++)i[o-t][s-r]=this.get(o,s);return i}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");for(var n=new this.constructor[Symbol.species](t.length,r-e+1),i=0;i<t.length;i++)for(var o=e;o<=r;o++){if(t[i]<0||t[i]>=this.rows)throw new RangeError(`Row index out of range: ${t[i]}`);n.set(i,o-e,this.get(t[i],o))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");for(var n=new this.constructor[Symbol.species](r-e+1,t.length),i=0;i<t.length;i++)for(var o=e;o<=r;o++){if(t[i]<0||t[i]>=this.columns)throw new RangeError(`Column index out of range: ${t[i]}`);n.set(o-e,i,this.get(o,t[i]))}return n}setSubMatrix(t,e,r){w(this,e,e+(t=this.constructor.checkMatrix(t)).rows-1,r,r+t.columns-1);for(var n=0;n<t.rows;n++)for(var i=0;i<t.columns;i++)this[e+n][r+i]=t.get(n,i);return this}selection(t,e){for(var r=d(this,t,e),n=new this.constructor[Symbol.species](t.length,e.length),i=0;i<r.row.length;i++)for(var o=r.row[i],s=0;s<r.column.length;s++){var a=r.column[s];n[i][s]=this.get(o,a)}return n}trace(){for(var t=Math.min(this.rows,this.columns),e=0,r=0;r<t;r++)e+=this.get(r,r);return e}transposeView(){return new M(this)}rowView(t){return l(this,t),new _(this,t)}columnView(t){return f(this,t),new O(this,t)}flipRowView(){return new A(this)}flipColumnView(){return new R(this)}subMatrixView(t,e,r,n){return new S(this,t,e,r,n)}selectionView(t,e){return new E(this,t,e)}rowSelectionView(t){return new k(this,t)}columnSelectionView(t){return new j(this,t)}det(){var t,e,r,n,i,o;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),e=this.get(0,1),r=this.get(1,0),t*this.get(1,1)-e*r):3===this.columns?(n=this.selectionView([1,2],[1,2]),i=this.selectionView([1,2],[0,2]),o=this.selectionView([1,2],[0,1]),t=this.get(0,0),e=this.get(0,1),r=this.get(0,2),t*n.det()-e*i.det()+r*o.det()):new s(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=Number.EPSILON);for(var e=new h(this,{autoTranspose:!0}),r=e.leftSingularVectors,n=e.rightSingularVectors,i=e.diagonal,o=0;o<i.length;o++)Math.abs(i[o])>t?i[o]=1/i[o]:i[o]=0;return i=this.constructor[Symbol.species].diag(i),n.mmul(i.mmul(r.transposeView()))}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}}function r(t,e){return t-e}e.prototype.klass="Matrix",e.random=e.rand,e.diagonal=e.diag,e.prototype.diagonal=e.prototype.diag,e.identity=e.eye,e.prototype.negate=e.prototype.neg,e.prototype.tensorProduct=e.prototype.kroneckerProduct,e.prototype.determinant=e.prototype.det;var n,o="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",a=eval;for(var u of[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]]){var m=a($("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",{name:u[1],op:u[0]})),g=a($("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",{name:`${u[1]}S`,op:u[0]})),b=a($("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",{name:`${u[1]}M`,op:u[0]})),x=a($("\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",{name:u[1]}));for(n=1;n<u.length;n++)e.prototype[u[n]]=m,e.prototype[`${u[n]}S`]=g,e.prototype[`${u[n]}M`]=b,e[u[n]]=x}var N=[["~","not"]];for(var T of(["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(t){N.push([`Math.${t}`,t])}),N)){var I=a($("\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",{name:T[1],method:T[0]})),C=a($("\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",{name:T[1]}));for(n=1;n<T.length;n++)e.prototype[T[n]]=I,e[T[n]]=C}for(var z of[["Math.pow",1,"pow"]]){var D="arg0";for(n=1;n<z[1];n++)D+=`, arg${n}`;if(1!==z[1]){var L=a($("\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",{name:z[2],method:z[0],args:D})),q=a($(o,{name:z[2],args:D}));for(n=2;n<z.length;n++)e.prototype[z[n]]=L,e[z[n]]=q}else{var F={name:z[2],args:D,method:z[0]},P=a($("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",F)),V=a($("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",F)),B=a($("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",F)),U=a($("\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",F));for(n=2;n<z.length;n++)e.prototype[z[n]]=P,e.prototype[`${z[n]}M`]=B,e.prototype[`${z[n]}S`]=V,e[z[n]]=U}}function $(t,e){for(var r in e)t=t.replace(new RegExp(`%${r}%`,"g"),e[r]);return t}return e}class T extends(N(Array)){constructor(t,e){var r;if(1===arguments.length&&"number"==typeof t)return new Array(t);if(T.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>0){if(super(t),!(Number.isInteger(e)&&e>0))throw new TypeError("nColumns must be a positive integer");for(r=0;r<t;r++)this[r]=new Array(e)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");{const n=t;if(t=n.length,"number"!=typeof(e=n[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),r=0;r<t;r++){if(n[r].length!==e)throw new RangeError("Inconsistent array dimensions");this[r]=[].concat(n[r])}}}return this.rows=t,this.columns=e,this}set(t,e,r){return this[t][e]=r,this}get(t,e){return this[t][e]}removeRow(t){if(l(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),l(this,t,!0),e=c(this,e),this.splice(t,0,e),this.rows+=1,this}removeColumn(t){if(f(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var e=0;e<this.rows;e++)this[e].splice(t,1);return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),f(this,t,!0),e=p(this,e);for(var r=0;r<this.rows;r++)this[r].splice(t,0,e[r]);return this.columns+=1,this}}class I extends(N()){constructor(t,e={}){const{rows:r=1}=e;if(t.length%r!=0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=r,this.columns=t.length/r,this.data=t}set(t,e,r){var n=this._calculateIndex(t,e);return this.data[n]=r,this}get(t,e){var r=this._calculateIndex(t,e);return this.data[r]}_calculateIndex(t,e){return t*this.columns+e}static get[Symbol.species](){return T}}class C extends(N()){constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}static get[Symbol.species](){return T}}class z{constructor(t){var e,r,n,i,o=(t=C.checkMatrix(t)).clone(),s=t.rows,u=t.columns,h=new Array(u);for(n=0;n<u;n++){var l=0;for(e=n;e<s;e++)l=a(l,o.get(e,n));if(0!==l){for(o.get(n,n)<0&&(l=-l),e=n;e<s;e++)o.set(e,n,o.get(e,n)/l);for(o.set(n,n,o.get(n,n)+1),r=n+1;r<u;r++){for(i=0,e=n;e<s;e++)i+=o.get(e,n)*o.get(e,r);for(i=-i/o.get(n,n),e=n;e<s;e++)o.set(e,r,o.get(e,r)+i*o.get(e,n))}}h[n]=-l}this.QR=o,this.Rdiag=h}solve(t){t=T.checkMatrix(t);var e=this.QR,r=e.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var n,i,o,s,a=t.columns,u=t.clone(),h=e.columns;for(o=0;o<h;o++)for(i=0;i<a;i++){for(s=0,n=o;n<r;n++)s+=e[n][o]*u[n][i];for(s=-s/e[o][o],n=o;n<r;n++)u[n][i]+=s*e[n][o]}for(o=h-1;o>=0;o--){for(i=0;i<a;i++)u[o][i]/=this.Rdiag[o];for(n=0;n<o;n++)for(i=0;i<a;i++)u[n][i]-=u[o][i]*e[n][o]}return u.subMatrix(0,h-1,0,a-1)}isFullRank(){for(var t=this.QR.columns,e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){var t,e,r=this.QR,n=r.columns,i=new T(n,n);for(t=0;t<n;t++)for(e=0;e<n;e++)i[t][e]=t<e?r[t][e]:t===e?this.Rdiag[t]:0;return i}get orthogonalMatrix(){var t,e,r,n,i=this.QR,o=i.rows,s=i.columns,a=new T(o,s);for(r=s-1;r>=0;r--){for(t=0;t<o;t++)a[t][r]=0;for(a[r][r]=1,e=r;e<s;e++)if(0!==i[r][r]){for(n=0,t=r;t<o;t++)n+=i[t][r]*a[t][e];for(n=-n/i[r][r],t=r;t<o;t++)a[t][e]+=n*i[t][r]}}return a}}function D(t,e,r=!1){return t=C.checkMatrix(t),e=C.checkMatrix(e),r?new h(t).solve(e):t.isSquare()?new s(t).solve(e):new z(t).solve(e)}function L(t,e){for(var r=[],n=0;n<t;n++)n!==e&&r.push(n);return r}function q(t,e,r,n=1e-9,i=1e-9){if(t>i)return new Array(e.rows+1).fill(0);for(var o=e.addRow(r,[0]),s=0;s<o.rows;s++)Math.abs(o.get(s,0))<n&&o.set(s,0,0);return o.to1DArray()}class F{constructor(t,e={}){const{assumeSymmetric:r=!1}=e;if(!(t=C.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var n,i,o=t.columns,s=u(o,o,0),h=new Array(o),l=new Array(o),f=t;if(!!r||t.isSymmetric()){for(n=0;n<o;n++)for(i=0;i<o;i++)s[n][i]=f.get(n,i);!function(t,e,r,n){var i,o,s,a,u,h,l,f;for(u=0;u<t;u++)r[u]=n[t-1][u];for(a=t-1;a>0;a--){for(f=0,s=0,h=0;h<a;h++)f+=Math.abs(r[h]);if(0===f)for(e[a]=r[a-1],u=0;u<a;u++)r[u]=n[a-1][u],n[a][u]=0,n[u][a]=0;else{for(h=0;h<a;h++)r[h]/=f,s+=r[h]*r[h];for(i=r[a-1],o=Math.sqrt(s),i>0&&(o=-o),e[a]=f*o,s-=i*o,r[a-1]=i-o,u=0;u<a;u++)e[u]=0;for(u=0;u<a;u++){for(i=r[u],n[u][a]=i,o=e[u]+n[u][u]*i,h=u+1;h<=a-1;h++)o+=n[h][u]*r[h],e[h]+=n[h][u]*i;e[u]=o}for(i=0,u=0;u<a;u++)e[u]/=s,i+=e[u]*r[u];for(l=i/(s+s),u=0;u<a;u++)e[u]-=l*r[u];for(u=0;u<a;u++){for(i=r[u],o=e[u],h=u;h<=a-1;h++)n[h][u]-=i*e[h]+o*r[h];r[u]=n[a-1][u],n[a][u]=0}}r[a]=s}for(a=0;a<t-1;a++){if(n[t-1][a]=n[a][a],n[a][a]=1,0!==(s=r[a+1])){for(h=0;h<=a;h++)r[h]=n[h][a+1]/s;for(u=0;u<=a;u++){for(o=0,h=0;h<=a;h++)o+=n[h][a+1]*n[h][u];for(h=0;h<=a;h++)n[h][u]-=o*r[h]}}for(h=0;h<=a;h++)n[h][a+1]=0}for(u=0;u<t;u++)r[u]=n[t-1][u],n[t-1][u]=0;n[t-1][t-1]=1,e[0]=0}(o,l,h,s),function(t,e,r,n){var i,o,s,u,h,l,f,c,p,d,m,g,w,v,y,b;for(s=1;s<t;s++)e[s-1]=e[s];e[t-1]=0;var x=0,M=0,_=Number.EPSILON;for(l=0;l<t;l++){for(M=Math.max(M,Math.abs(r[l])+Math.abs(e[l])),f=l;f<t&&!(Math.abs(e[f])<=_*M);)f++;if(f>l)do{for(i=r[l],c=(r[l+1]-i)/(2*e[l]),p=a(c,1),c<0&&(p=-p),r[l]=e[l]/(c+p),r[l+1]=e[l]*(c+p),d=r[l+1],o=i-r[l],s=l+2;s<t;s++)r[s]-=o;for(x+=o,c=r[f],g=m=1,w=m,v=e[l+1],y=0,b=0,s=f-1;s>=l;s--)for(w=g,g=m,b=y,i=m*e[s],o=m*c,p=a(c,e[s]),e[s+1]=y*p,y=e[s]/p,c=(m=c/p)*r[s]-y*i,r[s+1]=o+y*(m*i+y*r[s]),h=0;h<t;h++)o=n[h][s+1],n[h][s+1]=y*n[h][s]+m*o,n[h][s]=m*n[h][s]-y*o;c=-y*b*w*v*e[l]/d,e[l]=y*c,r[l]=m*c}while(Math.abs(e[l])>_*M);r[l]=r[l]+x,e[l]=0}for(s=0;s<t-1;s++){for(h=s,c=r[s],u=s+1;u<t;u++)r[u]<c&&(h=u,c=r[u]);if(h!==s)for(r[h]=r[s],r[s]=c,u=0;u<t;u++)c=n[u][s],n[u][s]=n[u][h],n[u][h]=c}}(o,l,h,s)}else{var c=u(o,o,0),p=new Array(o);for(i=0;i<o;i++)for(n=0;n<o;n++)c[n][i]=f.get(n,i);!function(t,e,r,n){var i,o,s,a,u,h,l,f=t-1;for(h=1;h<=f-1;h++){for(l=0,a=h;a<=f;a++)l+=Math.abs(e[a][h-1]);if(0!==l){for(s=0,a=f;a>=h;a--)r[a]=e[a][h-1]/l,s+=r[a]*r[a];for(o=Math.sqrt(s),r[h]>0&&(o=-o),s-=r[h]*o,r[h]=r[h]-o,u=h;u<t;u++){for(i=0,a=f;a>=h;a--)i+=r[a]*e[a][u];for(i/=s,a=h;a<=f;a++)e[a][u]-=i*r[a]}for(a=0;a<=f;a++){for(i=0,u=f;u>=h;u--)i+=r[u]*e[a][u];for(i/=s,u=h;u<=f;u++)e[a][u]-=i*r[u]}r[h]=l*r[h],e[h][h-1]=l*o}}for(a=0;a<t;a++)for(u=0;u<t;u++)n[a][u]=a===u?1:0;for(h=f-1;h>=1;h--)if(0!==e[h][h-1]){for(a=h+1;a<=f;a++)r[a]=e[a][h-1];for(u=h;u<=f;u++){for(o=0,a=h;a<=f;a++)o+=r[a]*n[a][u];for(o=o/r[h]/e[h][h-1],a=h;a<=f;a++)n[a][u]+=o*r[a]}}}(o,c,p,s),function(t,e,r,n,i){var o,s,a,u,h,l,f,c,p,d,m,g,w,v,y,b=t-1,x=t-1,M=Number.EPSILON,_=0,S=0,E=0,k=0,j=0,O=0,A=0,R=0;for(o=0;o<t;o++)for((o<0||o>x)&&(r[o]=i[o][o],e[o]=0),s=Math.max(o-1,0);s<t;s++)S+=Math.abs(i[o][s]);for(;b>=0;){for(u=b;u>0&&(0===(O=Math.abs(i[u-1][u-1])+Math.abs(i[u][u]))&&(O=S),!(Math.abs(i[u][u-1])<M*O));)u--;if(u===b)i[b][b]=i[b][b]+_,r[b]=i[b][b],e[b]=0,b--,R=0;else if(u===b-1){if(f=i[b][b-1]*i[b-1][b],E=(i[b-1][b-1]-i[b][b])/2,k=E*E+f,A=Math.sqrt(Math.abs(k)),i[b][b]=i[b][b]+_,i[b-1][b-1]=i[b-1][b-1]+_,c=i[b][b],k>=0){for(A=E>=0?E+A:E-A,r[b-1]=c+A,r[b]=r[b-1],0!==A&&(r[b]=c-f/A),e[b-1]=0,e[b]=0,c=i[b][b-1],O=Math.abs(c)+Math.abs(A),E=c/O,k=A/O,j=Math.sqrt(E*E+k*k),E/=j,k/=j,s=b-1;s<t;s++)A=i[b-1][s],i[b-1][s]=k*A+E*i[b][s],i[b][s]=k*i[b][s]-E*A;for(o=0;o<=b;o++)A=i[o][b-1],i[o][b-1]=k*A+E*i[o][b],i[o][b]=k*i[o][b]-E*A;for(o=0;o<=x;o++)A=n[o][b-1],n[o][b-1]=k*A+E*n[o][b],n[o][b]=k*n[o][b]-E*A}else r[b-1]=c+E,r[b]=c+E,e[b-1]=A,e[b]=-A;b-=2,R=0}else{if(c=i[b][b],p=0,f=0,u<b&&(p=i[b-1][b-1],f=i[b][b-1]*i[b-1][b]),10===R){for(_+=c,o=0;o<=b;o++)i[o][o]-=c;O=Math.abs(i[b][b-1])+Math.abs(i[b-1][b-2]),c=p=.75*O,f=-.4375*O*O}if(30===R&&(O=(O=(p-c)/2)*O+f)>0){for(O=Math.sqrt(O),p<c&&(O=-O),O=c-f/((p-c)/2+O),o=0;o<=b;o++)i[o][o]-=O;_+=O,c=p=f=.964}for(R+=1,h=b-2;h>=u&&(A=i[h][h],E=((j=c-A)*(O=p-A)-f)/i[h+1][h]+i[h][h+1],k=i[h+1][h+1]-A-j-O,j=i[h+2][h+1],O=Math.abs(E)+Math.abs(k)+Math.abs(j),E/=O,k/=O,j/=O,h!==u)&&!(Math.abs(i[h][h-1])*(Math.abs(k)+Math.abs(j))<M*(Math.abs(E)*(Math.abs(i[h-1][h-1])+Math.abs(A)+Math.abs(i[h+1][h+1]))));)h--;for(o=h+2;o<=b;o++)i[o][o-2]=0,o>h+2&&(i[o][o-3]=0);for(a=h;a<=b-1&&(v=a!==b-1,a!==h&&(E=i[a][a-1],k=i[a+1][a-1],j=v?i[a+2][a-1]:0,0!==(c=Math.abs(E)+Math.abs(k)+Math.abs(j))&&(E/=c,k/=c,j/=c)),0!==c);a++)if(O=Math.sqrt(E*E+k*k+j*j),E<0&&(O=-O),0!==O){for(a!==h?i[a][a-1]=-O*c:u!==h&&(i[a][a-1]=-i[a][a-1]),c=(E+=O)/O,p=k/O,A=j/O,k/=E,j/=E,s=a;s<t;s++)E=i[a][s]+k*i[a+1][s],v&&(E+=j*i[a+2][s],i[a+2][s]=i[a+2][s]-E*A),i[a][s]=i[a][s]-E*c,i[a+1][s]=i[a+1][s]-E*p;for(o=0;o<=Math.min(b,a+3);o++)E=c*i[o][a]+p*i[o][a+1],v&&(E+=A*i[o][a+2],i[o][a+2]=i[o][a+2]-E*j),i[o][a]=i[o][a]-E,i[o][a+1]=i[o][a+1]-E*k;for(o=0;o<=x;o++)E=c*n[o][a]+p*n[o][a+1],v&&(E+=A*n[o][a+2],n[o][a+2]=n[o][a+2]-E*j),n[o][a]=n[o][a]-E,n[o][a+1]=n[o][a+1]-E*k}}}if(0===S)return;for(b=t-1;b>=0;b--)if(E=r[b],0===(k=e[b]))for(u=b,i[b][b]=1,o=b-1;o>=0;o--){for(f=i[o][o]-E,j=0,s=u;s<=b;s++)j+=i[o][s]*i[s][b];if(e[o]<0)A=f,O=j;else if(u=o,0===e[o]?i[o][b]=0!==f?-j/f:-j/(M*S):(c=i[o][o+1],p=i[o+1][o],k=(r[o]-E)*(r[o]-E)+e[o]*e[o],l=(c*O-A*j)/k,i[o][b]=l,i[o+1][b]=Math.abs(c)>Math.abs(A)?(-j-f*l)/c:(-O-p*l)/A),l=Math.abs(i[o][b]),M*l*l>1)for(s=o;s<=b;s++)i[s][b]=i[s][b]/l}else if(k<0)for(u=b-1,Math.abs(i[b][b-1])>Math.abs(i[b-1][b])?(i[b-1][b-1]=k/i[b][b-1],i[b-1][b]=-(i[b][b]-E)/i[b][b-1]):(y=P(0,-i[b-1][b],i[b-1][b-1]-E,k),i[b-1][b-1]=y[0],i[b-1][b]=y[1]),i[b][b-1]=0,i[b][b]=1,o=b-2;o>=0;o--){for(d=0,m=0,s=u;s<=b;s++)d+=i[o][s]*i[s][b-1],m+=i[o][s]*i[s][b];if(f=i[o][o]-E,e[o]<0)A=f,j=d,O=m;else if(u=o,0===e[o]?(y=P(-d,-m,f,k),i[o][b-1]=y[0],i[o][b]=y[1]):(c=i[o][o+1],p=i[o+1][o],g=(r[o]-E)*(r[o]-E)+e[o]*e[o]-k*k,w=2*(r[o]-E)*k,0===g&&0===w&&(g=M*S*(Math.abs(f)+Math.abs(k)+Math.abs(c)+Math.abs(p)+Math.abs(A))),y=P(c*j-A*d+k*m,c*O-A*m-k*d,g,w),i[o][b-1]=y[0],i[o][b]=y[1],Math.abs(c)>Math.abs(A)+Math.abs(k)?(i[o+1][b-1]=(-d-f*i[o][b-1]+k*i[o][b])/c,i[o+1][b]=(-m-f*i[o][b]-k*i[o][b-1])/c):(y=P(-j-p*i[o][b-1],-O-p*i[o][b],A,k),i[o+1][b-1]=y[0],i[o+1][b]=y[1])),l=Math.max(Math.abs(i[o][b-1]),Math.abs(i[o][b])),M*l*l>1)for(s=o;s<=b;s++)i[s][b-1]=i[s][b-1]/l,i[s][b]=i[s][b]/l}for(o=0;o<t;o++)if(o<0||o>x)for(s=o;s<t;s++)n[o][s]=i[o][s];for(s=t-1;s>=0;s--)for(o=0;o<=x;o++){for(A=0,a=0;a<=Math.min(s,x);a++)A+=n[o][a]*i[a][s];n[o][s]=A}}(o,l,h,s,c)}this.n=o,this.e=l,this.d=h,this.V=s}get realEigenvalues(){return this.d}get imaginaryEigenvalues(){return this.e}get eigenvectorMatrix(){return T.isMatrix(this.V)||(this.V=new T(this.V)),this.V}get diagonalMatrix(){var t,e,r=this.n,n=this.e,i=this.d,o=new T(r,r);for(t=0;t<r;t++){for(e=0;e<r;e++)o[t][e]=0;o[t][t]=i[t],n[t]>0?o[t][t+1]=n[t]:n[t]<0&&(o[t][t-1]=n[t])}return o}}function P(t,e,r,n){var i,o;return Math.abs(r)>Math.abs(n)?[(t+(i=n/r)*e)/(o=r+i*n),(e-i*t)/o]:[((i=r/n)*t+e)/(o=n+i*r),(i*e-t)/o]}class V{constructor(t){if(!(t=C.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var e,r,n,i=t,o=i.rows,s=new T(o,o),a=!0;for(r=0;r<o;r++){var u=s[r],h=0;for(n=0;n<r;n++){var l=s[n],f=0;for(e=0;e<n;e++)f+=l[e]*u[e];u[n]=f=(i.get(r,n)-f)/s[n][n],h+=f*f}for(a&=(h=i.get(r,r)-h)>0,s[r][r]=Math.sqrt(Math.max(h,0)),n=r+1;n<o;n++)s[r][n]=0}if(!a)throw new Error("Matrix is not positive definite");this.L=s}solve(t){t=C.checkMatrix(t);var e=this.L,r=e.rows;if(t.rows!==r)throw new Error("Matrix dimensions do not match");var n,i,o,s=t.columns,a=t.clone();for(o=0;o<r;o++)for(i=0;i<s;i++){for(n=0;n<o;n++)a[o][i]-=a[n][i]*e[o][n];a[o][i]/=e[o][o]}for(o=r-1;o>=0;o--)for(i=0;i<s;i++){for(n=o+1;n<r;n++)a[o][i]-=a[n][i]*e[n][o];a[o][i]/=e[o][o]}return a}get lowerTriangularMatrix(){return this.L}}r.CHO=V,r.CholeskyDecomposition=V,r.EVD=F,r.EigenvalueDecomposition=F,r.LU=s,r.LuDecomposition=s,r.Matrix=T,r.QR=z,r.QrDecomposition=z,r.SVD=h,r.SingularValueDecomposition=h,r.WrapperMatrix1D=I,r.WrapperMatrix2D=C,r.abstractMatrix=N,r.default=T,r.inverse=function(t,e=!1){return t=C.checkMatrix(t),e?new h(t).inverse():D(t,T.eye(t.rows))},r.linearDependencies=function(t,e={}){const{thresholdValue:r=1e-9,thresholdError:n=1e-9}=e;for(var i=t.rows,s=new T(i,i),a=0;a<i;a++){var u=T.columnVector(t.getRow(a)),l=t.subMatrixRow(L(i,a)).transposeView(),f=new h(l).solve(u),c=o(T.sub(u,l.mmul(f)).abs().to1DArray());s.setRow(a,q(c,f,a,r,n))}return s},r.solve=D,r.wrap=function(t,e){if(Array.isArray(t))return t[0]&&Array.isArray(t[0])?new C(t):new I(t,e);throw new Error("the argument is not an array")}},{"ml-array-max":42,"ml-array-rescale":44}],47:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,i=(n=t("ml-array-rescale"))&&"object"==typeof n&&"default"in n?n.default:n;function o(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function s(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function a(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function u(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function h(t,e,r){return{row:l(t,e),column:f(t,r)}}function l(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for row indices");if(e.some(e=>e<0||e>=t.rows))throw new RangeError("row indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function f(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for column indices");if(e.some(e=>e<0||e>=t.columns))throw new RangeError("column indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function c(t,e,r,n,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(d("startRow",e),d("endRow",r),d("startColumn",n),d("endColumn",i),e>r||n>i||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")}function p(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function d(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}const m=15,g=10,w=8;function v(t){const e=String(t);if(e.length<=w)return e.padEnd(w," ");const r=t.toPrecision(w-2);if(r.length<=w)return r;const n=t.toExponential(w-2),i=n.indexOf("e"),o=n.substring(i);return n.substring(0,w-o.length)+o}class y{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new x(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++)n.set(i,t,r[i*e+t]);return n}static rowVector(t){let e=new x(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new x(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new x(t,e)}static ones(t,e){return new x(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let i=new x(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)i.set(r,t,n());return i}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:i=1e3,random:o=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(i))throw new TypeError("max must be an integer");if(n>=i)throw new RangeError("min must be smaller than max");let s=i-n,a=new x(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(o()*s);a.set(r,t,e)}return a}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),i=this.zeros(t,e);for(let t=0;t<n;t++)i.set(t,t,r);return i}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let i=Math.min(n,e,r),o=this.zeros(e,r);for(let e=0;e<i;e++)o.set(e,e,t[e]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,i=new x(r,n);for(let o=0;o<r;o++)for(let r=0;r<n;r++)i.set(o,r,Math.min(t.get(o,r),e.get(o,r)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,i=new this(r,n);for(let o=0;o<r;o++)for(let r=0;r<n;r++)i.set(o,r,Math.max(t.get(o,r),e.get(o,r)));return i}static checkMatrix(t){return y.isMatrix(t)?t:new x(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let i=e;i<t.rows;i++)t.get(i,r)>t.get(n,r)&&(n=i);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let i=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/i);for(let n=e+1;n<t.rows;n++){let i=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let o=r+1;o<t.columns;o++)t.set(n,o,t.get(n,o)-t.get(e,o)*i)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let i=0,o=!1;for(;i<r&&!1===o;)1===t.get(n,i)?o=!0:i++;for(let r=0;r<n;r++){let o=t.get(r,i);for(let s=i;s<e;s++){let e=t.get(r,s)-o*t.get(n,s);t.set(r,s,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new x(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){o(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return x.rowVector(this.getRow(t))}setRow(t,e){o(this,t),e=a(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){o(this,t),o(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){s(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return x.columnVector(this.getColumn(t))}setColumn(t,e){s(this,t),e=u(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){s(this,t),s(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=a(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=a(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=a(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=a(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){o(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){s(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(){let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}maxIndex(){let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(){let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}minIndex(){let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){o(this,t);let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){o(this,t);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){o(this,t);let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){o(this,t);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){s(this,t);let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){s(this,t);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){s(this,t);let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){s(this,t);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){y.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=x.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,i=new x(e,n),o=new Float64Array(r);for(let s=0;s<n;s++){for(let e=0;e<r;e++)o[e]=t.get(e,s);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*o[n];i.set(t,s,e)}}return i}strassen2x2(t){t=x.checkMatrix(t);let e=new x(2,2);const r=this.get(0,0),n=t.get(0,0),i=this.get(0,1),o=t.get(0,1),s=this.get(1,0),a=t.get(1,0),u=this.get(1,1),h=t.get(1,1),l=(r+u)*(n+h),f=(s+u)*n,c=r*(o-h),p=u*(a-n),d=(r+i)*h,m=l+p-d+(i-u)*(a+h),g=c+d,w=f+p,v=l-f+c+(s-r)*(n+o);return e.set(0,0,m),e.set(0,1,g),e.set(1,0,w),e.set(1,1,v),e}strassen3x3(t){t=x.checkMatrix(t);let e=new x(3,3);const r=this.get(0,0),n=this.get(0,1),i=this.get(0,2),o=this.get(1,0),s=this.get(1,1),a=this.get(1,2),u=this.get(2,0),h=this.get(2,1),l=this.get(2,2),f=t.get(0,0),c=t.get(0,1),p=t.get(0,2),d=t.get(1,0),m=t.get(1,1),g=t.get(1,2),w=t.get(2,0),v=t.get(2,1),y=t.get(2,2),b=(r-o)*(-c+m),M=(-r+o+s)*(f-c+m),_=(o+s)*(-f+c),S=r*f,E=(-r+u+h)*(f-p+g),k=(-r+u)*(p-g),j=(u+h)*(-f+p),O=(-i+h+l)*(m+w-v),A=(i-l)*(m-v),R=i*w,N=(h+l)*(-w+v),T=(-i+s+a)*(g+w-y),I=(i-a)*(g-y),C=(s+a)*(-w+y),z=S+R+n*d,D=(r+n+i-o-s-h-l)*m+M+_+S+O+R+N,L=S+E+j+(r+n+i-s-a-u-h)*g+R+T+C,q=b+s*(-f+c+d-m-g-w+y)+M+S+R+T+I,F=b+M+_+S+a*v,P=R+T+I+C+o*p,V=S+E+k+h*(-f+p+d-m-g-w+v)+O+A+R,B=O+A+R+N+u*c,U=S+E+k+j+l*y;return e.set(0,0,z),e.set(0,1,D),e.set(0,2,L),e.set(1,0,q),e.set(1,1,F),e.set(1,2,P),e.set(2,0,V),e.set(2,1,B),e.set(2,2,U),e}mmulStrassen(t){t=x.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,i=t.rows,o=t.columns;function s(t,e,r){let n=t.rows,i=t.columns;if(n===e&&i===r)return t;{let n=y.zeros(e,r);return n=n.setSubMatrix(t,0,0)}}n!==i&&console.warn(`Multiplying ${r} x ${n} and ${i} x ${o} matrix: dimensions do not match.`);let a=Math.max(r,i),u=Math.max(n,o);return function t(e,r,n,i){if(n<=512||i<=512)return e.mmul(r);n%2==1&&i%2==1?(e=s(e,n+1,i+1),r=s(r,n+1,i+1)):n%2==1?(e=s(e,n+1,i),r=s(r,n+1,i)):i%2==1&&(e=s(e,n,i+1),r=s(r,n,i+1));let o=parseInt(e.rows/2,10),a=parseInt(e.columns/2,10),u=e.subMatrix(0,o-1,0,a-1),h=r.subMatrix(0,o-1,0,a-1),l=e.subMatrix(0,o-1,a,e.columns-1),f=r.subMatrix(0,o-1,a,r.columns-1),c=e.subMatrix(o,e.rows-1,0,a-1),p=r.subMatrix(o,r.rows-1,0,a-1),d=e.subMatrix(o,e.rows-1,a,e.columns-1),m=r.subMatrix(o,r.rows-1,a,r.columns-1),g=t(y.add(u,d),y.add(h,m),o,a),w=t(y.add(c,d),h,o,a),v=t(u,y.sub(f,m),o,a),b=t(d,y.sub(p,h),o,a),x=t(y.add(u,l),m,o,a),M=t(y.sub(c,u),y.add(h,f),o,a),_=t(y.sub(l,d),y.add(p,m),o,a),S=y.add(g,b);S.sub(x),S.add(_);let E=y.add(v,x),k=y.add(w,b),j=y.sub(g,w);j.add(v),j.add(M);let O=y.zeros(2*S.rows,2*S.columns);return(O=(O=(O=(O=O.setSubMatrix(S,0,0)).setSubMatrix(E,S.rows,0)).setSubMatrix(k,0,S.columns)).setSubMatrix(j,S.rows,S.columns)).subMatrix(0,n-1,0,i-1)}(e=s(e,a,u),t=s(t,a,u),a,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new x(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);i(o,{min:e,max:r,output:o}),n.setRow(t,o)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new x(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);i(o,{min:e,max:r,output:o}),n.setColumn(t,o)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=x.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,i=t.columns,o=new x(e*n,r*i);for(let s=0;s<e;s++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let a=0;a<i;a++)o.set(n*s+r,i*e+a,this.get(s,e)*t.get(r,a));return o}transpose(){let t=new x(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=b){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=b){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){c(this,t,e,r,n);let i=new x(e-t+1,n-r+1);for(let o=t;o<=e;o++)for(let e=r;e<=n;e++)i.set(o-t,e-r,this.get(o,e));return i}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new x(t.length,r-e+1);for(let i=0;i<t.length;i++)for(let o=e;o<=r;o++){if(t[i]<0||t[i]>=this.rows)throw new RangeError(`Row index out of range: ${t[i]}`);n.set(i,o-e,this.get(t[i],o))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new x(r-e+1,t.length);for(let i=0;i<t.length;i++)for(let o=e;o<=r;o++){if(t[i]<0||t[i]>=this.columns)throw new RangeError(`Column index out of range: ${t[i]}`);n.set(o-e,i,this.get(o,t[i]))}return n}setSubMatrix(t,e,r){c(this,e,e+(t=x.checkMatrix(t)).rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)this.set(e+n,r+i,t.get(n,i));return this}selection(t,e){let r=h(this,t,e),n=new x(t.length,e.length);for(let t=0;t<r.row.length;t++){let e=r.row[t];for(let i=0;i<r.column.length;i++){let o=r.column[i];n.set(t,i,this.get(e,o))}}return n}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new x(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=p(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=p(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=p(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=p(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Array.isArray(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,i=t.columns,o=[];for(let s=0;s<n;s++){let n=0,a=0,u=0;for(let e=0;e<i;e++)n+=u=t.get(s,e)-r[s],a+=u*u;e?o.push((a-n*n/i)/(i-1)):o.push((a-n*n/i)/i)}return o}(this,r,n);case"column":if(!Array.isArray(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,i=t.columns,o=[];for(let s=0;s<i;s++){let i=0,a=0,u=0;for(let e=0;e<n;e++)i+=u=t.get(e,s)-r[s],a+=u*u;e?o.push((a-i*i/n)/(n-1)):o.push((a-i*i/n)/n)}return o}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,i=t.columns,o=n*i;let s=0,a=0,u=0;for(let e=0;e<n;e++)for(let n=0;n<i;n++)s+=u=t.get(e,n)-r,a+=u*u;return e?(a-s*s/o)/(o-1):(a-s*s/o)/o}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Array.isArray(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!Array.isArray(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!Array.isArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!Array.isArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let i=0;i<t.rows;i++)r+=Math.pow(t.get(i,n),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}}function b(t,e){return t-e}y.prototype.klass="Matrix","undefined"!=typeof Symbol&&(y.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){const t=" ".repeat(2),e=" ".repeat(4);return`${this.constructor.name} {\n${t}[\n${e}${function(t,e){const{rows:r,columns:n}=t,i=Math.min(r,m),o=Math.min(n,g),s=[];for(let e=0;e<i;e++){let r=[];for(let n=0;n<o;n++)r.push(v(t.get(e,n)));s.push(`${r.join(" ")}`)}return o!==n&&(s[s.length-1]+=` ... ${n-g} more columns`),i!==r&&s.push(`... ${r-m} more rows`),s.join(`\n${e}`)}(this,e)}\n${t}]\n${t}rows: ${this.rows}\n${t}columns: ${this.columns}\n}`}),y.random=y.rand,y.randomInt=y.randInt,y.diagonal=y.diag,y.prototype.diagonal=y.prototype.diag,y.identity=y.eye,y.prototype.negate=y.prototype.neg,y.prototype.tensorProduct=y.prototype.kroneckerProduct;class x extends y{constructor(t,e){if(super(),x.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>0){if(this.data=[],!(Number.isInteger(e)&&e>0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if(t=r.length,"number"!=typeof(e=r[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");this.data.push(Float64Array.from(r[n]))}}}return this.rows=t,this.columns=e,this}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){if(o(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),o(this,t,!0),e=Float64Array.from(a(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){if(s(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),s(this,t,!0),e=u(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let i=0;for(;i<t;i++)n[i]=this.data[r][i];for(n[i++]=e[r];i<this.columns+1;i++)n[i]=this.data[r][i-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(y,x);class M extends y{constructor(t,e,r){super(),this.matrix=t,this.rows=e,this.columns=r}}class _ extends M{constructor(t,e,r){let n=h(t,e,r);super(t,n.row.length,n.column.length),this.rowIndices=n.row,this.columnIndices=n.column}set(t,e,r){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],r),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class S extends y{constructor(t,e={}){const{rows:r=1}=e;if(t.length%r!=0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=r,this.columns=t.length/r,this.data=t}set(t,e,r){let n=this._calculateIndex(t,e);return this.data[n]=r,this}get(t,e){let r=this._calculateIndex(t,e);return this.data[r]}_calculateIndex(t,e){return t*this.columns+e}}class E extends y{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}class k{constructor(t){let e,r,n,i,o,s,a,u,h,l=(t=E.checkMatrix(t)).clone(),f=l.rows,c=l.columns,p=new Float64Array(f),d=1;for(e=0;e<f;e++)p[e]=e;for(u=new Float64Array(f),r=0;r<c;r++){for(e=0;e<f;e++)u[e]=l.get(e,r);for(e=0;e<f;e++){for(h=Math.min(e,r),o=0,n=0;n<h;n++)o+=l.get(e,n)*u[n];u[e]-=o,l.set(e,r,u[e])}for(i=r,e=r+1;e<f;e++)Math.abs(u[e])>Math.abs(u[i])&&(i=e);if(i!==r){for(n=0;n<c;n++)s=l.get(i,n),l.set(i,n,l.get(r,n)),l.set(r,n,s);a=p[i],p[i]=p[r],p[r]=a,d=-d}if(r<f&&0!==l.get(r,r))for(e=r+1;e<f;e++)l.set(e,r,l.get(e,r)/l.get(r,r))}this.LU=l,this.pivotVector=p,this.pivotSign=d}isSingular(){let t=this.LU,e=t.columns;for(let r=0;r<e;r++)if(0===t.get(r,r))return!0;return!1}solve(t){t=x.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let r,n,i,o=t.columns,s=t.subMatrixRow(this.pivotVector,0,o-1),a=e.columns;for(i=0;i<a;i++)for(r=i+1;r<a;r++)for(n=0;n<o;n++)s.set(r,n,s.get(r,n)-s.get(i,n)*e.get(r,i));for(i=a-1;i>=0;i--){for(n=0;n<o;n++)s.set(i,n,s.get(i,n)/e.get(i,i));for(r=0;r<i;r++)for(n=0;n<o;n++)s.set(r,n,s.get(r,n)-s.get(i,n)*e.get(r,i))}return s}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,r=t.columns;for(let n=0;n<r;n++)e*=t.get(n,n);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new x(e,r);for(let i=0;i<e;i++)for(let e=0;e<r;e++)i>e?n.set(i,e,t.get(i,e)):i===e?n.set(i,e,1):n.set(i,e,0);return n}get upperTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new x(e,r);for(let i=0;i<e;i++)for(let e=0;e<r;e++)i<=e?n.set(i,e,t.get(i,e)):n.set(i,e,0);return n}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function j(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class O{constructor(t){let e,r,n,i,o=(t=E.checkMatrix(t)).clone(),s=t.rows,a=t.columns,u=new Float64Array(a);for(n=0;n<a;n++){let t=0;for(e=n;e<s;e++)t=j(t,o.get(e,n));if(0!==t){for(o.get(n,n)<0&&(t=-t),e=n;e<s;e++)o.set(e,n,o.get(e,n)/t);for(o.set(n,n,o.get(n,n)+1),r=n+1;r<a;r++){for(i=0,e=n;e<s;e++)i+=o.get(e,n)*o.get(e,r);for(i=-i/o.get(n,n),e=n;e<s;e++)o.set(e,r,o.get(e,r)+i*o.get(e,n))}}u[n]=-t}this.QR=o,this.Rdiag=u}solve(t){t=x.checkMatrix(t);let e=this.QR,r=e.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let n,i,o,s,a=t.columns,u=t.clone(),h=e.columns;for(o=0;o<h;o++)for(i=0;i<a;i++){for(s=0,n=o;n<r;n++)s+=e.get(n,o)*u.get(n,i);for(s=-s/e.get(o,o),n=o;n<r;n++)u.set(n,i,u.get(n,i)+s*e.get(n,o))}for(o=h-1;o>=0;o--){for(i=0;i<a;i++)u.set(o,i,u.get(o,i)/this.Rdiag[o]);for(n=0;n<o;n++)for(i=0;i<a;i++)u.set(n,i,u.get(n,i)-u.get(o,i)*e.get(n,o))}return u.subMatrix(0,h-1,0,a-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,r=this.QR,n=r.columns,i=new x(n,n);for(t=0;t<n;t++)for(e=0;e<n;e++)t<e?i.set(t,e,r.get(t,e)):t===e?i.set(t,e,this.Rdiag[t]):i.set(t,e,0);return i}get orthogonalMatrix(){let t,e,r,n,i=this.QR,o=i.rows,s=i.columns,a=new x(o,s);for(r=s-1;r>=0;r--){for(t=0;t<o;t++)a.set(t,r,0);for(a.set(r,r,1),e=r;e<s;e++)if(0!==i.get(r,r)){for(n=0,t=r;t<o;t++)n+=i.get(t,r)*a.get(t,e);for(n=-n/i.get(r,r),t=r;t<o;t++)a.set(t,e,a.get(t,e)+n*i.get(t,r))}}return a}}class A{constructor(t,e={}){let r=(t=E.checkMatrix(t)).rows,n=t.columns;const{computeLeftSingularVectors:i=!0,computeRightSingularVectors:o=!0,autoTranspose:s=!1}=e;let a,u=Boolean(i),h=Boolean(o),l=!1;if(r<n)if(s){r=(a=t.transpose()).rows,n=a.columns,l=!0;let e=u;u=h,h=e}else a=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=t.clone();let f=Math.min(r,n),c=Math.min(r+1,n),p=new Float64Array(c),d=new x(r,f),m=new x(n,n),g=new Float64Array(n),w=new Float64Array(r),v=new Float64Array(c);for(let t=0;t<c;t++)v[t]=t;let y=Math.min(r-1,n),b=Math.max(0,Math.min(n-2,r)),M=Math.max(y,b);for(let t=0;t<M;t++){if(t<y){p[t]=0;for(let e=t;e<r;e++)p[t]=j(p[t],a.get(e,t));if(0!==p[t]){a.get(t,t)<0&&(p[t]=-p[t]);for(let e=t;e<r;e++)a.set(e,t,a.get(e,t)/p[t]);a.set(t,t,a.get(t,t)+1)}p[t]=-p[t]}for(let e=t+1;e<n;e++){if(t<y&&0!==p[t]){let n=0;for(let i=t;i<r;i++)n+=a.get(i,t)*a.get(i,e);n=-n/a.get(t,t);for(let i=t;i<r;i++)a.set(i,e,a.get(i,e)+n*a.get(i,t))}g[e]=a.get(t,e)}if(u&&t<y)for(let e=t;e<r;e++)d.set(e,t,a.get(e,t));if(t<b){g[t]=0;for(let e=t+1;e<n;e++)g[t]=j(g[t],g[e]);if(0!==g[t]){g[t+1]<0&&(g[t]=0-g[t]);for(let e=t+1;e<n;e++)g[e]/=g[t];g[t+1]+=1}if(g[t]=-g[t],t+1<r&&0!==g[t]){for(let e=t+1;e<r;e++)w[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)w[e]+=g[r]*a.get(e,r);for(let e=t+1;e<n;e++){let n=-g[e]/g[t+1];for(let i=t+1;i<r;i++)a.set(i,e,a.get(i,e)+n*w[i])}}if(h)for(let e=t+1;e<n;e++)m.set(e,t,g[e])}}let _=Math.min(n,r+1);if(y<n&&(p[y]=a.get(y,y)),r<_&&(p[_-1]=0),b+1<_&&(g[b]=a.get(b,_-1)),g[_-1]=0,u){for(let t=y;t<f;t++){for(let e=0;e<r;e++)d.set(e,t,0);d.set(t,t,1)}for(let t=y-1;t>=0;t--)if(0!==p[t]){for(let e=t+1;e<f;e++){let n=0;for(let i=t;i<r;i++)n+=d.get(i,t)*d.get(i,e);n=-n/d.get(t,t);for(let i=t;i<r;i++)d.set(i,e,d.get(i,e)+n*d.get(i,t))}for(let e=t;e<r;e++)d.set(e,t,-d.get(e,t));d.set(t,t,1+d.get(t,t));for(let e=0;e<t-1;e++)d.set(e,t,0)}else{for(let e=0;e<r;e++)d.set(e,t,0);d.set(t,t,1)}}if(h)for(let t=n-1;t>=0;t--){if(t<b&&0!==g[t])for(let e=t+1;e<n;e++){let r=0;for(let i=t+1;i<n;i++)r+=m.get(i,t)*m.get(i,e);r=-r/m.get(t+1,t);for(let i=t+1;i<n;i++)m.set(i,e,m.get(i,e)+r*m.get(i,t))}for(let e=0;e<n;e++)m.set(e,t,0);m.set(t,t,1)}let S=_-1,k=Number.EPSILON;for(;_>0;){let t,e;for(t=_-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+k*Math.abs(p[t]+Math.abs(p[t+1]));if(Math.abs(g[t])<=e||Number.isNaN(g[t])){g[t]=0;break}}if(t===_-2)e=4;else{let r;for(r=_-1;r>=t&&r!==t;r--){let e=(r!==_?Math.abs(g[r]):0)+(r!==t+1?Math.abs(g[r-1]):0);if(Math.abs(p[r])<=k*e){p[r]=0;break}}r===t?e=3:r===_-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=g[_-2];g[_-2]=0;for(let r=_-2;r>=t;r--){let i=j(p[r],e),o=p[r]/i,s=e/i;if(p[r]=i,r!==t&&(e=-s*g[r-1],g[r-1]=o*g[r-1]),h)for(let t=0;t<n;t++)i=o*m.get(t,r)+s*m.get(t,_-1),m.set(t,_-1,-s*m.get(t,r)+o*m.get(t,_-1)),m.set(t,r,i)}break}case 2:{let e=g[t-1];g[t-1]=0;for(let n=t;n<_;n++){let i=j(p[n],e),o=p[n]/i,s=e/i;if(p[n]=i,e=-s*g[n],g[n]=o*g[n],u)for(let e=0;e<r;e++)i=o*d.get(e,n)+s*d.get(e,t-1),d.set(e,t-1,-s*d.get(e,n)+o*d.get(e,t-1)),d.set(e,n,i)}break}case 3:{const e=Math.max(Math.abs(p[_-1]),Math.abs(p[_-2]),Math.abs(g[_-2]),Math.abs(p[t]),Math.abs(g[t])),i=p[_-1]/e,o=p[_-2]/e,s=g[_-2]/e,a=p[t]/e,l=g[t]/e,f=((o+i)*(o-i)+s*s)/2,c=i*s*(i*s);let w=0;0===f&&0===c||(w=c/(f+(w=f<0?0-Math.sqrt(f*f+c):Math.sqrt(f*f+c))));let v=(a+i)*(a-i)+w,y=a*l;for(let e=t;e<_-1;e++){let i=j(v,y);0===i&&(i=Number.MIN_VALUE);let o=v/i,s=y/i;if(e!==t&&(g[e-1]=i),v=o*p[e]+s*g[e],g[e]=o*g[e]-s*p[e],y=s*p[e+1],p[e+1]=o*p[e+1],h)for(let t=0;t<n;t++)i=o*m.get(t,e)+s*m.get(t,e+1),m.set(t,e+1,-s*m.get(t,e)+o*m.get(t,e+1)),m.set(t,e,i);if(0===(i=j(v,y))&&(i=Number.MIN_VALUE),o=v/i,s=y/i,p[e]=i,v=o*g[e]+s*p[e+1],p[e+1]=-s*g[e]+o*p[e+1],y=s*g[e+1],g[e+1]=o*g[e+1],u&&e<r-1)for(let t=0;t<r;t++)i=o*d.get(t,e)+s*d.get(t,e+1),d.set(t,e+1,-s*d.get(t,e)+o*d.get(t,e+1)),d.set(t,e,i)}g[_-2]=v;break}case 4:if(p[t]<=0&&(p[t]=p[t]<0?-p[t]:0,h))for(let e=0;e<=S;e++)m.set(e,t,-m.get(e,t));for(;t<S&&!(p[t]>=p[t+1]);){let e=p[t];if(p[t]=p[t+1],p[t+1]=e,h&&t<n-1)for(let r=0;r<n;r++)e=m.get(r,t+1),m.set(r,t+1,m.get(r,t)),m.set(r,t,e);if(u&&t<r-1)for(let n=0;n<r;n++)e=d.get(n,t+1),d.set(n,t+1,d.get(n,t)),d.set(n,t,e);t++}_--}}if(l){let t=m;m=d,d=t}this.m=r,this.n=n,this.s=p,this.U=d,this.V=m}solve(t){let e=t,r=this.threshold,n=this.s.length,i=x.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?i.set(t,t,0):i.set(t,t,1/this.s[t]);let o=this.U,s=this.rightSingularVectors,a=s.mmul(i),u=s.rows,h=o.rows,l=x.zeros(u,h);for(let t=0;t<u;t++)for(let e=0;e<h;e++){let r=0;for(let i=0;i<n;i++)r+=a.get(t,i)*o.get(e,i);l.set(t,e,r)}return l.mmul(e)}solveForDiagonal(t){return this.solve(x.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,i=new x(r,this.s.length);for(let o=0;o<r;o++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&i.set(o,r,t.get(o,r)/this.s[r]);let o=this.U,s=o.rows,a=o.columns,u=new x(r,s);for(let t=0;t<r;t++)for(let e=0;e<s;e++){let r=0;for(let n=0;n<a;n++)r+=i.get(t,n)*o.get(e,n);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,i=r.length;n<i;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return x.diag(this.s)}}function R(t,e,r=!1){return t=E.checkMatrix(t),e=E.checkMatrix(e),r?new A(t).solve(e):t.isSquare()?new k(t).solve(e):new O(t).solve(e)}function N(t,e){let r=[];for(let n=0;n<t;n++)n!==e&&r.push(n);return r}function T(t,e,r,n=1e-9,i=1e-9){if(t>i)return new Array(e.rows+1).fill(0);{let t=e.addRow(r,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<n&&t.set(e,0,0);return t.to1DArray()}}class I{constructor(t,e={}){const{assumeSymmetric:r=!1}=e;if(!(t=E.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");let n,i,o=t.columns,s=new x(o,o),a=new Float64Array(o),u=new Float64Array(o),h=t,l=!1;if(l=!!r||t.isSymmetric()){for(n=0;n<o;n++)for(i=0;i<o;i++)s.set(n,i,h.get(n,i));!function(t,e,r,n){let i,o,s,a,u,h,l,f;for(u=0;u<t;u++)r[u]=n.get(t-1,u);for(a=t-1;a>0;a--){for(f=0,s=0,h=0;h<a;h++)f+=Math.abs(r[h]);if(0===f)for(e[a]=r[a-1],u=0;u<a;u++)r[u]=n.get(a-1,u),n.set(a,u,0),n.set(u,a,0);else{for(h=0;h<a;h++)r[h]/=f,s+=r[h]*r[h];for(i=r[a-1],o=Math.sqrt(s),i>0&&(o=-o),e[a]=f*o,s-=i*o,r[a-1]=i-o,u=0;u<a;u++)e[u]=0;for(u=0;u<a;u++){for(i=r[u],n.set(u,a,i),o=e[u]+n.get(u,u)*i,h=u+1;h<=a-1;h++)o+=n.get(h,u)*r[h],e[h]+=n.get(h,u)*i;e[u]=o}for(i=0,u=0;u<a;u++)e[u]/=s,i+=e[u]*r[u];for(l=i/(s+s),u=0;u<a;u++)e[u]-=l*r[u];for(u=0;u<a;u++){for(i=r[u],o=e[u],h=u;h<=a-1;h++)n.set(h,u,n.get(h,u)-(i*e[h]+o*r[h]));r[u]=n.get(a-1,u),n.set(a,u,0)}}r[a]=s}for(a=0;a<t-1;a++){if(n.set(t-1,a,n.get(a,a)),n.set(a,a,1),0!==(s=r[a+1])){for(h=0;h<=a;h++)r[h]=n.get(h,a+1)/s;for(u=0;u<=a;u++){for(o=0,h=0;h<=a;h++)o+=n.get(h,a+1)*n.get(h,u);for(h=0;h<=a;h++)n.set(h,u,n.get(h,u)-o*r[h])}}for(h=0;h<=a;h++)n.set(h,a+1,0)}for(u=0;u<t;u++)r[u]=n.get(t-1,u),n.set(t-1,u,0);n.set(t-1,t-1,1),e[0]=0}(o,u,a,s),function(t,e,r,n){let i,o,s,a,u,h,l,f,c,p,d,m,g,w,v,y;for(s=1;s<t;s++)e[s-1]=e[s];e[t-1]=0;let b=0,x=0,M=Number.EPSILON;for(h=0;h<t;h++){for(x=Math.max(x,Math.abs(r[h])+Math.abs(e[h])),l=h;l<t&&!(Math.abs(e[l])<=M*x);)l++;if(l>h)do{for(i=r[h],f=(r[h+1]-i)/(2*e[h]),c=j(f,1),f<0&&(c=-c),r[h]=e[h]/(f+c),r[h+1]=e[h]*(f+c),p=r[h+1],o=i-r[h],s=h+2;s<t;s++)r[s]-=o;for(b+=o,f=r[l],m=d=1,g=d,w=e[h+1],v=0,y=0,s=l-1;s>=h;s--)for(g=m,m=d,y=v,i=d*e[s],o=d*f,c=j(f,e[s]),e[s+1]=v*c,v=e[s]/c,f=(d=f/c)*r[s]-v*i,r[s+1]=o+v*(d*i+v*r[s]),u=0;u<t;u++)o=n.get(u,s+1),n.set(u,s+1,v*n.get(u,s)+d*o),n.set(u,s,d*n.get(u,s)-v*o);f=-v*y*g*w*e[h]/p,e[h]=v*f,r[h]=d*f}while(Math.abs(e[h])>M*x);r[h]=r[h]+b,e[h]=0}for(s=0;s<t-1;s++){for(u=s,f=r[s],a=s+1;a<t;a++)r[a]<f&&(u=a,f=r[a]);if(u!==s)for(r[u]=r[s],r[s]=f,a=0;a<t;a++)f=n.get(a,s),n.set(a,s,n.get(a,u)),n.set(a,u,f)}}(o,u,a,s)}else{let t=new x(o,o),e=new Float64Array(o);for(i=0;i<o;i++)for(n=0;n<o;n++)t.set(n,i,h.get(n,i));!function(t,e,r,n){let i,o,s,a,u,h,l,f=t-1;for(h=1;h<=f-1;h++){for(l=0,a=h;a<=f;a++)l+=Math.abs(e.get(a,h-1));if(0!==l){for(s=0,a=f;a>=h;a--)r[a]=e.get(a,h-1)/l,s+=r[a]*r[a];for(o=Math.sqrt(s),r[h]>0&&(o=-o),s-=r[h]*o,r[h]=r[h]-o,u=h;u<t;u++){for(i=0,a=f;a>=h;a--)i+=r[a]*e.get(a,u);for(i/=s,a=h;a<=f;a++)e.set(a,u,e.get(a,u)-i*r[a])}for(a=0;a<=f;a++){for(i=0,u=f;u>=h;u--)i+=r[u]*e.get(a,u);for(i/=s,u=h;u<=f;u++)e.set(a,u,e.get(a,u)-i*r[u])}r[h]=l*r[h],e.set(h,h-1,l*o)}}for(a=0;a<t;a++)for(u=0;u<t;u++)n.set(a,u,a===u?1:0);for(h=f-1;h>=1;h--)if(0!==e.get(h,h-1)){for(a=h+1;a<=f;a++)r[a]=e.get(a,h-1);for(u=h;u<=f;u++){for(o=0,a=h;a<=f;a++)o+=r[a]*n.get(a,u);for(o=o/r[h]/e.get(h,h-1),a=h;a<=f;a++)n.set(a,u,n.get(a,u)+o*r[a])}}}(o,t,e,s),function(t,e,r,n,i){let o,s,a,u,h,l,f,c,p,d,m,g,w,v,y,b=t-1,x=t-1,M=Number.EPSILON,_=0,S=0,E=0,k=0,j=0,O=0,A=0,R=0;for(o=0;o<t;o++)for((o<0||o>x)&&(r[o]=i.get(o,o),e[o]=0),s=Math.max(o-1,0);s<t;s++)S+=Math.abs(i.get(o,s));for(;b>=0;){for(u=b;u>0&&(0===(O=Math.abs(i.get(u-1,u-1))+Math.abs(i.get(u,u)))&&(O=S),!(Math.abs(i.get(u,u-1))<M*O));)u--;if(u===b)i.set(b,b,i.get(b,b)+_),r[b]=i.get(b,b),e[b]=0,b--,R=0;else if(u===b-1){if(f=i.get(b,b-1)*i.get(b-1,b),E=(i.get(b-1,b-1)-i.get(b,b))/2,k=E*E+f,A=Math.sqrt(Math.abs(k)),i.set(b,b,i.get(b,b)+_),i.set(b-1,b-1,i.get(b-1,b-1)+_),c=i.get(b,b),k>=0){for(A=E>=0?E+A:E-A,r[b-1]=c+A,r[b]=r[b-1],0!==A&&(r[b]=c-f/A),e[b-1]=0,e[b]=0,c=i.get(b,b-1),O=Math.abs(c)+Math.abs(A),E=c/O,k=A/O,j=Math.sqrt(E*E+k*k),E/=j,k/=j,s=b-1;s<t;s++)A=i.get(b-1,s),i.set(b-1,s,k*A+E*i.get(b,s)),i.set(b,s,k*i.get(b,s)-E*A);for(o=0;o<=b;o++)A=i.get(o,b-1),i.set(o,b-1,k*A+E*i.get(o,b)),i.set(o,b,k*i.get(o,b)-E*A);for(o=0;o<=x;o++)A=n.get(o,b-1),n.set(o,b-1,k*A+E*n.get(o,b)),n.set(o,b,k*n.get(o,b)-E*A)}else r[b-1]=c+E,r[b]=c+E,e[b-1]=A,e[b]=-A;b-=2,R=0}else{if(c=i.get(b,b),p=0,f=0,u<b&&(p=i.get(b-1,b-1),f=i.get(b,b-1)*i.get(b-1,b)),10===R){for(_+=c,o=0;o<=b;o++)i.set(o,o,i.get(o,o)-c);O=Math.abs(i.get(b,b-1))+Math.abs(i.get(b-1,b-2)),c=p=.75*O,f=-.4375*O*O}if(30===R&&(O=(O=(p-c)/2)*O+f)>0){for(O=Math.sqrt(O),p<c&&(O=-O),O=c-f/((p-c)/2+O),o=0;o<=b;o++)i.set(o,o,i.get(o,o)-O);_+=O,c=p=f=.964}for(R+=1,h=b-2;h>=u&&(A=i.get(h,h),E=((j=c-A)*(O=p-A)-f)/i.get(h+1,h)+i.get(h,h+1),k=i.get(h+1,h+1)-A-j-O,j=i.get(h+2,h+1),O=Math.abs(E)+Math.abs(k)+Math.abs(j),E/=O,k/=O,j/=O,h!==u)&&!(Math.abs(i.get(h,h-1))*(Math.abs(k)+Math.abs(j))<M*(Math.abs(E)*(Math.abs(i.get(h-1,h-1))+Math.abs(A)+Math.abs(i.get(h+1,h+1)))));)h--;for(o=h+2;o<=b;o++)i.set(o,o-2,0),o>h+2&&i.set(o,o-3,0);for(a=h;a<=b-1&&(v=a!==b-1,a!==h&&(E=i.get(a,a-1),k=i.get(a+1,a-1),j=v?i.get(a+2,a-1):0,0!==(c=Math.abs(E)+Math.abs(k)+Math.abs(j))&&(E/=c,k/=c,j/=c)),0!==c);a++)if(O=Math.sqrt(E*E+k*k+j*j),E<0&&(O=-O),0!==O){for(a!==h?i.set(a,a-1,-O*c):u!==h&&i.set(a,a-1,-i.get(a,a-1)),c=(E+=O)/O,p=k/O,A=j/O,k/=E,j/=E,s=a;s<t;s++)E=i.get(a,s)+k*i.get(a+1,s),v&&(E+=j*i.get(a+2,s),i.set(a+2,s,i.get(a+2,s)-E*A)),i.set(a,s,i.get(a,s)-E*c),i.set(a+1,s,i.get(a+1,s)-E*p);for(o=0;o<=Math.min(b,a+3);o++)E=c*i.get(o,a)+p*i.get(o,a+1),v&&(E+=A*i.get(o,a+2),i.set(o,a+2,i.get(o,a+2)-E*j)),i.set(o,a,i.get(o,a)-E),i.set(o,a+1,i.get(o,a+1)-E*k);for(o=0;o<=x;o++)E=c*n.get(o,a)+p*n.get(o,a+1),v&&(E+=A*n.get(o,a+2),n.set(o,a+2,n.get(o,a+2)-E*j)),n.set(o,a,n.get(o,a)-E),n.set(o,a+1,n.get(o,a+1)-E*k)}}}if(0===S)return;for(b=t-1;b>=0;b--)if(E=r[b],0===(k=e[b]))for(u=b,i.set(b,b,1),o=b-1;o>=0;o--){for(f=i.get(o,o)-E,j=0,s=u;s<=b;s++)j+=i.get(o,s)*i.get(s,b);if(e[o]<0)A=f,O=j;else if(u=o,0===e[o]?i.set(o,b,0!==f?-j/f:-j/(M*S)):(c=i.get(o,o+1),p=i.get(o+1,o),k=(r[o]-E)*(r[o]-E)+e[o]*e[o],l=(c*O-A*j)/k,i.set(o,b,l),i.set(o+1,b,Math.abs(c)>Math.abs(A)?(-j-f*l)/c:(-O-p*l)/A)),l=Math.abs(i.get(o,b)),M*l*l>1)for(s=o;s<=b;s++)i.set(s,b,i.get(s,b)/l)}else if(k<0)for(u=b-1,Math.abs(i.get(b,b-1))>Math.abs(i.get(b-1,b))?(i.set(b-1,b-1,k/i.get(b,b-1)),i.set(b-1,b,-(i.get(b,b)-E)/i.get(b,b-1))):(y=C(0,-i.get(b-1,b),i.get(b-1,b-1)-E,k),i.set(b-1,b-1,y[0]),i.set(b-1,b,y[1])),i.set(b,b-1,0),i.set(b,b,1),o=b-2;o>=0;o--){for(d=0,m=0,s=u;s<=b;s++)d+=i.get(o,s)*i.get(s,b-1),m+=i.get(o,s)*i.get(s,b);if(f=i.get(o,o)-E,e[o]<0)A=f,j=d,O=m;else if(u=o,0===e[o]?(y=C(-d,-m,f,k),i.set(o,b-1,y[0]),i.set(o,b,y[1])):(c=i.get(o,o+1),p=i.get(o+1,o),g=(r[o]-E)*(r[o]-E)+e[o]*e[o]-k*k,w=2*(r[o]-E)*k,0===g&&0===w&&(g=M*S*(Math.abs(f)+Math.abs(k)+Math.abs(c)+Math.abs(p)+Math.abs(A))),y=C(c*j-A*d+k*m,c*O-A*m-k*d,g,w),i.set(o,b-1,y[0]),i.set(o,b,y[1]),Math.abs(c)>Math.abs(A)+Math.abs(k)?(i.set(o+1,b-1,(-d-f*i.get(o,b-1)+k*i.get(o,b))/c),i.set(o+1,b,(-m-f*i.get(o,b)-k*i.get(o,b-1))/c)):(y=C(-j-p*i.get(o,b-1),-O-p*i.get(o,b),A,k),i.set(o+1,b-1,y[0]),i.set(o+1,b,y[1]))),l=Math.max(Math.abs(i.get(o,b-1)),Math.abs(i.get(o,b))),M*l*l>1)for(s=o;s<=b;s++)i.set(s,b-1,i.get(s,b-1)/l),i.set(s,b,i.get(s,b)/l)}for(o=0;o<t;o++)if(o<0||o>x)for(s=o;s<t;s++)n.set(o,s,i.get(o,s));for(s=t-1;s>=0;s--)for(o=0;o<=x;o++){for(A=0,a=0;a<=Math.min(s,x);a++)A+=n.get(o,a)*i.get(a,s);n.set(o,s,A)}}(o,u,a,s,t)}this.n=o,this.e=u,this.d=a,this.V=s}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,r=this.n,n=this.e,i=this.d,o=new x(r,r);for(t=0;t<r;t++){for(e=0;e<r;e++)o.set(t,e,0);o.set(t,t,i[t]),n[t]>0?o.set(t,t+1,n[t]):n[t]<0&&o.set(t,t-1,n[t])}return o}}function C(t,e,r,n){let i,o;return Math.abs(r)>Math.abs(n)?[(t+(i=n/r)*e)/(o=r+i*n),(e-i*t)/o]:[((i=r/n)*t+e)/(o=n+i*r),(i*e-t)/o]}class z{constructor(t){if(!(t=E.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");let e,r,n,i=t,o=i.rows,s=new x(o,o),a=!0;for(r=0;r<o;r++){let t=0;for(n=0;n<r;n++){let o=0;for(e=0;e<n;e++)o+=s.get(n,e)*s.get(r,e);o=(i.get(r,n)-o)/s.get(n,n),s.set(r,n,o),t+=o*o}for(a&=(t=i.get(r,r)-t)>0,s.set(r,r,Math.sqrt(Math.max(t,0))),n=r+1;n<o;n++)s.set(r,n,0)}this.L=s,this.positiveDefinite=Boolean(a)}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=E.checkMatrix(t);let e=this.L,r=e.rows;if(t.rows!==r)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let n,i,o,s=t.columns,a=t.clone();for(o=0;o<r;o++)for(i=0;i<s;i++){for(n=0;n<o;n++)a.set(o,i,a.get(o,i)-a.get(n,i)*e.get(o,n));a.set(o,i,a.get(o,i)/e.get(o,o))}for(o=r-1;o>=0;o--)for(i=0;i<s;i++){for(n=o+1;n<r;n++)a.set(o,i,a.get(o,i)-a.get(n,i)*e.get(n,o));a.set(o,i,a.get(o,i)/e.get(o,o))}return a}get lowerTriangularMatrix(){return this.L}}class D{constructor(t,e={}){t=E.checkMatrix(t);let{Y:r}=e;const{scaleScores:n=!1,maxIterations:i=1e3,terminationCriteria:o=1e-10}=e;let s;if(r){if(!(r=Array.isArray(r)&&"number"==typeof r[0]?x.columnVector(r):E.checkMatrix(r)).isColumnVector()||r.rows!==t.rows)throw new Error("Y must be a column vector of length X.rows");s=r}else s=t.getColumnVector(0);let a,u,h,l,f=1;for(let e=0;e<i&&f>o;e++)h=(h=t.transpose().mmul(s).div(s.transpose().mmul(s).get(0,0))).div(h.norm()),a=t.mmul(h).div(h.transpose().mmul(h).get(0,0)),e>0&&(f=a.clone().sub(l).pow(2).sum()),l=a.clone(),r?(u=(u=r.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0))).div(u.norm()),s=r.mmul(u).div(u.transpose().mmul(u).get(0,0))):s=a;if(r){let e=t.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0));e=e.div(e.norm());let n=t.clone().sub(a.clone().mmul(e.transpose())),i=s.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0)),o=r.clone().sub(a.clone().mulS(i.get(0,0)).mmul(u.transpose()));this.t=a,this.p=e.transpose(),this.w=h.transpose(),this.q=u,this.u=s,this.s=a.transpose().mmul(a),this.xResidual=n,this.yResidual=o,this.betas=i}else this.w=h.transpose(),this.s=a.transpose().mmul(a).sqrt(),this.t=n?a.clone().div(this.s.get(0,0)):a,this.xResidual=t.sub(a.mmul(h.transpose()))}}r.AbstractMatrix=y,r.CHO=z,r.CholeskyDecomposition=z,r.EVD=I,r.EigenvalueDecomposition=I,r.LU=k,r.LuDecomposition=k,r.Matrix=x,r.MatrixColumnSelectionView=class extends M{constructor(t,e){e=f(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,r){return this.matrix.set(t,this.columnIndices[e],r),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}},r.MatrixColumnView=class extends M{constructor(t,e){s(t,e),super(t,t.rows,1),this.column=e}set(t,e,r){return this.matrix.set(t,this.column,r),this}get(t){return this.matrix.get(t,this.column)}},r.MatrixFlipColumnView=class extends M{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(t,this.columns-e-1,r),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}},r.MatrixFlipRowView=class extends M{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(this.rows-t-1,e,r),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}},r.MatrixRowSelectionView=class extends M{constructor(t,e){super(t,(e=l(t,e)).length,t.columns),this.rowIndices=e}set(t,e,r){return this.matrix.set(this.rowIndices[t],e,r),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}},r.MatrixRowView=class extends M{constructor(t,e){o(t,e),super(t,1,t.columns),this.row=e}set(t,e,r){return this.matrix.set(this.row,e,r),this}get(t,e){return this.matrix.get(this.row,e)}},r.MatrixSelectionView=_,r.MatrixSubView=class extends M{constructor(t,e,r,n,i){c(t,e,r,n,i),super(t,r-e+1,i-n+1),this.startRow=e,this.startColumn=n}set(t,e,r){return this.matrix.set(this.startRow+t,this.startColumn+e,r),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}},r.MatrixTransposeView=class extends M{constructor(t){super(t,t.columns,t.rows)}set(t,e,r){return this.matrix.set(e,t,r),this}get(t,e){return this.matrix.get(e,t)}},r.NIPALS=D,r.Nipals=D,r.QR=O,r.QrDecomposition=O,r.SVD=A,r.SingularValueDecomposition=A,r.WrapperMatrix1D=S,r.WrapperMatrix2D=E,r.correlation=function(t,e=t,r={}){t=x.checkMatrix(t);let n=!1;if("object"!=typeof e||x.isMatrix(e)||Array.isArray(e)?e=x.checkMatrix(e):(r=e,e=t,n=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:i=!0,scale:o=!0}=r;i&&(t.center("column"),n||e.center("column")),o&&(t.scale("column"),n||e.scale("column"));const s=t.standardDeviation("column",{unbiased:!0}),a=n?s:e.standardDeviation("column",{unbiased:!0}),u=t.transpose().mmul(e);for(let e=0;e<u.rows;e++)for(let r=0;r<u.columns;r++)u.set(e,r,u.get(e,r)*(1/(s[e]*a[r]))*(1/(t.rows-1)));return u},r.covariance=function(t,e=t,r={}){t=x.checkMatrix(t);let n=!1;if("object"!=typeof e||x.isMatrix(e)||Array.isArray(e)?e=x.checkMatrix(e):(r=e,e=t,n=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:i=!0}=r;i&&(t=t.center("column"),n||(e=e.center("column")));const o=t.transpose().mmul(e);for(let e=0;e<o.rows;e++)for(let r=0;r<o.columns;r++)o.set(e,r,o.get(e,r)*(1/(t.rows-1)));return o},r.default=x,r.determinant=function t(e){if((e=x.checkMatrix(e)).isSquare()){let r,n,i,o;if(2===e.columns)return r=e.get(0,0),n=e.get(0,1),i=e.get(1,0),r*(o=e.get(1,1))-n*i;if(3===e.columns){let o,s,a;return o=new _(e,[1,2],[1,2]),s=new _(e,[1,2],[0,2]),a=new _(e,[1,2],[0,1]),r=e.get(0,0),n=e.get(0,1),i=e.get(0,2),r*t(o)-n*t(s)+i*t(a)}return new k(e).determinant}throw Error("determinant can only be calculated for a square matrix")},r.inverse=function(t,e=!1){return t=E.checkMatrix(t),e?new A(t).inverse():R(t,x.eye(t.rows))},r.linearDependencies=function(t,e={}){const{thresholdValue:r=1e-9,thresholdError:n=1e-9}=e;let i=(t=x.checkMatrix(t)).rows,o=new x(i,i);for(let e=0;e<i;e++){let s=x.columnVector(t.getRow(e)),a=t.subMatrixRow(N(i,e)).transpose(),u=new A(a).solve(s),h=x.sub(s,a.mmul(u)).abs().max();o.setRow(e,T(h,u,e,r,n))}return o},r.pseudoInverse=function(t,e=Number.EPSILON){t=x.checkMatrix(t);let r=new A(t,{autoTranspose:!0}),n=r.leftSingularVectors,i=r.rightSingularVectors,o=r.diagonal;for(let t=0;t<o.length;t++)Math.abs(o[t])>e?o[t]=1/o[t]:o[t]=0;return i.mmul(x.diag(o).mmul(n.transpose()))},r.solve=R,r.wrap=function(t,e){if(Array.isArray(t))return t[0]&&Array.isArray(t[0])?new E(t):new S(t,e);throw new Error("the argument is not an array")}},{"ml-array-rescale":44}],48:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("ml-matrix");class i{constructor(t,e={}){if(!0===t){const t=e;return this.center=t.center,this.scale=t.scale,this.means=t.means,this.stdevs=t.stdevs,this.U=n.Matrix.checkMatrix(t.U),this.S=t.S,this.R=t.R,void(this.excludedFeatures=t.excludedFeatures||[])}t=new n.Matrix(t);const{isCovarianceMatrix:r=!1,method:i="SVD",nCompNIPALS:o=2,center:s=!0,scale:a=!1,ignoreZeroVariance:u=!1}=e;if(this.center=s,this.scale=a,this.means=null,this.stdevs=null,this.excludedFeatures=[],r)this._computeFromCovarianceMatrix(t);else switch(this._adjust(t,u),i){case"covarianceMatrix":{const e=new n.MatrixTransposeView(t).mmul(t).div(t.rows-1);this._computeFromCovarianceMatrix(e);break}case"NIPALS":this._computeWithNIPALS(t,o);break;case"SVD":{const e=new n.SVD(t,{computeLeftSingularVectors:!1,computeRightSingularVectors:!0,autoTranspose:!0});this.U=e.rightSingularVectors;const r=e.diagonal,i=[];for(const e of r)i.push(e*e/(t.rows-1));this.S=i;break}default:throw new Error(`unknown method: ${i}`)}}static load(t){if("string"!=typeof t.name)throw new TypeError("model must have a name property");if("PCA"!==t.name)throw new RangeError(`invalid model: ${t.name}`);return new i(!0,t)}predict(t,e={}){const{nComponents:r=this.U.columns}=e;if(t=new n.Matrix(t),this.center&&(t.subRowVector(this.means),this.scale)){for(let e of this.excludedFeatures)t.removeColumn(e);t.divRowVector(this.stdevs)}var i=t.mmul(this.U);return i.subMatrix(0,i.rows-1,0,r-1)}invert(t){var e=(t=n.Matrix.checkMatrix(t)).mmul(this.U.transpose());return this.center&&(this.scale&&e.mulRowVector(this.stdevs),e.addRowVector(this.means)),e}getExplainedVariance(){var t=0;for(const e of this.S)t+=e;return this.S.map(e=>e/t)}getCumulativeVariance(){for(var t=this.getExplainedVariance(),e=1;e<t.length;e++)t[e]+=t[e-1];return t}getEigenvectors(){return this.U}getEigenvalues(){return this.S}getStandardDeviations(){return this.S.map(t=>Math.sqrt(t))}getLoadings(){return this.U.transpose()}toJSON(){return{name:"PCA",center:this.center,scale:this.scale,means:this.means,stdevs:this.stdevs,U:this.U,S:this.S,excludedFeatures:this.excludedFeatures}}_adjust(t,e){if(this.center){const r=t.mean("column"),n=this.scale?t.standardDeviation("column",{mean:r}):null;if(this.means=r,t.subRowVector(r),this.scale){for(let r=0;r<n.length;r++)if(0===n[r]){if(!e)throw new RangeError(`Cannot scale the dataset (standard deviation is zero at index ${r}`);t.removeColumn(r),n.splice(r,1),this.excludedFeatures.push(r),r--}this.stdevs=n,t.divRowVector(n)}}}_computeFromCovarianceMatrix(t){const e=new n.EVD(t,{assumeSymmetric:!0});this.U=e.eigenvectorMatrix,this.U.flipRows(),this.S=e.realEigenvalues,this.S.reverse()}_computeWithNIPALS(t,e){this.U=new n.Matrix(e,t.columns),this.S=[];let r=t;for(let t=0;t<e;t++){let e=new n.NIPALS(r);this.U.setRow(t,e.w.transpose()),this.S.push(Math.pow(e.s.get(0,0),2)),r=e.xResidual}this.U=this.U.transpose()}}r.PCA=i},{"ml-matrix":47}],49:[function(require,module,exports){"use strict";var NodeSquare=require("./node-square"),NodeHexagonal=require("./node-hexagonal"),defaultOptions={fields:3,randomizer:Math.random,distance:squareEuclidean,iterations:10,learningRate:.1,gridType:"rect",torus:!0,method:"random"};function SOM(t,e,r,n){for(var i in this.x=t,this.y=e,r=r||{},this.options={},defaultOptions)r.hasOwnProperty(i)?this.options[i]=r[i]:this.options[i]=defaultOptions[i];if("number"==typeof this.options.fields)this.numWeights=this.options.fields;else{if(!Array.isArray(this.options.fields))throw new Error("Invalid fields definition");this.numWeights=this.options.fields.length;var o=getConverters(this.options.fields);this.extractor=o.extractor,this.creator=o.creator}if("rect"===this.options.gridType)this.nodeType=NodeSquare,this.gridDim={x:t,y:e};else{this.nodeType=NodeHexagonal;var s=this.x-Math.floor(this.y/2);this.gridDim={x:s,y:this.y,z:-(0-s-this.y)}}if(this.torus=this.options.torus,this.distanceMethod=this.torus?"getDistanceTorus":"getDistance",this.distance=this.options.distance,this.maxDistance=getMaxDistance(this.distance,this.numWeights),!0!==n){if(!(t>0&&e>0))throw new Error("x and y must be positive");this.times={findBMU:0,adjust:0},this.randomizer=this.options.randomizer,this.iterationCount=0,this.iterations=this.options.iterations,this.startLearningRate=this.learningRate=this.options.learningRate,this.mapRadius=Math.floor(Math.max(t,e)/2),this.algorithmMethod=this.options.method,this._initNodes(),this.done=!1}else this.done=!0}function getConverters(t){for(var e=t.length,r=new Array(e),n=new Array(e),i=0;i<e;i++)r[i]=getNormalizer(t[i].range),n[i]=getDenormalizer(t[i].range);return{extractor:function(n){for(var i=new Array(e),o=0;o<e;o++)i[o]=r[o](n[t[o].name]);return i},creator:function(r){for(var i={},o=0;o<e;o++)i[t[o].name]=n[o](r[o]);return i}}}function getNormalizer(t){return function(e){return(e-t[0])/(t[1]-t[0])}}function getDenormalizer(t){return function(e){return t[0]+e*(t[1]-t[0])}}function squareEuclidean(t,e){for(var r=0,n=0,i=t.length;n<i;n++)r+=(t[n]-e[n])*(t[n]-e[n]);return r}function getRandomValue(t,e){return t[Math.floor(e()*t.length)]}function getMaxDistance(t,e){for(var r=new Array(e),n=new Array(e),i=0;i<e;i++)r[i]=0,n[i]=1;return t(r,n)}SOM.load=function loadModel(model,distance){if("SOM"===model.name){var x=model.data.length,y=model.data[0].length;distance?model.options.distance=distance:model.options.distance&&(model.options.distance=eval("("+model.options.distance+")"));var som=new SOM(x,y,model.options,!0);som.nodes=new Array(x);for(var i=0;i<x;i++){som.nodes[i]=new Array(y);for(var j=0;j<y;j++)som.nodes[i][j]=new som.nodeType(i,j,model.data[i][j],som)}return som}throw new Error("expecting a SOM model")},SOM.prototype.export=function(t){if(!this.done)throw new Error("model is not ready yet");var e={name:"SOM"};e.options={fields:this.options.fields,gridType:this.options.gridType,torus:this.options.torus},e.data=new Array(this.x);for(var r=0;r<this.x;r++){e.data[r]=new Array(this.y);for(var n=0;n<this.y;n++)e.data[r][n]=this.nodes[r][n].weights}return t&&(e.options.distance=this.distance.toString()),e},SOM.prototype._initNodes=function(){var t,e,r,n=Date.now();for(this.nodes=new Array(this.x),t=0;t<this.x;t++)for(this.nodes[t]=new Array(this.y),e=0;e<this.y;e++){var i=new Array(this.numWeights);for(r=0;r<this.numWeights;r++)i[r]=this.randomizer();this.nodes[t][e]=new this.nodeType(t,e,i,this)}this.times.initNodes=Date.now()-n},SOM.prototype.setTraining=function(t){if(this.trainingSet)throw new Error("training set has already been set");var e,r=Date.now(),n=t,i=t.length;if(this.extractor)for(n=new Array(i),e=0;e<i;e++)n[e]=this.extractor(t[e]);this.numIterations=this.iterations*i,"random"===this.algorithmMethod?this.timeConstant=this.numIterations/Math.log(this.mapRadius):this.timeConstant=i/Math.log(this.mapRadius),this.trainingSet=n,this.times.setTraining=Date.now()-r},SOM.prototype.trainOne=function(){return!this.done&&(this.numIterations-- >0?("random"===this.algorithmMethod?(t=this.mapRadius*Math.exp(-this.iterationCount/this.timeConstant),e=getRandomValue(this.trainingSet,this.randomizer),this._adjust(e,t),this.learningRate=this.startLearningRate*Math.exp(-this.iterationCount/this.numIterations)):(r=-Math.floor(this.iterationCount/this.trainingSet.length),t=this.mapRadius*Math.exp(r/this.timeConstant),e=this.trainingSet[this.iterationCount%this.trainingSet.length],this._adjust(e,t),(this.iterationCount+1)%this.trainingSet.length==0&&(this.learningRate=this.startLearningRate*Math.exp(r/Math.floor(this.numIterations/this.trainingSet.length)))),this.iterationCount++,!0):(this.done=!0,!1));var t,e,r},SOM.prototype._adjust=function(t,e){var r,n,i,o,s=Date.now(),a=this._findBestMatchingUnit(t),u=Date.now();this.times.findBMU+=u-s;var h=Math.floor(e),l=a.x-h,f=a.x+h,c=a.y-h,p=a.y+h;for(r=l;r<=f;r++){var d=r;for(r<0?d+=this.x:r>=this.x&&(d-=this.x),n=c;n<=p;n++){var m=n;n<0?m+=this.y:n>=this.y&&(m-=this.y),(i=a[this.distanceMethod](this.nodes[d][m]))<e&&(o=Math.exp(-i/(2*e)),this.nodes[d][m].adjustWeights(t,this.learningRate,o))}}this.times.adjust+=Date.now()-u},SOM.prototype.train=function(t){if(!this.done)for(this.setTraining(t);this.trainOne(););},SOM.prototype.getConvertedNodes=function(){for(var t=new Array(this.x),e=0;e<this.x;e++){t[e]=new Array(this.y);for(var r=0;r<this.y;r++){var n=this.nodes[e][r];t[e][r]=this.creator?this.creator(n.weights):n.weights}}return t},SOM.prototype._findBestMatchingUnit=function(t){for(var e,r,n=1/0,i=0;i<this.x;i++)for(var o=0;o<this.y;o++)(r=this.distance(this.nodes[i][o].weights,t))<n&&(n=r,e=this.nodes[i][o]);return e},SOM.prototype.predict=function(t,e){if("boolean"==typeof t&&(e=t,t=null),t||(t=this.trainingSet),Array.isArray(t)&&(Array.isArray(t[0])||"object"==typeof t[0])){var r=this;return t.map(function(t){return r._predict(t,e)})}return this._predict(t,e)},SOM.prototype._predict=function(t,e){Array.isArray(t)||(t=this.extractor(t));var r=this._findBestMatchingUnit(t),n=[r.x,r.y];return e&&(n[2]=r.getPosition(t)),n},SOM.prototype.getQuantizationError=function(){for(var t=this.getFit(),e=t.length,r=0,n=0;n<e;n++)r+=t[n];return r/e},SOM.prototype.getFit=function(t){t||(t=this.trainingSet);for(var e,r=t.length,n=new Array(r),i=0;i<r;i++)e=this._findBestMatchingUnit(t[i]),n[i]=Math.sqrt(this.distance(t[i],e.weights));return n},module.exports=SOM},{"./node-hexagonal":50,"./node-square":51}],50:[function(t,e,r){var n=t("./node-square");function i(t,e,r,i){n.call(this,t,e,r,i),this.hX=t-Math.floor(e/2),this.z=0-this.hX-e}i.prototype=new n,i.prototype.constructor=i,i.prototype.getDistance=function(t){return Math.max(Math.abs(this.hX-t.hX),Math.abs(this.y-t.y),Math.abs(this.z-t.z))},i.prototype.getDistanceTorus=function(t){var e=Math.abs(this.hX-t.hX),r=Math.abs(this.y-t.y),n=Math.abs(this.z-t.z);return Math.max(Math.min(e,this.som.gridDim.x-e),Math.min(r,this.som.gridDim.y-r),Math.min(n,this.som.gridDim.z-n))},i.prototype.getPosition=function(){throw new Error("Unimplemented : cannot get position of the points for hexagonal grid")},e.exports=i},{"./node-square":51}],51:[function(t,e,r){function n(t,e,r,n){this.x=t,this.y=e,this.weights=r,this.som=n,this.neighbors={}}n.prototype.adjustWeights=function(t,e,r){for(var n=0,i=this.weights.length;n<i;n++)this.weights[n]+=e*r*(t[n]-this.weights[n])},n.prototype.getDistance=function(t){return Math.max(Math.abs(this.x-t.x),Math.abs(this.y-t.y))},n.prototype.getDistanceTorus=function(t){var e=Math.abs(this.x-t.x),r=Math.abs(this.y-t.y);return Math.max(Math.min(e,this.som.gridDim.x-e),Math.min(r,this.som.gridDim.y-r))},n.prototype.getNeighbors=function(t){if(!this.neighbors[t]){var e,r,n,i;if(this.neighbors[t]=new Array(2),this[t]>0?e=this[t]-1:this.som.torus&&(e=this.som.gridDim[t]-1),void 0!==e)"x"===t?(r=e,n=this.y):(r=this.x,n=e),this.neighbors[t][0]=this.som.nodes[r][n];this[t]<this.som.gridDim[t]-1?i=this[t]+1:this.som.torus&&(i=0),void 0!==i&&("x"===t?(r=i,n=this.y):(r=this.x,n=i),this.neighbors[t][1]=this.som.nodes[r][n])}return this.neighbors[t]},n.prototype.getPos=function(t,e){var r,n,i=this.getNeighbors(t),o=this.som.distance;i[0]?i[1]?o(e,i[0].weights)<o(e,i[1].weights)?(r=i[0],n=-1):(r=i[1],n=1):(r=i[0],n=-1):(r=i[1],n=1);var s=1-o(e,this.weights),a=1-o(e,r.weights);return.5+.5*((s-a)/(2-s-a))*n},n.prototype.getPosition=function(t){return[this.getPos("x",t),this.getPos("y",t)]},e.exports=n},{}],52:[function(t,e,r){"use strict";var n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(t){n[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var r,s,a=function(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),u=1;u<arguments.length;u++){for(var h in r=Object(arguments[u]))i.call(r,h)&&(a[h]=r[h]);if(n){s=n(r);for(var l=0;l<s.length;l++)o.call(r,s[l])&&(a[s[l]]=r[s[l]])}}return a}},{}],53:[function(t,e,r){(function(t){"use strict";void 0===t||!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports={nextTick:function(e,r,n,i){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var o,s,a=arguments.length;switch(a){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick(function(){e.call(null,r)});case 3:return t.nextTick(function(){e.call(null,r,n)});case 4:return t.nextTick(function(){e.call(null,r,n,i)});default:for(o=new Array(a-1),s=0;s<o.length;)o[s++]=arguments[s];return t.nextTick(function(){e.apply(null,o)})}}}:e.exports=t}).call(this,t("_process"))},{_process:54}],54:[function(t,e,r){var n,i,o=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(t){if(n===setTimeout)return setTimeout(t,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(t){n=s}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(t){i=a}}();var h,l=[],f=!1,c=-1;function p(){f&&h&&(f=!1,h.length?l=h.concat(l):c=-1,l.length&&d())}function d(){if(!f){var t=u(p);f=!0;for(var e=l.length;e;){for(h=l,l=[];++c<e;)h&&h[c].run();c=-1,e=l.length}h=null,f=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function g(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];l.push(new m(t,e)),1!==l.length||f||u(d)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],55:[function(t,e,r){e.exports=t("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":56}],56:[function(t,e,r){"use strict";var n=t("process-nextick-args"),i=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};e.exports=f;var o=Object.create(t("core-util-is"));o.inherits=t("inherits");var s=t("./_stream_readable"),a=t("./_stream_writable");o.inherits(f,s);for(var u=i(a.prototype),h=0;h<u.length;h++){var l=u[h];f.prototype[l]||(f.prototype[l]=a.prototype[l])}function f(t){if(!(this instanceof f))return new f(t);s.call(this,t),a.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",c)}function c(){this.allowHalfOpen||this._writableState.ended||n.nextTick(p,this)}function p(t){t.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),f.prototype._destroy=function(t,e){this.push(null),this.end(),n.nextTick(e,t)}},{"./_stream_readable":58,"./_stream_writable":60,"core-util-is":32,inherits:38,"process-nextick-args":53}],57:[function(t,e,r){"use strict";e.exports=o;var n=t("./_stream_transform"),i=Object.create(t("core-util-is"));function o(t){if(!(this instanceof o))return new o(t);n.call(this,t)}i.inherits=t("inherits"),i.inherits(o,n),o.prototype._transform=function(t,e,r){r(null,t)}},{"./_stream_transform":59,"core-util-is":32,inherits:38}],58:[function(t,e,r){(function(r,n){"use strict";var i=t("process-nextick-args");e.exports=y;var o,s=t("isarray");y.ReadableState=v;t("events").EventEmitter;var a=function(t,e){return t.listeners(e).length},u=t("./internal/streams/stream"),h=t("safe-buffer").Buffer,l=n.Uint8Array||function(){};var f=Object.create(t("core-util-is"));f.inherits=t("inherits");var c=t("util"),p=void 0;p=c&&c.debuglog?c.debuglog("stream"):function(){};var d,m=t("./internal/streams/BufferList"),g=t("./internal/streams/destroy");f.inherits(y,u);var w=["error","close","destroy","pause","resume"];function v(e,r){o=o||t("./_stream_duplex"),e=e||{};var n=r instanceof o;this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,s=e.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(s||0===s)?s:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(d||(d=t("string_decoder/").StringDecoder),this.decoder=new d(e.encoding),this.encoding=e.encoding)}function y(e){if(o=o||t("./_stream_duplex"),!(this instanceof y))return new y(e);this._readableState=new v(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),u.call(this)}function b(t,e,r,n,i){var o,s=t._readableState;null===e?(s.reading=!1,function(t,e){if(e.ended)return;if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,S(t)}(t,s)):(i||(o=function(t,e){var r;n=e,h.isBuffer(n)||n instanceof l||"string"==typeof e||void 0===e||t.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));var n;return r}(s,e)),o?t.emit("error",o):s.objectMode||e&&e.length>0?("string"==typeof e||s.objectMode||Object.getPrototypeOf(e)===h.prototype||(e=function(t){return h.from(t)}(e)),n?s.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):x(t,s,e,!0):s.ended?t.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!r?(e=s.decoder.write(e),s.objectMode||0!==e.length?x(t,s,e,!1):k(t,s)):x(t,s,e,!1))):n||(s.reading=!1));return function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(s)}function x(t,e,r,n){e.flowing&&0===e.length&&!e.sync?(t.emit("data",r),t.read(0)):(e.length+=e.objectMode?1:r.length,n?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&S(t)),k(t,e)}Object.defineProperty(y.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),y.prototype.destroy=g.destroy,y.prototype._undestroy=g.undestroy,y.prototype._destroy=function(t,e){this.push(null),e(t)},y.prototype.push=function(t,e){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof t&&((e=e||n.defaultEncoding)!==n.encoding&&(t=h.from(t,e),e=""),r=!0),b(this,t,e,!1,r)},y.prototype.unshift=function(t){return b(this,t,null,!0,!1)},y.prototype.isPaused=function(){return!1===this._readableState.flowing},y.prototype.setEncoding=function(e){return d||(d=t("string_decoder/").StringDecoder),this._readableState.decoder=new d(e),this._readableState.encoding=e,this};var M=8388608;function _(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=M?t=M:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function S(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(p("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?i.nextTick(E,t):E(t))}function E(t){p("emit readable"),t.emit("readable"),R(t)}function k(t,e){e.readingMore||(e.readingMore=!0,i.nextTick(j,t,e))}function j(t,e){for(var r=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(p("maybeReadMore read 0"),t.read(0),r!==e.length);)r=e.length;e.readingMore=!1}function O(t){p("readable nexttick read 0"),t.read(0)}function A(t,e){e.reading||(p("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),R(t),e.flowing&&!e.reading&&t.read(0)}function R(t){var e=t._readableState;for(p("flow",e.flowing);e.flowing&&null!==t.read(););}function N(t,e){return 0===e.length?null:(e.objectMode?r=e.buffer.shift():!t||t>=e.length?(r=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):r=function(t,e,r){var n;t<e.head.data.length?(n=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):n=t===e.head.data.length?e.shift():r?function(t,e){var r=e.head,n=1,i=r.data;t-=i.length;for(;r=r.next;){var o=r.data,s=t>o.length?o.length:t;if(s===o.length?i+=o:i+=o.slice(0,t),0===(t-=s)){s===o.length?(++n,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=o.slice(s));break}++n}return e.length-=n,i}(t,e):function(t,e){var r=h.allocUnsafe(t),n=e.head,i=1;n.data.copy(r),t-=n.data.length;for(;n=n.next;){var o=n.data,s=t>o.length?o.length:t;if(o.copy(r,r.length-t,0,s),0===(t-=s)){s===o.length?(++i,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=o.slice(s));break}++i}return e.length-=i,r}(t,e);return n}(t,e.buffer,e.decoder),r);var r}function T(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,i.nextTick(I,e,t))}function I(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function C(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}y.prototype.read=function(t){p("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return p("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?T(this):S(this),null;if(0===(t=_(t,e))&&e.ended)return 0===e.length&&T(this),null;var n,i=e.needReadable;return p("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&p("length less than watermark",i=!0),e.ended||e.reading?p("reading or ended",i=!1):i&&(p("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=_(r,e))),null===(n=t>0?N(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&T(this)),null!==n&&this.emit("data",n),n},y.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},y.prototype.pipe=function(t,e){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=t;break;case 1:o.pipes=[o.pipes,t];break;default:o.pipes.push(t)}o.pipesCount+=1,p("pipe count=%d opts=%j",o.pipesCount,e);var u=(!e||!1!==e.end)&&t!==r.stdout&&t!==r.stderr?l:y;function h(e,r){p("onunpipe"),e===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,p("cleanup"),t.removeListener("close",w),t.removeListener("finish",v),t.removeListener("drain",f),t.removeListener("error",g),t.removeListener("unpipe",h),n.removeListener("end",l),n.removeListener("end",y),n.removeListener("data",m),c=!0,!o.awaitDrain||t._writableState&&!t._writableState.needDrain||f())}function l(){p("onend"),t.end()}o.endEmitted?i.nextTick(u):n.once("end",u),t.on("unpipe",h);var f=function(t){return function(){var e=t._readableState;p("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&a(t,"data")&&(e.flowing=!0,R(t))}}(n);t.on("drain",f);var c=!1;var d=!1;function m(e){p("ondata"),d=!1,!1!==t.write(e)||d||((1===o.pipesCount&&o.pipes===t||o.pipesCount>1&&-1!==C(o.pipes,t))&&!c&&(p("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,d=!0),n.pause())}function g(e){p("onerror",e),y(),t.removeListener("error",g),0===a(t,"error")&&t.emit("error",e)}function w(){t.removeListener("finish",v),y()}function v(){p("onfinish"),t.removeListener("close",w),y()}function y(){p("unpipe"),n.unpipe(t)}return n.on("data",m),function(t,e,r){if("function"==typeof t.prependListener)return t.prependListener(e,r);t._events&&t._events[e]?s(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]:t.on(e,r)}(t,"error",g),t.once("close",w),t.once("finish",v),t.emit("pipe",n),o.flowing||(p("pipe resume"),n.resume()),t},y.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r),this);if(!t){var n=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,r);return this}var s=C(e.pipes,t);return-1===s?this:(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r),this)},y.prototype.on=function(t,e){var r=u.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&S(this):i.nextTick(O,this))}return r},y.prototype.addListener=y.prototype.on,y.prototype.resume=function(){var t=this._readableState;return t.flowing||(p("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,i.nextTick(A,t,e))}(this,t)),this},y.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this},y.prototype.wrap=function(t){var e=this,r=this._readableState,n=!1;for(var i in t.on("end",function(){if(p("wrapped end"),r.decoder&&!r.ended){var t=r.decoder.end();t&&t.length&&e.push(t)}e.push(null)}),t.on("data",function(i){(p("wrapped data"),r.decoder&&(i=r.decoder.write(i)),!r.objectMode||null!==i&&void 0!==i)&&((r.objectMode||i&&i.length)&&(e.push(i)||(n=!0,t.pause())))}),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var o=0;o<w.length;o++)t.on(w[o],this.emit.bind(this,w[o]));return this._read=function(e){p("wrapped _read",e),n&&(n=!1,t.resume())},this},Object.defineProperty(y.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),y._fromList=N}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":56,"./internal/streams/BufferList":61,"./internal/streams/destroy":62,"./internal/streams/stream":63,_process:54,"core-util-is":32,events:36,inherits:38,isarray:41,"process-nextick-args":53,"safe-buffer":64,"string_decoder/":65,util:30}],59:[function(t,e,r){"use strict";e.exports=o;var n=t("./_stream_duplex"),i=Object.create(t("core-util-is"));function o(t){if(!(this instanceof o))return new o(t);n.call(this,t),this._transformState={afterTransform:function(t,e){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!=e&&this.push(e),n(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",s)}function s(){var t=this;"function"==typeof this._flush?this._flush(function(e,r){a(t,e,r)}):a(this,null,null)}function a(t,e,r){if(e)return t.emit("error",e);if(null!=r&&t.push(r),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}i.inherits=t("inherits"),i.inherits(o,n),o.prototype.push=function(t,e){return this._transformState.needTransform=!1,n.prototype.push.call(this,t,e)},o.prototype._transform=function(t,e,r){throw new Error("_transform() is not implemented")},o.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},o.prototype._destroy=function(t,e){var r=this;n.prototype._destroy.call(this,t,function(t){e(t),r.emit("close")})}},{"./_stream_duplex":56,"core-util-is":32,inherits:38}],60:[function(t,e,r){(function(r,n,i){"use strict";var o=t("process-nextick-args");function s(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,r){var n=t.entry;t.entry=null;for(;n;){var i=n.callback;e.pendingcb--,i(r),n=n.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}e.exports=v;var a,u=!r.browser&&["v0.10","v0.9."].indexOf(r.version.slice(0,5))>-1?i:o.nextTick;v.WritableState=w;var h=Object.create(t("core-util-is"));h.inherits=t("inherits");var l={deprecate:t("util-deprecate")},f=t("./internal/streams/stream"),c=t("safe-buffer").Buffer,p=n.Uint8Array||function(){};var d,m=t("./internal/streams/destroy");function g(){}function w(e,r){a=a||t("./_stream_duplex"),e=e||{};var n=r instanceof a;this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var i=e.highWaterMark,h=e.writableHighWaterMark,l=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(h||0===h)?h:l,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var f=!1===e.decodeStrings;this.decodeStrings=!f,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var r=t._writableState,n=r.sync,i=r.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(r),e)!function(t,e,r,n,i){--e.pendingcb,r?(o.nextTick(i,n),o.nextTick(S,t,e),t._writableState.errorEmitted=!0,t.emit("error",n)):(i(n),t._writableState.errorEmitted=!0,t.emit("error",n),S(t,e))}(t,r,n,e,i);else{var s=M(r);s||r.corked||r.bufferProcessing||!r.bufferedRequest||x(t,r),n?u(b,t,r,s,i):b(t,r,s,i)}}(r,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function v(e){if(a=a||t("./_stream_duplex"),!(d.call(v,this)||this instanceof a))return new v(e);this._writableState=new w(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),f.call(this)}function y(t,e,r,n,i,o,s){e.writelen=n,e.writecb=s,e.writing=!0,e.sync=!0,r?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function b(t,e,r,n){r||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,n(),S(t,e)}function x(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var n=e.bufferedRequestCount,i=new Array(n),o=e.corkedRequestsFree;o.entry=r;for(var a=0,u=!0;r;)i[a]=r,r.isBuf||(u=!1),r=r.next,a+=1;i.allBuffers=u,y(t,e,!0,e.length,i,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new s(e),e.bufferedRequestCount=0}else{for(;r;){var h=r.chunk,l=r.encoding,f=r.callback;if(y(t,e,!1,e.objectMode?1:h.length,h,l,f),r=r.next,e.bufferedRequestCount--,e.writing)break}null===r&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}function M(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function _(t,e){t._final(function(r){e.pendingcb--,r&&t.emit("error",r),e.prefinished=!0,t.emit("prefinish"),S(t,e)})}function S(t,e){var r=M(e);return r&&(!function(t,e){e.prefinished||e.finalCalled||("function"==typeof t._final?(e.pendingcb++,e.finalCalled=!0,o.nextTick(_,t,e)):(e.prefinished=!0,t.emit("prefinish")))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),r}h.inherits(v,f),w.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(w.prototype,"buffer",{get:l.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(d=Function.prototype[Symbol.hasInstance],Object.defineProperty(v,Symbol.hasInstance,{value:function(t){return!!d.call(this,t)||this===v&&(t&&t._writableState instanceof w)}})):d=function(t){return t instanceof this},v.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},v.prototype.write=function(t,e,r){var n,i=this._writableState,s=!1,a=!i.objectMode&&(n=t,c.isBuffer(n)||n instanceof p);return a&&!c.isBuffer(t)&&(t=function(t){return c.from(t)}(t)),"function"==typeof e&&(r=e,e=null),a?e="buffer":e||(e=i.defaultEncoding),"function"!=typeof r&&(r=g),i.ended?function(t,e){var r=new Error("write after end");t.emit("error",r),o.nextTick(e,r)}(this,r):(a||function(t,e,r,n){var i=!0,s=!1;return null===r?s=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||e.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(t.emit("error",s),o.nextTick(n,s),i=!1),i}(this,i,t,r))&&(i.pendingcb++,s=function(t,e,r,n,i,o){if(!r){var s=function(t,e,r){t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=c.from(e,r));return e}(e,n,i);n!==s&&(r=!0,i="buffer",n=s)}var a=e.objectMode?1:n.length;e.length+=a;var u=e.length<e.highWaterMark;u||(e.needDrain=!0);if(e.writing||e.corked){var h=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},h?h.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else y(t,e,!1,a,n,i,o);return u}(this,i,a,t,e,r)),s},v.prototype.cork=function(){this._writableState.corked++},v.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||x(this,t))},v.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(v.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),v.prototype._write=function(t,e,r){r(new Error("_write() is not implemented"))},v.prototype._writev=null,v.prototype.end=function(t,e,r){var n=this._writableState;"function"==typeof t?(r=t,t=null,e=null):"function"==typeof e&&(r=e,e=null),null!==t&&void 0!==t&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(t,e,r){e.ending=!0,S(t,e),r&&(e.finished?o.nextTick(r):t.once("finish",r));e.ended=!0,t.writable=!1}(this,n,r)},Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),v.prototype.destroy=m.destroy,v.prototype._undestroy=m.undestroy,v.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("timers").setImmediate)},{"./_stream_duplex":56,"./internal/streams/destroy":62,"./internal/streams/stream":63,_process:54,"core-util-is":32,inherits:38,"process-nextick-args":53,"safe-buffer":64,timers:71,"util-deprecate":80}],61:[function(t,e,r){"use strict";var n=t("safe-buffer").Buffer,i=t("util");e.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,r=""+e.data;e=e.next;)r+=t+e.data;return r},t.prototype.concat=function(t){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var e,r,i,o=n.allocUnsafe(t>>>0),s=this.head,a=0;s;)e=s.data,r=o,i=a,e.copy(r,i),a+=s.data.length,s=s.next;return o},t}(),i&&i.inspect&&i.inspect.custom&&(e.exports.prototype[i.inspect.custom]=function(){var t=i.inspect({length:this.length});return this.constructor.name+" "+t})},{"safe-buffer":64,util:30}],62:[function(t,e,r){"use strict";var n=t("process-nextick-args");function i(t,e){t.emit("error",e)}e.exports={destroy:function(t,e){var r=this,o=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return o||s?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||n.nextTick(i,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?(n.nextTick(i,r,t),r._writableState&&(r._writableState.errorEmitted=!0)):e&&e(t)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":53}],63:[function(t,e,r){e.exports=t("events").EventEmitter},{events:36}],64:[function(t,e,r){var n=t("buffer"),i=n.Buffer;function o(t,e){for(var r in t)e[r]=t[r]}function s(t,e,r){return i(t,e,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(o(n,r),r.Buffer=s),o(i,s),s.from=function(t,e,r){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,r)},s.alloc=function(t,e,r){if("number"!=typeof t)throw new TypeError("Argument must be a number");var n=i(t);return void 0!==e?"string"==typeof r?n.fill(e,r):n.fill(e):n.fill(0),n},s.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},s.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return n.SlowBuffer(t)}},{buffer:31}],65:[function(t,e,r){"use strict";var n=t("safe-buffer").Buffer,i=n.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(n.isEncoding===i||!i(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=u,this.end=h,e=4;break;case"utf8":this.fillLast=a,e=4;break;case"base64":this.text=l,this.end=f,e=3;break;default:return this.write=c,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(e)}function s(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function a(t){var e=this.lastTotal-this.lastNeed,r=function(t,e,r){if(128!=(192&e[0]))return t.lastNeed=0,"";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,""}}(this,t);return void 0!==r?r:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function u(t,e){if((t.length-e)%2==0){var r=t.toString("utf16le",e);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function h(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function l(t,e){var r=(t.length-e)%3;return 0===r?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function f(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function c(t){return t.toString(this.encoding)}function p(t){return t&&t.length?this.write(t):""}r.StringDecoder=o,o.prototype.write=function(t){if(0===t.length)return"";var e,r;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""},o.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"":e},o.prototype.text=function(t,e){var r=function(t,e,r){var n=e.length-1;if(n<r)return 0;var i=s(e[n]);if(i>=0)return i>0&&(t.lastNeed=i-1),i;if(--n<r||-2===i)return 0;if((i=s(e[n]))>=0)return i>0&&(t.lastNeed=i-2),i;if(--n<r||-2===i)return 0;if((i=s(e[n]))>=0)return i>0&&(2===i?i=0:t.lastNeed=i-3),i;return 0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var n=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)},o.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},{"safe-buffer":64}],66:[function(t,e,r){e.exports=t("./readable").PassThrough},{"./readable":67}],67:[function(t,e,r){(r=e.exports=t("./lib/_stream_readable.js")).Stream=r,r.Readable=r,r.Writable=t("./lib/_stream_writable.js"),r.Duplex=t("./lib/_stream_duplex.js"),r.Transform=t("./lib/_stream_transform.js"),r.PassThrough=t("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":56,"./lib/_stream_passthrough.js":57,"./lib/_stream_readable.js":58,"./lib/_stream_transform.js":59,"./lib/_stream_writable.js":60}],68:[function(t,e,r){e.exports=t("./readable").Transform},{"./readable":67}],69:[function(t,e,r){e.exports=t("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":60}],70:[function(t,e,r){e.exports=i;var n=t("events").EventEmitter;function i(){n.call(this)}t("inherits")(i,n),i.Readable=t("readable-stream/readable.js"),i.Writable=t("readable-stream/writable.js"),i.Duplex=t("readable-stream/duplex.js"),i.Transform=t("readable-stream/transform.js"),i.PassThrough=t("readable-stream/passthrough.js"),i.Stream=i,i.prototype.pipe=function(t,e){var r=this;function i(e){t.writable&&!1===t.write(e)&&r.pause&&r.pause()}function o(){r.readable&&r.resume&&r.resume()}r.on("data",i),t.on("drain",o),t._isStdio||e&&!1===e.end||(r.on("end",a),r.on("close",u));var s=!1;function a(){s||(s=!0,t.end())}function u(){s||(s=!0,"function"==typeof t.destroy&&t.destroy())}function h(t){if(l(),0===n.listenerCount(this,"error"))throw t}function l(){r.removeListener("data",i),t.removeListener("drain",o),r.removeListener("end",a),r.removeListener("close",u),r.removeListener("error",h),t.removeListener("error",h),r.removeListener("end",l),r.removeListener("close",l),t.removeListener("close",l)}return r.on("error",h),t.on("error",h),r.on("end",l),r.on("close",l),t.on("close",l),t.emit("pipe",r),t}},{events:36,inherits:38,"readable-stream/duplex.js":55,"readable-stream/passthrough.js":66,"readable-stream/readable.js":67,"readable-stream/transform.js":68,"readable-stream/writable.js":69}],71:[function(t,e,r){(function(e,n){var i=t("process/browser.js").nextTick,o=Function.prototype.apply,s=Array.prototype.slice,a={},u=0;function h(t,e){this._id=t,this._clearFn=e}r.setTimeout=function(){return new h(o.call(setTimeout,window,arguments),clearTimeout)},r.setInterval=function(){return new h(o.call(setInterval,window,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(t){t.close()},h.prototype.unref=h.prototype.ref=function(){},h.prototype.close=function(){this._clearFn.call(window,this._id)},r.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},r.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},r._unrefActive=r.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},r.setImmediate="function"==typeof e?e:function(t){var e=u++,n=!(arguments.length<2)&&s.call(arguments,1);return a[e]=!0,i(function(){a[e]&&(n?t.apply(null,n):t.call(null),r.clearImmediate(e))}),e},r.clearImmediate="function"==typeof n?n:function(t){delete a[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":54,timers:71}],72:[function(t,e,r){var n=n||{REVISION:"ALPHA"};!function(t){"use strict";var e=function(t,e){if(!t)throw e||"Assertion failed"},r=function(t,e,r){return t.hasOwnProperty(e)?t[e]:r},n=!1,i=0,o=function(){if(n)return n=!1,i;var t=2*Math.random()-1,e=2*Math.random()-1,r=t*t+e*e;if(0==r||r>1)return o();var s=Math.sqrt(-2*Math.log(r)/r);return i=e*s,n=!0,t*s},s=function(t){if(void 0===t||isNaN(t))return[];if("undefined"==typeof ArrayBuffer){for(var e=new Array(t),r=0;r<t;r++)e[r]=0;return e}return new Float64Array(t)},a=function(t,e,r){for(var n,i=void 0!==r,s=[],a=0;a<t;a++){for(var u=[],h=0;h<e;h++)i?u.push(r):u.push((n=1e-4,0+o()*n));s.push(u)}return s},u=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++){var o=t[i],s=e[i];n+=(o-s)*(o-s)}return n},h=function(t,r,n){var i=Math.sqrt(t.length),o=Math.floor(i);e(o===i,"D should have square number of elements.");for(var a=Math.log(r),u=s(o*o),h=s(o),l=0;l<o;l++){for(var f=-1/0,c=1/0,p=1,d=!1,m=0;!d;){for(var g=0,w=0;w<o;w++){var v=Math.exp(-t[l*o+w]*p);l===w&&(v=0),h[w]=v,g+=v}var y=0;for(w=0;w<o;w++){v=h[w]/g;h[w]=v,v>1e-7&&(y-=v*Math.log(v))}y>a?(f=p,c===1/0?p*=2:p=(p+c)/2):(c=p,f===-1/0?p/=2:p=(p+f)/2),m++,Math.abs(y-a)<n&&(d=!0),m>=50&&(d=!0)}for(w=0;w<o;w++)u[l*o+w]=h[w]}var b=s(o*o),x=2*o;for(l=0;l<o;l++)for(w=0;w<o;w++)b[l*o+w]=Math.max((u[l*o+w]+u[w*o+l])/x,1e-100);return b};function l(t){return t>0?1:t<0?-1:0}var f=function(t){t=t||{};this.perplexity=r(t,"perplexity",30),this.dim=r(t,"dim",2),this.epsilon=r(t,"epsilon",10),this.iter=0};f.prototype={initDataRaw:function(t){var r=t.length,n=t[0].length;e(r>0," X is empty? You must have some data!"),e(n>0," X[0] is empty? Where is the data?");var i=function(t){for(var e=t.length,r=s(e*e),n=0;n<e;n++)for(var i=n+1;i<e;i++){var o=u(t[n],t[i]);r[n*e+i]=o,r[i*e+n]=o}return r}(t);this.P=h(i,this.perplexity,1e-4),this.N=r,this.initSolution()},initDataDist:function(t){var r=t.length;e(r>0," X is empty? You must have some data!");for(var n=s(r*r),i=0;i<r;i++)for(var o=i+1;o<r;o++){var a=t[i][o];n[i*r+o]=a,n[o*r+i]=a}this.P=h(n,this.perplexity,1e-4),this.N=r,this.initSolution()},initSolution:function(){this.Y=a(this.N,this.dim),this.gains=a(this.N,this.dim,1),this.ystep=a(this.N,this.dim,0),this.iter=0},getSolution:function(){return this.Y},step:function(){this.iter+=1;for(var t=this.N,e=this.costGrad(this.Y),r=e.cost,n=e.grad,i=s(this.dim),o=0;o<t;o++)for(var a=0;a<this.dim;a++){var u=n[o][a],h=this.ystep[o][a],f=this.gains[o][a],c=l(u)===l(h)?.8*f:f+.2;f<.01&&(f=.01),this.gains[o][a]=c;var p=(this.iter<250?.5:.8)*h-this.epsilon*c*n[o][a];this.ystep[o][a]=p,this.Y[o][a]+=p,i[a]+=this.Y[o][a]}for(o=0;o<t;o++)for(a=0;a<this.dim;a++)this.Y[o][a]-=i[a]/t;return r},debugGrad:function(){for(var t=this.N,e=this.costGrad(this.Y),r=(e.cost,e.grad),n=1e-5,i=0;i<t;i++)for(var o=0;o<this.dim;o++){var s=this.Y[i][o];this.Y[i][o]=s+n;var a=this.costGrad(this.Y);this.Y[i][o]=s-n;var u=this.costGrad(this.Y),h=r[i][o],l=(a.cost-u.cost)/(2*n);console.log(i+","+o+": gradcheck analytic: "+h+" vs. numerical: "+l),this.Y[i][o]=s}},costGrad:function(t){for(var e=this.N,r=this.dim,n=this.P,i=this.iter<100?4:1,o=s(e*e),a=0,u=0;u<e;u++)for(var h=u+1;h<e;h++){for(var l=0,f=0;f<r;f++){var c=t[u][f]-t[h][f];l+=c*c}var p=1/(1+l);o[u*e+h]=p,o[h*e+u]=p,a+=2*p}for(var d=e*e,m=s(d),g=0;g<d;g++)m[g]=Math.max(o[g]/a,1e-100);var w=0,v=[];for(u=0;u<e;u++){var y=new Array(r);for(f=0;f<r;f++)y[f]=0;for(h=0;h<e;h++){w+=-n[u*e+h]*Math.log(m[u*e+h]);var b=4*(i*n[u*e+h]-m[u*e+h])*o[u*e+h];for(f=0;f<r;f++)y[f]+=b*(t[u][f]-t[h][f])}v.push(y)}return{cost:w,grad:v}}},t.tSNE=f}(n),function(t){"use strict";void 0===e||void 0===e.exports?window.tsnejs=t:e.exports=t}(n)},{}],73:[function(t,e,r){"use strict";var n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(r,"__esModule",{value:!0});var i=n(t("./utils"));function o(t,e){var r=function(r){return i.empty(t).map(function(){return i.filled(e,r)})},n=[];return n.push(r(-1)),n.push(r(1/0)),n.push(r(0)),n}function s(t,e,r,n,i){e=Math.floor(e);var o=t[0][e],s=t[1][e];t[2][e];if(r>=s[0])return 0;for(var u=0;u<o.length;u++)if(n===o[u])return 0;return a(t,e,r,n,i)}function a(t,e,r,n,i){var o=t[0][e],s=t[1][e],a=t[2][e];if(r>=s[0])return 0;s[0]=r,o[0]=n,a[0]=i;for(var u=0,h=0;;){var l=2*u+1,f=l+1,c=t[0][0].length;if(l>=c)break;if(f>=c){if(!(s[l]>r))break;h=l}else if(s[l]>=s[f]){if(!(r<s[l]))break;h=l}else{if(!(r<s[f]))break;h=f}s[u]=s[h],o[u]=o[h],a[u]=a[h],u=h}return s[u]=r,o[u]=n,a[u]=i,1}function u(t,e,r,n){for(;2*n+1<r;){var i=2*n+1,o=i+1,s=n;if(t[s]<t[i]&&(s=i),o<r&&t[s]<t[o]&&(s=o),s===n)break;var a=t[n];t[n]=t[s],t[s]=a;var u=e[n];e[n]=e[s],e[s]=u,n=s}}r.makeHeap=o,r.rejectionSample=function(t,e,r){for(var n=i.zeros(t),o=0;o<t;o++){for(var s=!0,a=0;s;){a=i.tauRandInt(e,r);for(var u=!1,h=0;h<o;h++)if(a===n[h]){u=!0;break}u||(s=!1)}n[o]=a}return n},r.heapPush=s,r.uncheckedHeapPush=a,r.buildCandidates=function(t,e,r,n,a){for(var u=o(e,n),h=0;h<e;h++)for(var l=0;l<r;l++)if(!(t[0][h][l]<0)){var f=t[0][h][l],c=t[2][h][l],p=i.tauRand(a);s(u,h,p,f,c),s(u,f,p,h,c),t[2][h][l]=0}return u},r.deheapSort=function(t){for(var e=t[0],r=t[1],n=0;n<e.length;n++)for(var i=e[n],o=r[n],s=0;s<i.length-1;s++){var a=i.length-s-1,h=o.length-s-1,l=i[0];i[0]=i[a],i[a]=l;var f=o[0];o[0]=o[h],o[h]=f,u(o,i,h,0)}return{indices:e,weights:r}},r.smallestFlagged=function(t,e){for(var r=t[0][e],n=t[1][e],i=t[2][e],o=1/0,s=-1,a=0;a>r.length;a++)1===i[a]&&n[a]<o&&(o=n[a],s=a);return s>=0?(i[s]=0,Math.floor(r[s])):-1}},{"./utils":79}],74:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("./umap");r.UMAP=n.UMAP},{"./umap":78}],75:[function(t,e,r){"use strict";var n,i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},o=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(r,"__esModule",{value:!0});var a=s(t("./utils")),u=function(){function t(t,e,r,n){if(this.entries=new Map,this.nRows=0,this.nCols=0,t.length!==e.length||t.length!==r.length)throw new Error("rows, cols and values arrays must all have the same length");this.nRows=n[0],this.nCols=n[1];for(var i=0;i<r.length;i++){var o=t[i],s=e[i];this.checkDims(o,s);var a=this.makeKey(o,s);this.entries.set(a,{value:r[i],row:o,col:s})}}return t.prototype.makeKey=function(t,e){return t+":"+e},t.prototype.checkDims=function(t,e){if(!(t<this.nRows&&e<this.nCols))throw new Error("row and/or col specified outside of matrix dimensions")},t.prototype.set=function(t,e,r){this.checkDims(t,e);var n=this.makeKey(t,e);this.entries.has(n)?this.entries.get(n).value=r:this.entries.set(n,{value:r,row:t,col:e})},t.prototype.get=function(t,e,r){void 0===r&&(r=0),this.checkDims(t,e);var n=this.makeKey(t,e);return this.entries.has(n)?this.entries.get(n).value:r},t.prototype.getAll=function(t){void 0===t&&(t=!0);var e=[];return this.entries.forEach(function(t){e.push(t)}),t&&e.sort(function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row}),e},t.prototype.getDims=function(){return[this.nRows,this.nCols]},t.prototype.getRows=function(){return Array.from(this.entries,function(t){var e=i(t,2);e[0];return e[1].row})},t.prototype.getCols=function(){return Array.from(this.entries,function(t){var e=i(t,2);e[0];return e[1].col})},t.prototype.getValues=function(){return Array.from(this.entries,function(t){var e=i(t,2);e[0];return e[1].value})},t.prototype.forEach=function(t){this.entries.forEach(function(e){return t(e.value,e.row,e.col)})},t.prototype.map=function(e){var r=[];this.entries.forEach(function(t){r.push(e(t.value,t.row,t.col))});var n=[this.nRows,this.nCols];return new t(this.getRows(),this.getCols(),r,n)},t.prototype.toArray=function(){var t=this,e=a.empty(this.nRows).map(function(){return a.zeros(t.nCols)});return this.entries.forEach(function(t){e[t.row][t.col]=t.value}),e},t}();r.SparseMatrix=u,r.transpose=function(t){var e=[],r=[],n=[];t.forEach(function(t,i,o){e.push(i),r.push(o),n.push(t)});var i=[t.nCols,t.nRows];return new u(r,e,n,i)},r.identity=function(t){for(var e=i(t,1)[0],r=new u([],[],[],t),n=0;n<e;n++)r.set(n,n,1);return r},r.pairwiseMultiply=function(t,e){return l(t,e,function(t,e){return t*e})},r.add=function(t,e){return l(t,e,function(t,e){return t+e})},r.subtract=function(t,e){return l(t,e,function(t,e){return t-e})},r.maximum=function(t,e){return l(t,e,function(t,e){return t>e?t:e})},r.multiplyScalar=function(t,e){return t.map(function(t){return t*e})},r.eliminateZeros=function(t){for(var e=new Set,r=t.getValues(),n=t.getRows(),i=t.getCols(),o=0;o<r.length;o++)0===r[o]&&e.add(o);var s=function(t,r){return!e.has(r)},a=r.filter(s),h=n.filter(s),l=i.filter(s);return new u(h,l,a,t.getDims())},r.normalize=function(t,e){var r,n;void 0===e&&(e="l2");var i=h[e],s=new Map;t.forEach(function(t,e,r){var n=s.get(e)||[];n.push(r),s.set(e,n)});var a=new u([],[],[],t.getDims()),l=function(e){for(var r=s.get(e).sort(),n=r.map(function(r){return t.get(e,r)}),o=i(n),u=0;u<o.length;u++)a.set(e,r[u],o[u])};try{for(var f=o(s.keys()),c=f.next();!c.done;c=f.next())l(c.value)}catch(t){r={error:t}}finally{try{c&&!c.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}return a};var h=((n={}).max=function(t){for(var e=-1/0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return t.map(function(t){return t/e})},n.l1=function(t){for(var e=0,r=0;r<t.length;r++)e+=t[r];return t.map(function(t){return t/e})},n.l2=function(t){for(var e=0,r=0;r<t.length;r++)e+=Math.pow(t[r],2);return t.map(function(t){return Math.sqrt(Math.pow(t,2)/e)})},n);function l(t,e,r){for(var n=new Set,i=[],o=[],s=[],a=function(n,a){i.push(n),o.push(a);var u=r(t.get(n,a),e.get(n,a));s.push(u)},h=t.getValues(),l=t.getRows(),f=t.getCols(),c=0;c<h.length;c++){var p=(w=l[c])+":"+(v=f[c]);n.add(p),a(w,v)}var d=e.getValues(),m=e.getRows(),g=e.getCols();for(c=0;c<d.length;c++){var w,v;p=(w=m[c])+":"+(v=g[c]);n.has(p)||a(w,v)}var y=[t.nRows,t.nCols];return new u(i,o,s,y)}r.getCSR=function(t){var e=[];t.forEach(function(t,r,n){e.push({value:t,row:r,col:n})}),e.sort(function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row});for(var r=[],n=[],i=[],o=-1,s=0;s<e.length;s++){var a=e[s],u=a.row,h=a.col,l=a.value;u!==o&&(o=u,i.push(s)),r.push(h),n.push(l)}return{indices:r,values:n,indptr:i}}},{"./utils":79}],76:[function(t,e,r){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(r,"__esModule",{value:!0});var o=i(t("./heap")),s=i(t("./matrix")),a=i(t("./tree")),u=i(t("./utils"));r.makeNNDescent=function(t,e){return function(r,n,i,s,a,h,l,f){void 0===s&&(s=10),void 0===a&&(a=50),void 0===h&&(h=.001),void 0===l&&(l=.5),void 0===f&&(f=!0);for(var c=r.length,p=o.makeHeap(r.length,i),d=0;d<r.length;d++)for(var m=o.rejectionSample(i,r.length,e),g=0;g<m.length;g++){var w=t(r[d],r[m[g]]);o.heapPush(p,d,w,m[g],1),o.heapPush(p,m[g],w,d,1)}if(f)for(var v=0;v<n.length;v++)for(d=0;d<n[v].length&&!(n[v][d]<0);d++)for(g=d+1;g<n[v].length&&!(n[v][g]<0);g++)w=t(r[n[v][d]],r[n[v][g]]),o.heapPush(p,n[v][d],w,n[v][g],1),o.heapPush(p,n[v][g],w,n[v][d],1);for(v=0;v<s;v++){var y=o.buildCandidates(p,c,i,a,e),b=0;for(d=0;d<c;d++)for(g=0;g<a;g++){var x=Math.floor(y[0][d][g]);if(!(x<0||u.tauRand(e)<l))for(var M=0;M<a;M++){var _=Math.floor(y[0][d][M]),S=y[2][d][g],E=y[2][d][M];_<0||!S&&!E||(w=t(r[x],r[_]),b+=o.heapPush(p,x,w,_,1),b+=o.heapPush(p,_,w,x,1))}}if(b<=h*i*r.length)break}return o.deheapSort(p)}},r.makeInitializations=function(t){return{initFromRandom:function(e,r,n,i,s){for(var a=0;a<n.length;a++)for(var h=u.rejectionSample(e,r.length,s),l=0;l<h.length;l++)if(!(h[l]<0)){var f=t(r[h[l]],n[a]);o.heapPush(i,a,f,h[l],1)}},initFromTree:function(e,r,n,i,s){for(var u=0;u<n.length;u++)for(var h=a.searchFlatTree(n[u],e,s),l=0;l<h.length;l++){if(h[l]<0)return;var f=t(r[h[l]],n[u]);o.heapPush(i,u,f,h[l],1)}}}},r.makeInitializedNNSearch=function(t){return function(e,r,i,a){for(var u,h,l=s.getCSR(r),f=l.indices,c=l.indptr,p=0;p<a.length;p++)for(var d=new Set(i[0][p]);;){var m=o.smallestFlagged(i,p);if(-1===m)break;var g=f.slice(c[m],c[m+1]);try{for(var w=n(g),v=w.next();!v.done;v=w.next()){var y=v.value;if(y!==m&&-1!==y&&!d.has(y)){var b=t(e[y],a[p]);o.uncheckedHeapPush(i,p,b,y,1),d.add(y)}}}catch(t){u={error:t}}finally{try{v&&!v.done&&(h=w.return)&&h.call(w)}finally{if(u)throw u.error}}}return i}},r.initializeSearch=function(t,e,r,i,s,a,u){var h,l,f=o.makeHeap(r.length,i);if(s(i,e,r,f,u),t)try{for(var c=n(t),p=c.next();!p.done;p=c.next())a(p.value,e,r,f,u)}catch(t){h={error:t}}finally{try{p&&!p.done&&(l=c.return)&&l.call(c)}finally{if(h)throw h.error}}return f}},{"./heap":73,"./matrix":75,"./tree":77,"./utils":79}],77:[function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t},o=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(r,"__esModule",{value:!0});var a=s(t("./utils")),u=function(){return function(t,e,r,n){this.hyperplanes=t,this.offsets=e,this.children=r,this.indices=n}}();function h(t,e,r,n){for(var i=e,o=0;o<r.length;o++)i+=t[o]*r[o];return 0===i?a.tauRandInt(2,n):i>0?0:1}r.FlatTree=u,r.makeForest=function(t,e,r,n){var o=Math.max(10,e);return a.range(r).map(function(e,r){return function(t,e,r,n){void 0===e&&(e=30);var i=a.range(t.length);return function t(e,r,n,i,o){if(void 0===n&&(n=30),r.length>n){var s=function(t,e,r){var n=t[0].length,i=a.tauRandInt(e.length,r),o=a.tauRandInt(e.length,r);o=(o+=i===o?1:0)%e.length;for(var s=e[i],u=e[o],h=0,l=a.zeros(n),f=0;f<l.length;f++)l[f]=t[s][f]-t[u][f],h-=l[f]*(t[s][f]+t[u][f])/2;for(var c=0,p=0,d=a.zeros(e.length),f=0;f<e.length;f++){for(var m=h,g=0;g<n;g++)m+=l[g]*t[e[f]][g];0===m?(d[f]=a.tauRandInt(2,r),0===d[f]?c+=1:p+=1):m>0?(d[f]=0,c+=1):(d[f]=1,p+=1)}var w=a.zeros(c),v=a.zeros(p);for(var f in c=0,p=0,a.range(d.length))0===d[f]?(w[c]=e[f],c+=1):(v[p]=e[f],p+=1);return{indicesLeft:w,indicesRight:v,hyperplane:l,offset:h}}(e,r,o),u=s.indicesLeft,h=s.indicesRight,l=s.hyperplane,f=s.offset,c=t(e,u,n,i+1,o),p=t(e,h,n,i+1,o),d={leftChild:c,rightChild:p,isLeaf:!1,hyperplane:l,offset:f};return d}var d={indices:r,isLeaf:!0};return d}(t,i,e,r,n)}(t,o,r,n)}).map(function(t){return function(t,e){var r=function t(e){return e.isLeaf?1:1+t(e.leftChild)+t(e.rightChild)}(t),n=function t(e){return e.isLeaf?1:t(e.leftChild)+t(e.rightChild)}(t),o=a.range(r).map(function(){return a.zeros(t.hyperplane?t.hyperplane.length:0)}),s=a.zeros(r),h=a.range(r).map(function(){return[-1,-1]}),l=a.range(n).map(function(){return a.range(e).map(function(){return-1})});return function t(e,r,n,o,s,a,u){var h;if(e.isLeaf)return o[a][0]=-u,(h=s[u]).splice.apply(h,i([0,e.indices.length],e.indices)),{nodeNum:a,leafNum:u+=1};r[a]=e.hyperplane,n[a]=e.offset,o[a][0]=a+1;var l=a,f=t(e.leftChild,r,n,o,s,a+1,u);return a=f.nodeNum,u=f.leafNum,o[l][1]=a+1,{nodeNum:(f=t(e.rightChild,r,n,o,s,a+1,u)).nodeNum,leafNum:f.leafNum}}(t,o,s,h,l,0,0),new u(o,s,h,l)}(t,o)})},r.makeLeafArray=function(t){var e,r;if(t.length>0){var n=[];try{for(var s=o(t),a=s.next();!a.done;a=s.next()){var u=a.value;n.push.apply(n,i(u.indices))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return n}return[[-1]]},r.searchFlatTree=function(t,e,r){for(var n=0;e.children[n][0]>0;)n=0===h(e.hyperplanes[n],e.offsets[n],t,r)?e.children[n][0]:e.children[n][1];var i=-1*e.children[n][0];return e.indices[i]}},{"./utils":79}],78:[function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function s(t){try{u(n.next(t))}catch(t){o(t)}}function a(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(s,a)}u((n=n.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},s=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0});var h=a(t("./heap")),l=a(t("./matrix")),f=a(t("./nn_descent")),c=a(t("./tree")),p=a(t("./utils")),d=u(t("ml-levenberg-marquardt")),m=function(){function t(t){void 0===t&&(t={});var e=this;this.learningRate=1,this.localConnectivity=1,this.minDist=.1,this.nComponents=2,this.nEpochs=0,this.nNeighbors=15,this.negativeSampleRate=5,this.random=Math.random,this.repulsionStrength=1,this.setOpMixRatio=1,this.spread=1,this.transformQueueSize=4,this.targetMetric="categorical",this.targetWeight=.5,this.targetNNeighbors=this.nNeighbors,this.distanceFn=g,this.isInitialized=!1,this.rpForest=[],this.embedding=[],this.optimizationState=new w;var r=function(r){void 0!==t[r]&&(e[r]=t[r])};r("distanceFn"),r("learningRate"),r("localConnectivity"),r("minDist"),r("nComponents"),r("nEpochs"),r("nNeighbors"),r("negativeSampleRate"),r("random"),r("repulsionStrength"),r("setOpMixRatio"),r("spread"),r("transformQueueSize")}return t.prototype.fit=function(t){return this.initializeFit(t),this.optimizeLayout(),this.embedding},t.prototype.fitAsync=function(t,e){return void 0===e&&(e=function(){return!0}),n(this,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return this.initializeFit(t),[4,this.optimizeLayoutAsync(e)];case 1:return r.sent(),[2,this.embedding]}})})},t.prototype.setSupervisedProjection=function(t,e){void 0===e&&(e={}),this.Y=t,this.targetMetric=e.targetMetric||this.targetMetric,this.targetWeight=e.targetWeight||this.targetWeight,this.targetNNeighbors=e.targetNNeighbors||this.targetNNeighbors},t.prototype.setPrecomputedKNN=function(t,e){this.knnIndices=t,this.knnDistances=e},t.prototype.initializeFit=function(t){if(t.length<=this.nNeighbors)throw new Error("Not enough data points ("+t.length+") to create nNeighbors: "+this.nNeighbors+".  Add more data points or adjust the configuration.");if(this.X===t&&this.isInitialized)return this.getNEpochs();if(this.X=t,!this.knnIndices&&!this.knnDistances){var e=this.nearestNeighbors(t);this.knnIndices=e.knnIndices,this.knnDistances=e.knnDistances}this.graph=this.fuzzySimplicialSet(t,this.nNeighbors,this.setOpMixRatio),this.makeSearchFns(),this.searchGraph=this.makeSearchGraph(t),this.processGraphForSupervisedProjection();var r=this.initializeSimplicialSetEmbedding(),n=r.head,i=r.tail,o=r.epochsPerSample;return this.optimizationState.head=n,this.optimizationState.tail=i,this.optimizationState.epochsPerSample=o,this.initializeOptimization(),this.prepareForOptimizationLoop(),this.isInitialized=!0,this.getNEpochs()},t.prototype.makeSearchFns=function(){var t=f.makeInitializations(this.distanceFn),e=t.initFromTree,r=t.initFromRandom;this.initFromTree=e,this.initFromRandom=r,this.search=f.makeInitializedNNSearch(this.distanceFn)},t.prototype.makeSearchGraph=function(t){for(var e=this.knnIndices,r=this.knnDistances,n=[t.length,t.length],i=new l.SparseMatrix([],[],[],n),o=0;o<e.length;o++)for(var s=e[o],a=r[o],u=0;u<s.length;u++){var h=s[u],f=a[u];f>0&&i.set(o,h,f)}var c=l.transpose(i);return l.maximum(i,c)},t.prototype.transform=function(t){var e=this,r=this.X;if(void 0===r||0===r.length)throw new Error("No data has been fit.");var n=Math.floor(this.nNeighbors*this.transformQueueSize);n=Math.min(r.length,n);var i=f.initializeSearch(this.rpForest,r,t,n,this.initFromRandom,this.initFromTree,this.random),o=this.search(r,this.searchGraph,i,t),s=h.deheapSort(o),a=s.indices,u=s.weights;a=a.map(function(t){return t.slice(0,e.nNeighbors)}),u=u.map(function(t){return t.slice(0,e.nNeighbors)});var c=Math.max(0,this.localConnectivity-1),d=this.smoothKNNDistance(u,this.nNeighbors,c),m=d.sigmas,g=d.rhos,w=this.computeMembershipStrengths(a,u,m,g),v=w.rows,y=w.cols,b=w.vals,x=[t.length,r.length],M=new l.SparseMatrix(v,y,b,x),S=l.normalize(M,"l1"),E=l.getCSR(S),k=t.length,j=_(p.reshape2d(E.indices,k,this.nNeighbors),p.reshape2d(E.values,k,this.nNeighbors),this.embedding),O=this.nEpochs?this.nEpochs/3:M.nRows<=1e4?100:30,A=M.getValues().reduce(function(t,e){return e>t?e:t},0);M=M.map(function(t){return t<A/O?0:t}),M=l.eliminateZeros(M);var R=this.makeEpochsPerSample(M.getValues(),O),N=M.getRows(),T=M.getCols();return this.assignOptimizationStateParameters({headEmbedding:j,tailEmbedding:this.embedding,head:N,tail:T,currentEpoch:0,nEpochs:O,nVertices:M.getDims()[1],epochsPerSample:R}),this.prepareForOptimizationLoop(),this.optimizeLayout()},t.prototype.processGraphForSupervisedProjection=function(){var t=this.Y,e=this.X;if(t){if(t.length!==e.length)throw new Error("Length of X and y must be equal");if("categorical"===this.targetMetric){var r=this.targetWeight<1?1/(1-this.targetWeight)*2.5:1e12;this.graph=this.categoricalSimplicialSetIntersection(this.graph,t,r)}}},t.prototype.step=function(){var t=this.optimizationState.currentEpoch;return t<this.getNEpochs()&&this.optimizeLayoutStep(t),this.optimizationState.currentEpoch},t.prototype.getEmbedding=function(){return this.embedding},t.prototype.nearestNeighbors=function(t){var e,r=this.distanceFn,n=this.nNeighbors,i=f.makeNNDescent(r,this.random),o=5+Math.floor(.5===(e=Math.pow(t.length,.5)/20)?0:Math.round(e)),s=Math.max(5,Math.floor(Math.round(function(t){return Math.log(t)/Math.log(2)}(t.length))));this.rpForest=c.makeForest(t,n,o,this.random);var a=i(t,c.makeLeafArray(this.rpForest),n,s);return{knnIndices:a.indices,knnDistances:a.weights}},t.prototype.fuzzySimplicialSet=function(t,e,r){void 0===r&&(r=1);var n=this.knnIndices,i=void 0===n?[]:n,o=this.knnDistances,s=void 0===o?[]:o,a=this.localConnectivity,u=this.smoothKNNDistance(s,e,a),h=u.sigmas,f=u.rhos,c=this.computeMembershipStrengths(i,s,h,f),p=c.rows,d=c.cols,m=c.vals,g=[t.length,t.length],w=new l.SparseMatrix(p,d,m,g),v=l.transpose(w),y=l.pairwiseMultiply(w,v),b=l.subtract(l.add(w,v),y),x=l.multiplyScalar(b,r),M=l.multiplyScalar(y,1-r);return l.add(x,M)},t.prototype.categoricalSimplicialSetIntersection=function(t,e,r,n){void 0===n&&(n=1);var i=x(t,e,n,r);return M(i=l.eliminateZeros(i))},t.prototype.smoothKNNDistance=function(t,e,r,n,i){void 0===r&&(r=1),void 0===n&&(n=64),void 0===i&&(i=1);for(var o=Math.log(e)/Math.log(2)*i,s=p.zeros(t.length),a=p.zeros(t.length),u=0;u<t.length;u++){var h=0,l=1/0,f=1,c=t[u],d=c.filter(function(t){return t>0});if(d.length>=r){var m=Math.floor(r),g=r-m;m>0?(s[u]=d[m-1],g>1e-5&&(s[u]+=g*(d[m]-d[m-1]))):s[u]=g*d[0]}else d.length>0&&(s[u]=p.max(d));for(var w=0;w<n;w++){for(var v=0,y=1;y<t[u].length;y++){var b=t[u][y]-s[u];v+=b>0?Math.exp(-b/f):1}if(Math.abs(v-o)<1e-5)break;v>o?f=(h+(l=f))/2:(h=f,l===1/0?f*=2:f=(h+l)/2)}if(a[u]=f,s[u]>0){var x=p.mean(c);a[u]<.001*x&&(a[u]=.001*x)}else{var M=p.mean(t.map(p.mean));a[u]<.001*M&&(a[u]=.001*M)}}return{sigmas:a,rhos:s}},t.prototype.computeMembershipStrengths=function(t,e,r,n){for(var i=t.length,o=t[0].length,s=p.zeros(i*o),a=p.zeros(i*o),u=p.zeros(i*o),h=0;h<i;h++)for(var l=0;l<o;l++){var f=0;-1!==t[h][l]&&(f=t[h][l]===h?0:e[h][l]-n[h]<=0?1:Math.exp(-(e[h][l]-n[h])/r[h]),s[h*o+l]=h,a[h*o+l]=t[h][l],u[h*o+l]=f)}return{rows:s,cols:a,vals:u}},t.prototype.initializeSimplicialSetEmbedding=function(){for(var t=this,e=this.getNEpochs(),r=this.nComponents,n=this.graph.getValues(),i=0,o=0;o<n.length;o++){var s=n[o];i<n[o]&&(i=s)}var a=this.graph.map(function(t){return t<i/e?0:t});this.embedding=p.zeros(a.nRows).map(function(){return p.zeros(r).map(function(){return 20*p.tauRand(t.random)-10})});var u=[],h=[],l=[],f=a.getAll();for(o=0;o<f.length;o++){var c=f[o];c.value&&(u.push(c.value),l.push(c.row),h.push(c.col))}return{head:h,tail:l,epochsPerSample:this.makeEpochsPerSample(u,e)}},t.prototype.makeEpochsPerSample=function(t,e){var r=p.filled(t.length,-1),n=p.max(t),i=t.map(function(t){return t/n*e});return i.forEach(function(t,n){t>0&&(r[n]=e/i[n])}),r},t.prototype.assignOptimizationStateParameters=function(t){Object.assign(this.optimizationState,t)},t.prototype.prepareForOptimizationLoop=function(){var t=this.repulsionStrength,e=this.learningRate,r=this.negativeSampleRate,n=this.optimizationState,i=n.epochsPerSample,o=n.headEmbedding,a=n.tailEmbedding,u=o[0].length,h=o.length===a.length,l=i.map(function(t){return t/r}),f=s(l),c=s(i);this.assignOptimizationStateParameters({epochOfNextSample:c,epochOfNextNegativeSample:f,epochsPerNegativeSample:l,moveOther:h,initialAlpha:e,alpha:e,gamma:t,dim:u})},t.prototype.initializeOptimization=function(){var t=this.embedding,e=this.embedding,r=this.optimizationState,n=r.head,i=r.tail,o=r.epochsPerSample,s=this.getNEpochs(),a=this.graph.nCols,u=b(this.spread,this.minDist),h=u.a,l=u.b;this.assignOptimizationStateParameters({headEmbedding:t,tailEmbedding:e,head:n,tail:i,epochsPerSample:o,a:h,b:l,nEpochs:s,nVertices:a})},t.prototype.optimizeLayoutStep=function(t){for(var e=this.optimizationState,r=e.head,n=e.tail,i=e.headEmbedding,o=e.tailEmbedding,s=e.epochsPerSample,a=e.epochOfNextSample,u=e.epochOfNextNegativeSample,h=e.epochsPerNegativeSample,l=e.moveOther,f=e.initialAlpha,c=e.alpha,d=e.gamma,m=e.a,g=e.b,w=e.dim,b=e.nEpochs,x=e.nVertices,M=0;M<s.length;M++)if(!(a[M]>t)){var _=r[M],S=n[M],E=i[_],k=o[S],j=y(E,k),O=0;j>0&&(O=-2*m*g*Math.pow(j,g-1),O/=m*Math.pow(j,g)+1);for(var A=0;A<w;A++){var R=v(O*(E[A]-k[A]),4);E[A]+=R*c,l&&(k[A]+=-R*c)}a[M]+=s[M];for(var N=Math.floor((t-u[M])/h[M]),T=0;T<N;T++){var I=p.tauRandInt(x,this.random),C=o[I],z=y(E,C),D=0;if(z>0)D=2*d*g,D/=(.001+z)*(m*Math.pow(z,g)+1);else if(_===I)continue;for(A=0;A<w;A++){R=4;D>0&&(R=v(D*(E[A]-C[A]),4)),E[A]+=R*c}}u[M]+=N*h[M]}return e.alpha=f*(1-t/b),e.currentEpoch+=1,i},t.prototype.optimizeLayoutAsync=function(t){var e=this;return void 0===t&&(t=function(){return!0}),new Promise(function(r,o){var s=function(){return n(e,void 0,void 0,function(){var e,n,a,u,h,l;return i(this,function(i){try{if(e=this.optimizationState,n=e.nEpochs,a=e.currentEpoch,this.embedding=this.optimizeLayoutStep(a),u=this.optimizationState.currentEpoch,h=!1===t(u),l=u===n,h||l)return[2,r(l)];setTimeout(function(){return s()},0)}catch(t){o(t)}return[2]})})};setTimeout(function(){return s()},0)})},t.prototype.optimizeLayout=function(t){void 0===t&&(t=function(){return!0});for(var e=!1,r=[];!e;){var n=this.optimizationState,i=n.nEpochs,o=n.currentEpoch;r=this.optimizeLayoutStep(o);var s=this.optimizationState.currentEpoch,a=!1===t(s);e=s===i||a}return r},t.prototype.getNEpochs=function(){var t=this.graph;if(this.nEpochs>0)return this.nEpochs;var e=t.nRows;return e<=2500?500:e<=5e3?400:e<=7500?300:200},t}();function g(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e[n],2);return Math.sqrt(r)}r.UMAP=m,r.euclidean=g,r.cosine=function(t,e){for(var r=0,n=0,i=0,o=0;o<t.length;o++)r+=t[o]*e[o],n+=Math.pow(t[o],2),i+=Math.pow(e[o],2);return 0===n&&0===i?0:0===n||0===i?1:1-r/Math.sqrt(n*i)};var w=function(){return function(){this.currentEpoch=0,this.headEmbedding=[],this.tailEmbedding=[],this.head=[],this.tail=[],this.epochsPerSample=[],this.epochOfNextSample=[],this.epochOfNextNegativeSample=[],this.epochsPerNegativeSample=[],this.moveOther=!0,this.initialAlpha=1,this.alpha=1,this.gamma=1,this.a=1.5769434603113077,this.b=.8950608779109733,this.dim=2,this.nEpochs=500,this.nVertices=0}}();function v(t,e){return t>e?e:t<-e?-e:t}function y(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e[n],2);return r}function b(t,e){var r=p.linear(0,3*t,300).map(function(t){return t<e?1:t}),n=p.zeros(r.length).map(function(n,i){return r[i]>=e?Math.exp(-(r[i]-e)/t):n}),i={x:r,y:n},s={damping:1.5,initialValues:[.5,.5],gradientDifference:.1,maxIterations:100,errorTolerance:.01},a=d.default(i,function(t){var e=o(t,2),r=e[0],n=e[1];return function(t){return 1/(1+r*Math.pow(t,2*n))}},s).parameterValues,u=o(a,2);return{a:u[0],b:u[1]}}function x(t,e,r,n){return void 0===r&&(r=1),void 0===n&&(n=5),t.map(function(t,i,o){return-1===e[i]||-1===e[o]?t*Math.exp(-r):e[i]!==e[o]?t*Math.exp(-n):t})}function M(t){t=l.normalize(t,"max");var e=l.transpose(t),r=l.pairwiseMultiply(e,t);return t=l.add(t,l.subtract(e,r)),l.eliminateZeros(t)}function _(t,e,r){for(var n=p.zeros(t.length).map(function(t){return p.zeros(r[0].length)}),i=0;i<t.length;i++)for(var o=0;o<t[0].length;o++)for(var s=0;s<r[0].length;s++){var a=t[i][o];n[i][s]+=e[i][o]*r[a][s]}return n}r.findABParams=b,r.fastIntersection=x,r.resetLocalConnectivity=M,r.initTransform=_},{"./heap":73,"./matrix":75,"./nn_descent":76,"./tree":77,"./utils":79,"ml-levenberg-marquardt":45}],79:[function(t,e,r){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}};function i(t,e){return Math.floor(e()*t)}function o(t){for(var e=[],r=0;r<t;r++)e.push(void 0);return e}function s(t,e){return o(t).map(function(){return e})}function a(t){return s(t,0)}function u(t){return t.reduce(function(t,e){return t+e})}Object.defineProperty(r,"__esModule",{value:!0}),r.tauRandInt=i,r.tauRand=function(t){return t()},r.norm=function(t){var e,r,i=0;try{for(var o=n(t),s=o.next();!s.done;s=o.next()){var a=s.value;i+=Math.pow(a,2)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return Math.sqrt(i)},r.empty=o,r.range=function(t){return o(t).map(function(t,e){return e})},r.filled=s,r.zeros=a,r.ones=function(t){return s(t,1)},r.linear=function(t,e,r){return o(r).map(function(n,i){return t+i*((e-t)/(r-1))})},r.sum=u,r.mean=function(t){return u(t)/t.length},r.max=function(t){for(var e=0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return e},r.max2d=function(t){for(var e=0,r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++)e=t[r][n]>e?t[r][n]:e;return e},r.rejectionSample=function(t,e,r){for(var n=a(t),o=0;o<t;o++)for(var s=!0;s;){for(var u=i(e,r),h=!1,l=0;l<o;l++)if(u===n[l]){h=!0;break}h||(s=!1),n[o]=u}return n},r.reshape2d=function(t,e,r){var n=[],i=0;if(t.length!==e*r)throw new Error("Array dimensions must match input length.");for(var o=0;o<e;o++){for(var s=[],a=0;a<r;a++)s.push(t[i]),i+=1;n.push(s)}return n}},{}],80:[function(t,e,r){(function(t){function r(e){try{if(!t.localStorage)return!1}catch(t){return!1}var r=t.localStorage[e];return null!=r&&"true"===String(r).toLowerCase()}e.exports=function(t,e){if(r("noDeprecation"))return t;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(e);r("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return t.apply(this,arguments)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],81:[function(t,e,r){const n=t("tsne").tSNE,{Matrix:i,correlation:o}=t("ml-matrix"),s=t("ml-pca").PCA,a=t("ml-som"),u=t("umap-js").UMAP,h=t("autoencoder"),l=t("csv-parse/lib/sync");e.exports=class{constructor(){this.file="",this.records=[],this.keys=[]}run(t){if(t.file||this.file.length){if(t.file!==this.file)return console.log("[Vis] Parse file",t.file),this.file=t.file,this.records=l(t.file,{columns:!0,skip_empty_lines:!0}),this.keys=Object.keys(this.records[0]).filter(t=>t.length),{column:{options:["None"].concat(this.keys)}};{const r=this.records.length||1,l=parseInt(t.dimensions),f=this.keys.filter(e=>e!==t.column&&e.length),c=new i(this.records.map(t=>f.map(e=>t[e]))),p=[],d=[];for(let t=0;t<c.columns;t++){let e=c.getColumn(t).reduce((t,e)=>t+isNaN(e),0);console.log("[Vis] Feature:",f[t],e,100*e/r+"%"),e<r/10&&(d.push(t),p.push(f[t]))}let m=c.subMatrixColumn(d);t.transform&&("Scale"===t.transform?(console.log("[Vis] Scale input matrix X"),m=m.scaleColumns()):"Log"===t.transform&&(console.log("[Vis] Log-transform matrix X"),m=m.add(1).log()));const g=[];for(let t=0;t<r;t++){0===m.getRow(t).reduce((t,e)=>t+isNaN(e),0)&&g.push(t)}m=m.subMatrixRow(g);let w,v,y,b,x=o(m).to2DArray();if(m=m.to2DArray(),console.log("[Vis] Target variable:",t.column?t.column:"None"),console.log("[Vis] Keys:",this.keys),console.log("[Vis] Features:",f),console.log("[Vis] Features (filtered):",p),console.log("[Vis] Embedding method:",t.method),"PCA"===t.method){console.log("[Vis] Fitting PCA"),w=new s(m).predict(m,{nComponents:l}).to2DArray()}else if("SOM"===t.method){const e=new a(100,100,{iterations:Math.round(t.steps/10),fields:m[0].length});e.train(m),w=e.predict(m),3===l&&(w=w.map(t=>t.concat([0])))}else if("UMAP"===t.method){console.log("[Vis] Fitting UMAP");const e=new u({nComponents:l,nEpochs:t.steps});e.initializeFit(m);for(let r=0;r<t.steps;r++)e.step();w=e.getEmbedding()}else if("Autoencoder"===t.method){console.log("[Vis] Fitting Autoencoder");const r=new h({encoder:[{nOut:20,activation:"tanh"},{nOut:l,activation:"sigmoid"}],decoder:[{nOut:20,activation:"tanh"},{nOut:d.length}]});r.fit(m,{iterations:50*t.steps,stepSize:.005,batchSize:20,method:"adam"}),w=r.encode(m);var e=[];p.forEach((t,n)=>{const i=[],o=[];m.forEach(t=>o.push(t.slice(0)));for(let t=o.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1)),r=o[t][n];o[t][n]=o[e][n],o[e][n]=r}const s=r.predict(o);p.forEach((t,e)=>{const r=s.reduce((t,r,n)=>Math.pow(r[e]-m[n][e],2)+t,0)/s.length;i.push(r)}),e.push(i)}),console.log(e),e=new i(e).scaleColumns().to2DArray()}else{const e=new n({epsilon:10,dim:l});e.initDataRaw(m);const r=t.steps||100;for(let t=0;t<=r;t++)e.step();w=e.getSolution()}if(t.column&&t.column.length&&"None"!==t.column){b=this.records.map(e=>e[t.column]).filter((t,e)=>g.includes(e));const e=[...new Set(b)].sort((t,e)=>t>e);console.log("[Vis] Groups:",e,b.length,w.length),v=b.map((t,r)=>e.findIndex(e=>e===t)/(e.length>2?e.length-1:1)),y=[[0,"#d90368"],[.25,"#ffd400"],[.5,"#4ecc35"],[.75,"#119ddd"],[1,"#2f2fb7"]]}else v=Array(w.length).fill(0),y=[[0,"#8A8DA1"],[1,"#8A8DA1"]];return{Y:w,X:m,params:t,nDims:l,featuresFiltered:p,target:v,g:b,colorscale:y,impMatrix:e,corr:x}}}throw console.log("[Vis] No file provided"),new Error("No file selected")}}},{autoencoder:28,"csv-parse/lib/sync":35,"ml-matrix":47,"ml-pca":48,"ml-som":49,tsne:72,"umap-js":74}]},{},[81])(81)});
